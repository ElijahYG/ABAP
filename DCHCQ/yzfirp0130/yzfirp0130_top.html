<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>YZFIRP0130_TOP</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: YZFIRP0130_TOP</h2>
<h3> Description: Include ZFIRP0130_TOP</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;包含&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YZFIRP0130_TOP<br />
*&---------------------------------------------------------------------*<br />
<br />
********************************************************************<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
********************************************************************<br />
   </div>
   <div class="code">
TABLES: YZFIRP0130A,   "对帐分组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*YZFIRP0130A,&nbsp;&nbsp;&nbsp;"对帐分组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YZFIRP0130B,&nbsp;&nbsp;&nbsp;"银行对帐单<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YZFIRP0130C.&nbsp;&nbsp;&nbsp;"对帐结果<br />
TABLES: CEPC,     "利润中心<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CEPCT.&nbsp;&nbsp;&nbsp;&nbsp;"利润中心<br />
TABLES: SKA1,     "总帐科目<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKAT.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"总帐科目<br />
<br />
   </div>
   <div class="codeComment">
********************************************************************<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE<br />
********************************************************************<br />
   </div>
   <div class="code">
TYPES: BEGIN OF TY_BC_UPLOAD,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRCTR(10),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"利润中心<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACCID(10),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"总帐科目<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATUM(8),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR(20),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMMA(100),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"摘要<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_BC_UPLOAD.<br />
<br />
TYPES: BEGIN OF TY_SAPDOC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;TYPE&nbsp;BSEG-BUKRS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR&nbsp;TYPE&nbsp;BSEG-BELNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;TYPE&nbsp;BSEG-GJAHR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONAT&nbsp;TYPE&nbsp;BKPF-MONAT,&nbsp;&nbsp;"add&nbsp;by&nbsp;erp-zhouxh&nbsp;on&nbsp;2010.1.15<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI&nbsp;TYPE&nbsp;BSEG-BUZEI,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUDAT&nbsp;TYPE&nbsp;BKPF-BUDAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHKZG&nbsp;TYPE&nbsp;BSEG-SHKZG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR&nbsp;TYPE&nbsp;BSEG-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT&nbsp;TYPE&nbsp;BSEG-HKONT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRCTR&nbsp;TYPE&nbsp;BSEG-PRCTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGTXT&nbsp;TYPE&nbsp;BSEG-SGTXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STBLG&nbsp;TYPE&nbsp;BKPF-STBLG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBVSTA&nbsp;TYPE&nbsp;YZFIRP0130B-ZBVSTA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLINDX&nbsp;TYPE&nbsp;SY-TABIX,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CKNUM&nbsp;&nbsp;TYPE&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"勾稽号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_STATUS(30),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_SAPDOC.<br />
<br />
TYPES:  BEGIN OF TY_BANKCOPY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGRPID&nbsp;TYPE&nbsp;YZFIRP0130B-ZGRPID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRCTR&nbsp;&nbsp;TYPE&nbsp;YZFIRP0130A-PRCTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT&nbsp;&nbsp;TYPE&nbsp;YZFIRP0130A-HKONT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBCKNO&nbsp;TYPE&nbsp;YZFIRP0130B-ZBCKNO,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBCDAT&nbsp;TYPE&nbsp;YZFIRP0130B-ZBCDAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBCMON&nbsp;TYPE&nbsp;YZFIRP0130B-ZBCMON,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZSHTXT&nbsp;TYPE&nbsp;YZFIRP0130B-ZSHTXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBVSTA&nbsp;TYPE&nbsp;YZFIRP0130B-ZBVSTA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLINDX&nbsp;TYPE&nbsp;SY-TABIX,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CKNUM&nbsp;&nbsp;TYPE&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"勾稽号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_STATUS(30),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_BANKCOPY.<br />
<br />
TYPES: BEGIN OF TY_BSIS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;TYPE&nbsp;BSIS-BUKRS,&nbsp;"公司代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT&nbsp;TYPE&nbsp;BSIS-HKONT,&nbsp;"总分类帐帐目<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;TYPE&nbsp;BSIS-GJAHR,&nbsp;"会计年度<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR&nbsp;TYPE&nbsp;BSIS-BELNR,&nbsp;"会计凭证编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI&nbsp;TYPE&nbsp;BSIS-BUZEI,&nbsp;"会计凭证中的行项目数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUDAT&nbsp;TYPE&nbsp;BSIS-BUDAT,&nbsp;"凭证中的过帐日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLART&nbsp;TYPE&nbsp;BSIS-BLART,&nbsp;"凭证类型<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONAT&nbsp;TYPE&nbsp;BSIS-MONAT,&nbsp;"会计期间<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHKZG&nbsp;TYPE&nbsp;BSIS-SHKZG,&nbsp;"借方/贷方标识<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR&nbsp;TYPE&nbsp;BSIS-DMBTR,&nbsp;"按本位币计的金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGTXT&nbsp;TYPE&nbsp;BSIS-SGTXT,&nbsp;"项目文本<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRCTR&nbsp;TYPE&nbsp;BSIS-PRCTR,&nbsp;"利润中心<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSTOV&nbsp;TYPE&nbsp;BSIS-XSTOV,&nbsp;"标记：凭证标记为冲销<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XNEGP&nbsp;TYPE&nbsp;BSIS-XNEGP,&nbsp;"标识:&nbsp;反记帐<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEGMENT&nbsp;TYPE&nbsp;BSIS-SEGMENT,&nbsp;"段:利润中心<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STBLG&nbsp;TYPE&nbsp;BKPF-STBLG,&nbsp;"冲销凭证<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_BSIS.<br />
<br />
TYPES: BEGIN OF TY_BCRESULT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CKNUM&nbsp;TYPE&nbsp;I.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"对帐勾稽号(临时)<br />
include structure <a href ="yzfirp0130c/dictionary-yzfirp0130c.html">YZFIRP0130C</a>.<br />
TYPES: END OF TY_BCRESULT.<br />
<br />
TYPES: BEGIN OF TY_YZFIRP0130D.<br />
include structure <a href ="yzfirp0130d/dictionary-yzfirp0130d.html">YZFIRP0130D</a>.<br />
TYPES: END OF TY_YZFIRP0130D.<br />
   </div>
   <div class="codeComment">
********************************************************************<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONSTANTS<br />
********************************************************************<br />
*&gt;状态<br />
   </div>
   <div class="code">
CONSTANTS: GC_UNPROCESSED TYPE YZFIRP0130A-ZBVSTA VALUE 'A'.<br />
CONSTANTS: GC_PROCESSING  TYPE YZFIRP0130A-ZBVSTA VALUE 'B'.<br />
CONSTANTS: GC_PROCESSED   TYPE YZFIRP0130A-ZBVSTA VALUE 'C'.<br />
CONSTANTS: GC_DELETED     TYPE YZFIRP0130A-ZBVSTA VALUE 'D'.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;操作<br />
   </div>
   <div class="code">
CONSTANTS: GC_CREATE_GROUP  VALUE 'A'.<br />
CONSTANTS: GC_SELECT_GROUP  VALUE 'B'.<br />
CONSTANTS: GC_CHANGE_GROUP  VALUE 'C'.<br />
CONSTANTS: GC_DISPLAY_GROUP VALUE 'D'.<br />
CONSTANTS: GC_SELECT_UPLOAD VALUE 'E'.<br />
CONSTANTS: GC_PROCESS_CHECK VALUE 'F'.<br />
CONSTANTS: GC_DISPLAY_CHECK VALUE 'G'.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;控制范围<br />
   </div>
   <div class="code">
CONSTANTS: GC_KOKRS TYPE CEPC-KOKRS VALUE 'CQEP'.<br />
CONSTANTS: GC_BUKRS TYPE BKPF-BUKRS VALUE '2000'.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;会计科目表<br />
   </div>
   <div class="code">
CONSTANTS: GC_KTOPL TYPE SKA1-KTOPL VALUE 'CQEP'.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;分组号码对象<br />
   </div>
   <div class="code">
CONSTANTS: GC_INTV_ZGRPID TYPE INRI-NRRANGENR VALUE '01'.<br />
CONSTANTS: GC_NO_ZGRPID   TYPE INRI-OBJECT    VALUE 'ZGRPID'.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;对帐单流水号号码对象<br />
   </div>
   <div class="code">
CONSTANTS: GC_INTV_ZBCKNO TYPE INRI-NRRANGENR VALUE '01'.<br />
CONSTANTS: GC_NO_ZBCKNO   TYPE INRI-OBJECT    VALUE 'ZBCKNO'.<br />
<br />
CONSTANTS: GC_FALSE TYPE SY-SUBRC VALUE 4,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GC_TRUE&nbsp;&nbsp;TYPE&nbsp;SY-SUBRC&nbsp;VALUE&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
********************************************************************<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA<br />
********************************************************************<br />
*&gt;Controls<br />
   </div>
   <div class="code">
DATA GO_CONTAINER   TYPE REF TO CL_GUI_CUSTOM_CONTAINER.<br />
DATA GO_SPLITTER    TYPE REF TO CL_GUI_SPLITTER_CONTAINER.<br />
DATA GO_CONTAINER_1 TYPE REF TO CL_GUI_CONTAINER.<br />
DATA GO_CONTAINER_2 TYPE REF TO CL_GUI_CONTAINER.<br />
DATA GO_GRID_1      TYPE REF TO CL_GUI_ALV_GRID.<br />
DATA GO_GRID_2      TYPE REF TO CL_GUI_ALV_GRID.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;SCREEN<br />
   </div>
   <div class="code">
DATA: GV_INIT_0002.<br />
DATA: OK_SAVE LIKE SY-UCOMM,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OK_CODE&nbsp;LIKE&nbsp;SY-UCOMM.<br />
DATA: GV_OPERATION.<br />
DATA: GT_EXTAB TYPE SY-UCOMM OCCURS 1.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;SCREEN&nbsp;0100<br />
   </div>
   <div class="code">
DATA: GV_INIT_0100.<br />
DATA: GV_CHANGED_0100.<br />
DATA: GT_BANKCOPY_0100 TYPE TABLE OF TY_BANKCOPY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_BANKCOPY_0100&nbsp;TYPE&nbsp;TY_BANKCOPY.<br />
DATA: GT_SAPDOC_0100   TYPE TABLE OF TY_SAPDOC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_SAPDOC_0100&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_SAPDOC.<br />
DATA: GT_BCRESULT_0100 TYPE TABLE OF TY_BCRESULT.<br />
DATA: WA_BCRESULT_0100 TYPE TY_BCRESULT.<br />
DATA: GCB_PROCESSED_0100.<br />
DATA: GCB_UNPROCESSED_0100 VALUE 'X'.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;ALV<br />
   </div>
   <div class="code">
DATA: GT_FCAT_1     TYPE LVC_T_FCAT.<br />
DATA: GT_FCAT_2     TYPE LVC_T_FCAT.<br />
DATA: WA_FCAT       TYPE LVC_S_FCAT.<br />
DATA: GS_LAYO_1     TYPE LVC_S_LAYO.<br />
DATA: GS_LAYO_2     TYPE LVC_S_LAYO.<br />
DATA: GT_EXCL_1     TYPE UI_FUNCTIONS.<br />
DATA: GT_EXCL_2     TYPE UI_FUNCTIONS.<br />
DATA: WA_EXCL       TYPE UI_FUNC.<br />
DATA: GS_VARI_1     TYPE DISVARIANT.<br />
DATA: GS_VARI_2     TYPE DISVARIANT.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;Bank&nbsp;copy<br />
   </div>
   <div class="code">
DATA: GT_BC_UPLOAD  TYPE TABLE OF TY_BC_UPLOAD.<br />
DATA: WA_BC_UPLOAD  TYPE TY_BC_UPLOAD.<br />
DATA: GV_FNAME      TYPE RLGRAP-FILENAME.<br />
DATA: GT_YZFIRP0130A     TYPE TABLE OF YZFIRP0130A.<br />
DATA: WA_YZFIRP0130A     TYPE YZFIRP0130A.<br />
DATA: GT_YZFIRP0130B     TYPE TABLE OF YZFIRP0130B.<br />
DATA: WA_YZFIRP0130B     TYPE YZFIRP0130B.<br />
DATA: GT_YZFIRP0130C     TYPE TABLE OF YZFIRP0130C.<br />
DATA: WA_YZFIRP0130C     TYPE YZFIRP0130C.<br />
DATA: WA_YZFIRP0130D     TYPE YZFIRP0130D.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;SAP&nbsp;FI&nbsp;documents<br />
   </div>
   <div class="code">
DATA: GT_BSIS  TYPE TABLE OF TY_BSIS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_BSIS&nbsp;&nbsp;TYPE&nbsp;TY_BSIS.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;本次处理的SAP凭证<br />
   </div>
   <div class="code">
DATA: GT_SAPDOC TYPE TABLE OF TY_SAPDOC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_SAPDOC&nbsp;TYPE&nbsp;TY_SAPDOC.<br />
   </div>
   <div class="codeComment">
*&gt;本次处理的对帐单<br />
   </div>
   <div class="code">
DATA: GT_BANKCOPY TYPE TABLE OF TY_BANKCOPY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_BANKCOPY&nbsp;TYPE&nbsp;TY_BANKCOPY.<br />
   </div>
   <div class="codeComment">
*&gt;本次处理的对账结果<br />
   </div>
   <div class="code">
DATA: GT_BCRESULT TYPE TABLE OF TY_BCRESULT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_BCRESULT&nbsp;TYPE&nbsp;TY_BCRESULT.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;已修改的对账单<br />
   </div>
   <div class="code">
DATA: BEGIN OF WA_ZBCKNO_CHANGED,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT&nbsp;&nbsp;TYPE&nbsp;YZFIRP0130B-HKONT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZGRPID&nbsp;TYPE&nbsp;YZFIRP0130B-ZGRPID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBCKNO&nbsp;TYPE&nbsp;YZFIRP0130B-ZBCKNO,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;WA_ZBCKNO_CHANGED.<br />
DATA: GT_ZBCKNO_CHANGED LIKE TABLE OF WA_ZBCKNO_CHANGED.<br />
<br />
   </div>
   <div class="codeComment">
*&gt;SAP凭证自对账<br />
   </div>
   <div class="code">
DATA: GT_YZFIRP0130D_CHANGED TYPE TABLE OF TY_YZFIRP0130D.<br />
DATA: GT_YZFIRP0130D_DONE    TYPE TABLE OF TY_YZFIRP0130D.<br />
DATA: GV_SAP_CHNUM(10) TYPE N.  "银行自对帐分组号<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&gt;锁清单<br />
   </div>
   <div class="code">
DATA: GT_LOCK_YZFIRP0130A TYPE YZSLOCK-ENTRY OCCURS 1.<br />
<br />
DATA: GV_CKNUM    TYPE I.              "勾稽号<br />
DATA: GV_ANSWER.<br />
DATA: GV_SUBRC TYPE SY-SUBRC.<br />
DATA: DUMMY.<br />
<br />
include <a href ="yzfirp0130_cls.html">YZFIRP0130_CLS</a>.<br />
<br />
DATA: GO_EVENT_RECEIVER TYPE REF TO LCL_EVENT_RECEIVER.<br />
<br />
START-OF-SELECTION.<br />
CALL SCREEN 1.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
