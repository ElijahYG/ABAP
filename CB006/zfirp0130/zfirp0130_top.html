<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZFIRP0130_TOP</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZFIRP0130_TOP</h2>
<h3> Description: Include ZFIRP0130_TOP</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;包含&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZFIRP0130_TOP<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;Define&nbsp;DEFERRED/LOAD<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CLASS LCL_EVENT_RECEIVER DEFINITION DEFERRED.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;DEFINE&nbsp;CONSTANTS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CONSTANTS: CNS_OBJID_0130A TYPE W3OBJID VALUE 'ZFIRP0130A', "对账单模板<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNS_OBJID_0130B&nbsp;TYPE&nbsp;W3OBJID&nbsp;VALUE&nbsp;'ZFIRP0130B',&nbsp;"银行存款余额调节表<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNS_NROBJ_GDH&nbsp;&nbsp;&nbsp;TYPE&nbsp;NROBJ&nbsp;&nbsp;&nbsp;VALUE&nbsp;'ZFIGDH',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"勾对号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNS_NRNR_01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;NRNR&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;'01'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"勾对号区间编号<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;DEFINE&nbsp;TYPES<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TYPE-POOLS: ABAP, SLIS.<br />
TABLES SSCRFIELDS.<br />
TYPES: BEGIN OF TY_RP0130A,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;&nbsp;TYPE&nbsp;FLAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCDAT&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCDAT,&nbsp;&nbsp;"对帐单日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JZMON&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-JZMON,&nbsp;&nbsp;"对账月<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKPJ&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKPJ,&nbsp;&nbsp;"票据号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHTXT&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-SHTXT,&nbsp;&nbsp;"摘要<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMNS&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMNS,&nbsp;&nbsp;"借方金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMNH&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMNH,&nbsp;&nbsp;"贷方金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMON&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMON,&nbsp;&nbsp;"余额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKNO,&nbsp;&nbsp;"对帐单号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCGDH&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCGDH,&nbsp;&nbsp;"勾对号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPMON&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-SPMON,&nbsp;&nbsp;"对账月<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORT&nbsp;TYPE&nbsp;FLAG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"是否导入<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVED&nbsp;&nbsp;TYPE&nbsp;FLAG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"是否已保存<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEQNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130D-SEQNO,&nbsp;&nbsp;"是否期初<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLOR&nbsp;&nbsp;TYPE&nbsp;SLIS_COLDESC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STYLE&nbsp;&nbsp;TYPE&nbsp;LVC_T_STYL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_RP0130A.<br />
TYPES: BEGIN OF TY_FILE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RQ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JYLX&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZZL&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZH&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DFHM&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DFZH&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZY&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JFFSE&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DFFSE&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_FILE.<br />
TYPES: BEGIN OF TY_BSIS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;&nbsp;TYPE&nbsp;FLAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;TYPE&nbsp;BSIS-BUKRS,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"公司代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT&nbsp;&nbsp;TYPE&nbsp;BSIS-HKONT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"总分类帐帐目<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;&nbsp;TYPE&nbsp;BSIS-GJAHR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计年度<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR&nbsp;&nbsp;TYPE&nbsp;BSIS-BELNR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计凭证编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI&nbsp;&nbsp;TYPE&nbsp;BSIS-BUZEI,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计凭证中的行项目数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUDAT&nbsp;&nbsp;TYPE&nbsp;BSIS-BUDAT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"凭证中的过帐日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLART&nbsp;&nbsp;TYPE&nbsp;BSIS-BLART,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"凭证类型<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONAT&nbsp;&nbsp;TYPE&nbsp;BSIS-MONAT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计期间<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHKZG&nbsp;&nbsp;TYPE&nbsp;BSIS-SHKZG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"借方/贷方标识<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTRS&nbsp;TYPE&nbsp;BSIS-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"按本位币计的金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTRH&nbsp;TYPE&nbsp;BSIS-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"按本位币计的金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGTXT&nbsp;&nbsp;TYPE&nbsp;BSIS-SGTXT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"项目文本<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZUONR&nbsp;&nbsp;TYPE&nbsp;BSIS-ZUONR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"分配编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRCTR&nbsp;&nbsp;TYPE&nbsp;BSIS-PRCTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"利润中心<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSTOV&nbsp;&nbsp;TYPE&nbsp;BSIS-XSTOV,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"标记：凭证标记为冲销<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XNEGP&nbsp;&nbsp;TYPE&nbsp;BSIS-XNEGP,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"标识:&nbsp;反记帐<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STBLG&nbsp;&nbsp;TYPE&nbsp;BKPF-STBLG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"冲销凭证<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKNO,&nbsp;&nbsp;"对帐单号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEQNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130C-SEQNO,&nbsp;&nbsp;"是否期初<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_BSIS.<br />
TYPES: BEGIN OF TY_ZDDZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKNO,&nbsp;&nbsp;"对帐单号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUDAT&nbsp;&nbsp;TYPE&nbsp;BSIS-BUDAT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"凭证中的过帐日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR&nbsp;&nbsp;TYPE&nbsp;BSIS-BELNR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计凭证编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;TYPE&nbsp;BSIS-BUKRS,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"公司代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;&nbsp;TYPE&nbsp;BSIS-GJAHR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计年度<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI&nbsp;&nbsp;TYPE&nbsp;BSIS-BUZEI,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"会计凭证中的行项目数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGTXT&nbsp;&nbsp;TYPE&nbsp;BSIS-SGTXT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"项目文本<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZUONR&nbsp;&nbsp;TYPE&nbsp;BSIS-ZUONR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"分配编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCDAT&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCDAT,&nbsp;&nbsp;"对帐单日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKPJ&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKPJ,&nbsp;&nbsp;"票据号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHTXT&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-SHTXT,&nbsp;&nbsp;"摘要<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMNS&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMNS,&nbsp;&nbsp;"借方金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMNH&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMNH,&nbsp;&nbsp;"贷方金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCGDH&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCGDH,&nbsp;&nbsp;"勾对号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPMON&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-SPMON,&nbsp;&nbsp;"对账月<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEQNO1&nbsp;TYPE&nbsp;ZFIRP0130C-SEQNO,&nbsp;&nbsp;"银行对账企业未达是否期初<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEQNO2&nbsp;TYPE&nbsp;ZFIRP0130D-SEQNO,&nbsp;&nbsp;"银行对账单未达数据是否期初<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_ZDDZ.<br />
TYPES: BEGIN OF TY_YHZD,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;&nbsp;TYPE&nbsp;FLAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCDAT&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCDAT,&nbsp;&nbsp;"对帐单日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JZMON&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-JZMON,&nbsp;&nbsp;"对账月<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKPJ&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKPJ,&nbsp;&nbsp;"票据号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHTXT&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-SHTXT,&nbsp;&nbsp;"摘要<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMNS&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMNS,&nbsp;&nbsp;"借方金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCMNH&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCMNH,&nbsp;&nbsp;"贷方金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCKNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130A-BCKNO,&nbsp;&nbsp;"对帐单号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEQNO&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130D-SEQNO,&nbsp;&nbsp;"是否期初<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_YHZD.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;DEFINE&nbsp;REFERENCE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA: GO_EVENT_RECEIVER      TYPE REF TO LCL_EVENT_RECEIVER,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_SPLITTER_CONTAINER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_EASY_SPLITTER_CONTAINER,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_SPLITTER_CONTAINER1&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_CONTAINER,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_SPLITTER_CONTAINER2&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_CONTAINER,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_ALV_GRID1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_ALV_GRID2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_ALV_GRID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;DEFINE&nbsp;DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA: GT_RP0130A   TYPE STANDARD TABLE OF TY_RP0130A,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_RP0130A&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_RP0130A.<br />
DATA: GT_FILE      TYPE STANDARD TABLE OF TY_FILE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_FILE.<br />
DATA: GT_BSIS      TYPE STANDARD TABLE OF TY_BSIS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSIS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_BSIS.<br />
DATA: GT_RP0130B   TYPE STANDARD TABLE OF ZFIRP0130B,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_RP0130B&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZFIRP0130B.<br />
DATA: GT_ZDDZ      TYPE STANDARD TABLE OF TY_ZDDZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_ZDDZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_ZDDZ.<br />
DATA: GT_YHZD      TYPE STANDARD TABLE OF TY_YHZD,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_YHZD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_YHZD.<br />
DATA: GV_BCMON_NEW TYPE ZFIRP0130A-BCMON,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_SPLITTER&nbsp;&nbsp;TYPE&nbsp;FLAG.<br />
DATA: GS_ZZ0001    TYPE ZBCZZ0001.<br />
DATA: SAVE_OK      TYPE SYUCOMM,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OK_CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;SYUCOMM.<br />
DATA: GS_STYL      TYPE LVC_S_STYL.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;DEFINE&nbsp;SCREENS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
SELECTION-SCREEN BEGIN OF LINE.<br />
SELECTION-SCREEN COMMENT 1(10) TEXT-S03 FOR FIELD P_HKONT.<br />
SELECTION-SCREEN POSITION 35.<br />
PARAMETERS: P_HKONT TYPE ZFIRP0130A-HKONT OBLIGATORY.<br />
SELECTION-SCREEN COMMENT 46(50) GV_TXT50 FOR FIELD P_HKONT.<br />
SELECTION-SCREEN END OF LINE.<br />
PARAMETERS: P_SPMON TYPE SPMON OBLIGATORY DEFAULT SY-DATUM+0(6) MODIF ID MON.<br />
SELECTION-SCREEN SKIP.<br />
SELECTION-SCREEN BEGIN OF BLOCK BLK_BL1 WITH FRAME TITLE TEXT-S01.<br />
PARAMETERS: RD_WHDZ RADIOBUTTON GROUP RB1 MODIF ID RG1 DEFAULT 'X' USER-COMMAND RBK. "录入银行对账单<br />
PARAMETERS: RD_ZDDZ RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "银行票据自动对账<br />
SELECTION-SCREEN BEGIN OF BLOCK BLK_BL2 WITH FRAME TITLE TEXT-S02.<br />
SELECTION-SCREEN BEGIN OF LINE.<br />
SELECTION-SCREEN COMMENT 3(12) TEXT-S04 FOR FIELD P_DAYS  MODIF ID ZDD.<br />
SELECTION-SCREEN POSITION 31.<br />
PARAMETERS: P_DAYS TYPE NUMC3 MODIF ID ZDD.                                          "相差天数<br />
SELECTION-SCREEN PUSHBUTTON 35(10) BT_PLUS USER-COMMAND PLU MODIF ID ZDD VISIBLE LENGTH 2.<br />
SELECTION-SCREEN PUSHBUTTON 38(10) BT_MINS USER-COMMAND MIN MODIF ID ZDD VISIBLE LENGTH 2.<br />
SELECTION-SCREEN PUSHBUTTON 41(10) BT_CLER USER-COMMAND CLR MODIF ID ZDD VISIBLE LENGTH 2.<br />
SELECTION-SCREEN END OF LINE.<br />
PARAMETERS: CK_PJXT AS CHECKBOX DEFAULT 'X' MODIF ID ZDD.                            "票据相同<br />
PARAMETERS: CK_JEJD AS CHECKBOX DEFAULT 'X' MODIF ID ZDD.                            "借贷相同<br />
SELECTION-SCREEN END OF BLOCK BLK_BL2.<br />
PARAMETERS: RD_SGDZ RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "银行票据手工对账<br />
SELECTION-SCREEN BEGIN OF BLOCK BLK_BL3 WITH FRAME TITLE TEXT-S05.<br />
PARAMETERS: RD_YDYD RADIOBUTTON GROUP RB2 MODIF ID SGD.                              "一对一<br />
PARAMETERS: RD_DDDD RADIOBUTTON GROUP RB2 MODIF ID SGD.                              "多对多<br />
SELECTION-SCREEN END OF BLOCK BLK_BL3.<br />
PARAMETERS: RD_QXDZ RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "取消银行对账<br />
SELECTION-SCREEN BEGIN OF BLOCK BLK_BL4 WITH FRAME TITLE TEXT-S06.<br />
PARAMETERS: RD_AYQX RADIOBUTTON GROUP RB3 MODIF ID QXD  USER-COMMAND QXD.            "按月取消对账<br />
SELECTION-SCREEN BEGIN OF LINE.<br />
SELECTION-SCREEN POSITION 1.<br />
PARAMETERS: RD_AHQX RADIOBUTTON GROUP RB3 MODIF ID QXD.                              "按勾对号取消对账<br />
SELECTION-SCREEN COMMENT 3(12) TEXT-S08 FOR FIELD S_BCGDH MODIF ID QXD.<br />
SELECTION-SCREEN POSITION 28.<br />
SELECT-OPTIONS: S_BCGDH FOR GS_RP0130A-BCGDH MODIF ID GDH.<br />
SELECTION-SCREEN END OF LINE.<br />
SELECTION-SCREEN END OF BLOCK BLK_BL4.<br />
PARAMETERS: RD_CXDZ RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "查询银行对账单<br />
SELECTION-SCREEN BEGIN OF BLOCK BLK_BL5 WITH FRAME TITLE TEXT-S07.<br />
SELECT-OPTIONS: S_BCDAT FOR GS_ZDDZ-BCDAT NO-EXTENSION MODIF ID CXD.<br />
SELECTION-SCREEN END OF BLOCK BLK_BL5.<br />
PARAMETERS: RD_DYDZ RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "打印银行余额调节表<br />
PARAMETERS: RD_WDYH RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "期初银行对账单维护<br />
PARAMETERS: RD_WDQY RADIOBUTTON GROUP RB1 MODIF ID RG1.                              "期初企业未达账维护<br />
SELECTION-SCREEN END OF BLOCK BLK_BL1.<br />
SELECTION-SCREEN FUNCTION KEY 1.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;DEFINE&nbsp;MACROS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DEFINE MCR_FILL_STYL.<br />
&nbsp;&nbsp;GS_STYL-FIELDNAME&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;GS_STYL-STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;INSERT&nbsp;GS_STYL&nbsp;INTO&nbsp;TABLE&nbsp;&3-STYLE.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_STYL.<br />
END-OF-DEFINITION.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
