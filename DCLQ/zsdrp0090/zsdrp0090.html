<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZSDRP0090</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZSDRP0090</h2>
<h3> Description: 批发和零售业商品购进、销售和库存报表</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
REPORT ZSDRP0090.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;REPORT&nbsp;&nbsp;ZSDRP0090<br />
*&&nbsp;Application&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;SD-RP-0090<br />
*&&nbsp;Subject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;批发和零售业商品购进、销售和库存报表<br />
*&&nbsp;Author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;liquan<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUTHOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIPTION<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------&nbsp;&nbsp;&nbsp;&nbsp;-----------------<br />
*&&nbsp;2015/09/16&nbsp;&nbsp;&nbsp;&nbsp;liquan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initial<br />
*&---------------------------------------------------------------------*<br />
<br />
*&---------------------------------------------------------------------*<br />
*&引入选择屏幕表<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TABLES:<br />
&nbsp;&nbsp;BKPF.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义类型<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TYPES:<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;TY_FAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-RBUKRS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-RYEAR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;RACCT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-RACCT,&nbsp;"科目<br />
&nbsp;&nbsp;&nbsp;&nbsp;DRCRK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-DRCRK,&nbsp;"借贷标识<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSLVT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSLVT,&nbsp;"期初余额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL01,&nbsp;"期间01&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL02,&nbsp;"期间02&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL03,&nbsp;"期间03&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL04,&nbsp;"期间04&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL05,&nbsp;"期间05&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL06,&nbsp;"期间06&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL07,&nbsp;"期间07&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL08,&nbsp;"期间08&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL09,&nbsp;"期间09&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL10,&nbsp;"期间10&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL11,&nbsp;"期间11&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL12,&nbsp;"期间12&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL13,&nbsp;"期间13&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL14,&nbsp;"期间14&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL15,&nbsp;"期间15&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;HSL16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;FAGLFLEXT-HSL16,&nbsp;"期间16&nbsp;发生额<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_FAG,<br />
&nbsp;&nbsp;TYT_FAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_FAG&nbsp;OCCURS&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义全局数据<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA:<br />
&nbsp;&nbsp;G_YEAR&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSID-GJAHR,<br />
&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;GW_IN_TAB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;SPGJE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;"商品购进额<br />
&nbsp;&nbsp;&nbsp;&nbsp;SNGJE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;"市内购进额<br />
&nbsp;&nbsp;&nbsp;&nbsp;SWGJE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;"市外购进额<br />
&nbsp;&nbsp;&nbsp;&nbsp;JKGJE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;"进口购进额<br />
&nbsp;&nbsp;&nbsp;&nbsp;SPXSE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;"商品销售额<br />
&nbsp;&nbsp;&nbsp;&nbsp;PFXSE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"批发销售额<br />
&nbsp;&nbsp;&nbsp;&nbsp;LSXSE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"零售销售额<br />
&nbsp;&nbsp;&nbsp;&nbsp;JMLSE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"对居民的零售额<br />
&nbsp;&nbsp;&nbsp;&nbsp;SHLSE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"对社会的零售额<br />
&nbsp;&nbsp;&nbsp;&nbsp;CKXSE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"出口销售额<br />
&nbsp;&nbsp;&nbsp;&nbsp;SNPFE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"市内批发额<br />
&nbsp;&nbsp;&nbsp;&nbsp;SWPFE&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"市外批发额<br />
&nbsp;&nbsp;&nbsp;&nbsp;QMKCYE&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"期末库存余额<br />
&nbsp;&nbsp;&nbsp;&nbsp;YHKLSE&nbsp;&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"银行卡零售额<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GW_IN_TAB,<br />
&nbsp;&nbsp;GT_IN_TAB&nbsp;&nbsp;&nbsp;LIKE&nbsp;GW_IN_TAB&nbsp;OCCURS&nbsp;0&nbsp;.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&初始化<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
INITIALIZATION.<br />
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&选择屏幕<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
SELECT-OPTIONS:<br />
&nbsp;&nbsp;S_BUKRS&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;BKPF-BUKRS&nbsp;NO-EXTENSION&nbsp;NO&nbsp;INTERVALS&nbsp;OBLIGATORY,&nbsp;&nbsp;"公司代码<br />
&nbsp;&nbsp;S_GJAHR&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;BKPF-GJAHR&nbsp;NO-EXTENSION&nbsp;NO&nbsp;INTERVALS&nbsp;OBLIGATORY&nbsp;,&nbsp;&nbsp;"会计年度<br />
&nbsp;&nbsp;S_MONAT&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;BKPF-MONAT&nbsp;NO-EXTENSION&nbsp;NO&nbsp;INTERVALS&nbsp;OBLIGATORY.&nbsp;&nbsp;"会计期间<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&F8<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
   </div>
   <div class="codeComment">
*&nbsp;取数<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_DATA.<br />
   </div>
   <div class="codeComment">
*&nbsp;显示ALV<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_SHOW_ALV.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&取数<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FM_GET_DATA.<br />
   </div>
   <div class="codeComment">
*&nbsp;当年<br />
   </div>
   <div class="code">
&nbsp;&nbsp;G_YEAR&nbsp;=&nbsp;S_GJAHR-LOW.<br />
&nbsp;&nbsp;CLEAR&nbsp;GW_IN_TAB.<br />
   </div>
   <div class="codeComment">
*&nbsp;取市内、市外、进口购进额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_GJE.<br />
   </div>
   <div class="codeComment">
*&nbsp;取批发、零售、出口销售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_XSE.<br />
   </div>
   <div class="codeComment">
*&nbsp;取期末库存余额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_QMKCYE.<br />
   </div>
   <div class="codeComment">
*&nbsp;取持银行卡零售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_YHKLSE.<br />
&nbsp;&nbsp;APPEND&nbsp;GW_IN_TAB&nbsp;TO&nbsp;GT_IN_TAB.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;上年<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GW_IN_TAB.<br />
&nbsp;&nbsp;G_YEAR&nbsp;=&nbsp;S_GJAHR-LOW&nbsp;-&nbsp;1.<br />
   </div>
   <div class="codeComment">
*&nbsp;取市内、市外、进口购进额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_GJE.<br />
   </div>
   <div class="codeComment">
*&nbsp;取批发、零售、出口销售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_XSE.<br />
   </div>
   <div class="codeComment">
*&nbsp;取期末库存余额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_QMKCYE.<br />
   </div>
   <div class="codeComment">
*&nbsp;取持银行卡零售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FM_GET_YHKLSE.<br />
&nbsp;&nbsp;APPEND&nbsp;GW_IN_TAB&nbsp;TO&nbsp;GT_IN_TAB.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
**&---------------------------------------------------------------------*<br />
**&取商品购进额<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;FM_GET_SPGJE.<br />
*&nbsp;&nbsp;SELECT&nbsp;SUM(&nbsp;DMBTR&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;BSIK&nbsp;&nbsp;&nbsp;&nbsp;"未清应付<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GW_IN_TAB-SPGJE<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;BUKRS&nbsp;IN&nbsp;S_BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GJAHR&nbsp;IN&nbsp;S_GJAHR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MONAT&nbsp;IN&nbsp;S_MONAT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SHKZG&nbsp;=&nbsp;'H'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;HKONT&nbsp;=&nbsp;'2241001001'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*ENDFORM.<br />
<br />
*&---------------------------------------------------------------------*<br />
*&取市内、市外、进口购进额<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FM_GET_GJE.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_LFA1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;LFA1-LIFNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAND1&nbsp;&nbsp;&nbsp;TYPE&nbsp;LFA1-LAND1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORT02&nbsp;&nbsp;&nbsp;TYPE&nbsp;LFA1-ORT02,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_LFA1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_BSIK,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;TYPE&nbsp;BSIK-BUKRS&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR&nbsp;&nbsp;TYPE&nbsp;BSIK-LIFNR&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKS&nbsp;&nbsp;TYPE&nbsp;BSIK-UMSKS&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKZ&nbsp;&nbsp;TYPE&nbsp;BSIK-UMSKZ&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGDT&nbsp;&nbsp;TYPE&nbsp;BSIK-AUGDT&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGBL&nbsp;&nbsp;TYPE&nbsp;BSIK-AUGBL&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZUONR&nbsp;&nbsp;TYPE&nbsp;BSIK-ZUONR&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;&nbsp;TYPE&nbsp;BSIK-GJAHR&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR&nbsp;&nbsp;TYPE&nbsp;BSIK-BELNR&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI&nbsp;&nbsp;TYPE&nbsp;BSIK-BUZEI&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR&nbsp;&nbsp;TYPE&nbsp;BSIK-DMBTR&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_BSIK,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LT_BSIK&nbsp;LIKE&nbsp;LW_BSIK&nbsp;OCCURS&nbsp;0,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LT_LFA1&nbsp;LIKE&nbsp;LW_LFA1&nbsp;OCCURS&nbsp;0,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LT_TMP&nbsp;&nbsp;LIKE&nbsp;LT_LFA1.<br />
**&nbsp;STEP1：查找供应商<br />
*&nbsp;&nbsp;SELECT&nbsp;LIFNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAND1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORT02<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_LFA1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;LFA1<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;BETWEEN&nbsp;'0000300000'&nbsp;AND&nbsp;'0000399999'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**&nbsp;取bsik<br />
*&nbsp;&nbsp;IF&nbsp;LT_LFA1&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKZ<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGDT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGBL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZUONR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_BSIK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;BSIK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_LFA1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SHKZG&nbsp;=&nbsp;'H'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUKRS&nbsp;IN&nbsp;S_BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GJAHR&nbsp;=&nbsp;G_YEAR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MONAT&nbsp;IN&nbsp;S_MONAT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LIFNR&nbsp;=&nbsp;LT_LFA1-LIFNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;HKONT&nbsp;=&nbsp;'2202002001'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;ENDIF.<br />
**&nbsp;计算购进额<br />
*&nbsp;&nbsp;SORT&nbsp;LT_LFA1&nbsp;BY&nbsp;LIFNR.<br />
*&nbsp;&nbsp;CLEAR:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNGJE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SWGJE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-JKGJE.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_BSIK&nbsp;INTO&nbsp;LW_BSIK.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_LFA1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_LFA1&nbsp;INTO&nbsp;LW_LFA1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;LIFNR&nbsp;=&nbsp;LW_BSIK-LIFNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
**&nbsp;&nbsp;&nbsp;国内<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_LFA1-LAND1&nbsp;=&nbsp;'CN'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_LFA1-ORT02&nbsp;=&nbsp;'010'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNGJE&nbsp;=&nbsp;GW_IN_TAB-SNGJE&nbsp;+&nbsp;LW_BSIK-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SWGJE&nbsp;=&nbsp;GW_IN_TAB-SWGJE&nbsp;+&nbsp;LW_BSIK-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**&nbsp;&nbsp;&nbsp;进口<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-JKGJE&nbsp;=&nbsp;GW_IN_TAB-JKGJE&nbsp;+&nbsp;LW_BSIK-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
**&nbsp;商品购进额<br />
*&nbsp;&nbsp;GW_IN_TAB-SPGJE&nbsp;=&nbsp;GW_IN_TAB-JKGJE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;GW_IN_TAB-SNGJE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;GW_IN_TAB-SWGJE.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_LFA1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;LFA1-LIFNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAND1&nbsp;&nbsp;&nbsp;TYPE&nbsp;LFA1-LAND1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGIO&nbsp;&nbsp;&nbsp;TYPE&nbsp;LFA1-REGIO,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_LFA1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_DMBTR&nbsp;TYPE&nbsp;MSEG-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_MARA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;&nbsp;TYPE&nbsp;MARA-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_MARA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_MARA&nbsp;LIKE&nbsp;LW_MARA&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_R_BUDAT&nbsp;TYPE&nbsp;RANGE&nbsp;OF&nbsp;BUDAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_BUDAT&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_R_BUDAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_MSEG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBLNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-MBLNR&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MJAHR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-MJAHR&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-ZEILE&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-LIFNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BWART&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-BWART,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-EBELN,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;MSEG-EBELP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_MSEG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_MSEG&nbsp;LIKE&nbsp;LW_MSEG&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_LFA1&nbsp;LIKE&nbsp;LW_LFA1&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_EKPO,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;EKPO-EBELN,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;EKPO-EBELN,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNTTP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;EKPO-KNTTP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSTYP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;EKPO-PSTYP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MWSKZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;EKPO-MWSKZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_EKPO,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_EKPO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LW_EKPO&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_R_LIFNR&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;RANGE&nbsp;OF&nbsp;LIFNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_LIFNR&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_R_LIFNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_TMP&nbsp;&nbsp;LIKE&nbsp;LT_LFA1.<br />
   </div>
   <div class="codeComment">
*&nbsp;STEP1：取符合条件的商品<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;MARA<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_MARA<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;MTART&nbsp;IN&nbsp;('Z002','Z003','Z009')&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;STEP2：取符合条件的供应商<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;LIFNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAND1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGIO<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_LFA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;LFA1<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;BETWEEN&nbsp;'0000300000'&nbsp;AND&nbsp;'0000399999'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;STEP3：拆分供应商为3类：市内、市外、进口<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LW_R_LIFNR-SIGN&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;LW_R_LIFNR-OPTION&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_LFA1&nbsp;INTO&nbsp;LW_LFA1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_LIFNR-LOW&nbsp;=&nbsp;LW_LFA1-LIFNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_R_LIFNR&nbsp;TO&nbsp;LT_R_LIFNR.<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;CLEAR&nbsp;LW_R_LIFNR-LOW.<br />
&nbsp;&nbsp;APPEND&nbsp;LW_R_LIFNR&nbsp;TO&nbsp;LT_R_LIFNR.<br />
   </div>
   <div class="codeComment">
*&nbsp;计算购进额<br />
*&nbsp;计算过账日期<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LW_R_BUDAT-SIGN&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;LW_R_BUDAT-OPTION&nbsp;=&nbsp;'BT'.<br />
&nbsp;&nbsp;LW_R_BUDAT-LOW&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;G_YEAR&nbsp;&&&nbsp;S_MONAT-LOW&nbsp;&&&nbsp;'01'.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'FIMA_DATE_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_R_BUDAT-LOW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SET_LAST_DAY_OF_MONTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_R_BUDAT-HIGH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LW_R_BUDAT&nbsp;TO&nbsp;LT_R_BUDAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;市内购进额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;LT_MARA&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;MBLNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MJAHR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEILE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BWART<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_MSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;MSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_MARA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LT_MARA-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BWART&nbsp;IN&nbsp;('101','102','161','162')<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MJAHR&nbsp;IN&nbsp;S_GJAHR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;LIKE&nbsp;'DC%'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUDAT_MKPF&nbsp;IN&nbsp;LT_R_BUDAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LIFNR&nbsp;IN&nbsp;LT_R_LIFNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;取PO<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;LT_MSEG&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNTTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSTYP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MWSKZ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_EKPO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;EKPO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_MSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;LT_MSEG-EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EBELP&nbsp;=&nbsp;LT_MSEG-EBELP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KNTTP&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;PSTYP&nbsp;=&nbsp;'0'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SELECT&nbsp;MBLNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MJAHR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEILE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BWART<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPENDING&nbsp;TABLE&nbsp;LT_MSEG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;MSEG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_MARA<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LT_MARA-MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BWART&nbsp;IN&nbsp;('543','544')<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MJAHR&nbsp;IN&nbsp;S_GJAHR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;LIKE&nbsp;'DC%'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUDAT_MKPF&nbsp;IN&nbsp;LT_R_BUDAT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LIFNR&nbsp;IN&nbsp;LT_R_LIFNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;LIKE&nbsp;'T%'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNGJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SWGJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-JKGJE.<br />
&nbsp;&nbsp;SORT&nbsp;LT_LFA1&nbsp;BY&nbsp;LIFNR.<br />
&nbsp;&nbsp;SORT&nbsp;LT_EKPO&nbsp;BY&nbsp;EBELN&nbsp;EBELP.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_MSEG&nbsp;INTO&nbsp;LW_MSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EKPO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_EKPO&nbsp;INTO&nbsp;LW_EKPO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;EBELN&nbsp;=&nbsp;LW_MSEG-EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBELP&nbsp;=&nbsp;LW_MSEG-EBELP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LW_EKPO-MWSKZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J0'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;=&nbsp;'1.17'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;=&nbsp;'1.13'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;=&nbsp;'1.11'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J4'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;=&nbsp;'1.06'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J5'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;=&nbsp;'1.03'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;计算正负<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_MSEG-BWART&nbsp;=&nbsp;'101'<br />
&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;LW_MSEG-BWART&nbsp;=&nbsp;'162'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_DMBTR&nbsp;=&nbsp;LW_MSEG-DMBTR&nbsp;*&nbsp;L_P.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_DMBTR&nbsp;=&nbsp;(&nbsp;0&nbsp;-&nbsp;LW_MSEG-DMBTR&nbsp;)&nbsp;*&nbsp;L_P.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;&nbsp;供应商为543、544记为&nbsp;国内（清空供应商即可）<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_MSEG-BWART&nbsp;=&nbsp;'543'&nbsp;OR&nbsp;LW_MSEG-BWART&nbsp;=&nbsp;'544'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_MSEG-LIFNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;有供应商<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_MSEG-LIFNR&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_LFA1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_LFA1&nbsp;INTO&nbsp;LW_LFA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;LIFNR&nbsp;=&nbsp;LW_MSEG-LIFNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;国内<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_LFA1-LAND1&nbsp;=&nbsp;'CN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_LFA1-REGIO&nbsp;=&nbsp;'010'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNGJE&nbsp;=&nbsp;GW_IN_TAB-SNGJE&nbsp;+&nbsp;L_DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SWGJE&nbsp;=&nbsp;GW_IN_TAB-SWGJE&nbsp;+&nbsp;L_DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;进口<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-JKGJE&nbsp;=&nbsp;GW_IN_TAB-JKGJE&nbsp;+&nbsp;L_DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;无供应商算市内(包含移动类型543、544)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNGJE&nbsp;=&nbsp;GW_IN_TAB-SNGJE&nbsp;+&nbsp;L_DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
*&nbsp;商品购进额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GW_IN_TAB-SPGJE&nbsp;=&nbsp;GW_IN_TAB-JKGJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;GW_IN_TAB-SNGJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;GW_IN_TAB-SWGJE.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
**&---------------------------------------------------------------------*<br />
**&取商品销售额<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;FM_GET_SPXSE.<br />
*&nbsp;&nbsp;SELECT&nbsp;SUM(&nbsp;DMBTR&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;BSID&nbsp;&nbsp;&nbsp;&nbsp;"未清应收<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GW_IN_TAB-SPXSE<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;BUKRS&nbsp;IN&nbsp;S_BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GJAHR&nbsp;IN&nbsp;S_GJAHR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MONAT&nbsp;IN&nbsp;S_MONAT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SHKZG&nbsp;=&nbsp;'S'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;HKONT&nbsp;BETWEEN&nbsp;'11220010001'&nbsp;AND&nbsp;'1122001003'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*ENDFORM.<br />
<br />
*&---------------------------------------------------------------------*<br />
*&取销售额<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FM_GET_XSE.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_BSID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;TYPE&nbsp;BSID-BUKRS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KUNNR&nbsp;&nbsp;TYPE&nbsp;BSID-KUNNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKS&nbsp;&nbsp;TYPE&nbsp;BSID-UMSKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKZ&nbsp;&nbsp;TYPE&nbsp;BSID-UMSKZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGDT&nbsp;&nbsp;TYPE&nbsp;BSID-AUGDT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGBL&nbsp;&nbsp;TYPE&nbsp;BSID-AUGBL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZUONR&nbsp;&nbsp;TYPE&nbsp;BSID-ZUONR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;&nbsp;TYPE&nbsp;BSID-GJAHR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR&nbsp;&nbsp;TYPE&nbsp;BSID-BELNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI&nbsp;&nbsp;TYPE&nbsp;BSID-BUZEI,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT&nbsp;&nbsp;TYPE&nbsp;BSID-HKONT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR&nbsp;&nbsp;TYPE&nbsp;BSID-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_BSID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_BSID&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LW_BSID&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_BSID_TMP&nbsp;LIKE&nbsp;LT_BSID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_S901,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPMON&nbsp;&nbsp;TYPE&nbsp;S901-SPMON,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;TYPE&nbsp;S901-WERKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;&nbsp;TYPE&nbsp;S901-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZXSJE&nbsp;&nbsp;TYPE&nbsp;S901-ZXSJE,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KUNNR&nbsp;&nbsp;TYPE&nbsp;KNA1-KUNNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_S901,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_SPMON&nbsp;&nbsp;TYPE&nbsp;S901-SPMON,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_T001K,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;&nbsp;TYPE&nbsp;T001K-BWKEY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;&nbsp;TYPE&nbsp;T001K-BUKRS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_T001K,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_T001K&nbsp;LIKE&nbsp;LW_T001K&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_S901&nbsp;LIKE&nbsp;LW_S901&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_S901_TMP&nbsp;LIKE&nbsp;LW_S901&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_KNA1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KUNNR&nbsp;&nbsp;TYPE&nbsp;KNA1-KUNNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGIO&nbsp;&nbsp;TYPE&nbsp;KNA1-REGIO,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KUKLA&nbsp;&nbsp;TYPE&nbsp;KNA1-KUKLA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_KNA1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_ZT001W,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;TYPE&nbsp;ZT001W-WERKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_POS&nbsp;TYPE&nbsp;ZT001W-EX_POS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_ZT001W,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_ZT001W&nbsp;LIKE&nbsp;LW_ZT001W&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_R_WERKS&nbsp;&nbsp;TYPE&nbsp;RANGE&nbsp;OF&nbsp;WERKS_D,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_WERKS&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;&nbsp;LT_R_WERKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_KNA1&nbsp;LIKE&nbsp;LW_KNA1&nbsp;OCCURS&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;取未清应收<br />
*&nbsp;&nbsp;SELECT&nbsp;BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KUNNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UMSKZ<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGDT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUGBL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZUONR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BELNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUZEI<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKONT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_BSID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;BSID<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;(&nbsp;HKONT&nbsp;=&nbsp;'1122002001'&nbsp;OR&nbsp;HKONT&nbsp;BETWEEN&nbsp;'1122003001'&nbsp;AND&nbsp;'1122003003'&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GJAHR&nbsp;=&nbsp;G_YEAR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUKRS&nbsp;IN&nbsp;S_BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MONAT&nbsp;IN&nbsp;S_MONAT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SHKZG&nbsp;=&nbsp;'S'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**&nbsp;取供应商主数据<br />
*&nbsp;&nbsp;LT_BSID_TMP&nbsp;=&nbsp;LT_BSID.<br />
*&nbsp;&nbsp;SORT&nbsp;LT_BSID_TMP&nbsp;BY&nbsp;KUNNR.<br />
*&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT_BSID_TMP&nbsp;COMPARING&nbsp;KUNNR.<br />
*&nbsp;&nbsp;IF&nbsp;LT_BSID_TMP&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;KUNNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAND1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORT01<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_KNA1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;KNA1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_BSID_TMP<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KUNNR&nbsp;=&nbsp;LT_BSID_TMP-KUNNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
*&nbsp;取werks<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;BWKEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_T001K<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;T001K<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;BUKRS&nbsp;IN&nbsp;S_BUKRS.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LT_T001K&nbsp;IS&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_T001K&nbsp;INTO&nbsp;LW_T001K.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_R_WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_WERKS-SIGN&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_WERKS-OPTION&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_WERKS-LOW&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_T001K-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_R_WERKS&nbsp;TO&nbsp;LT_R_WERKS.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;取S901<br />
   </div>
   <div class="code">
&nbsp;&nbsp;L_SPMON&nbsp;&nbsp;=&nbsp;G_YEAR&nbsp;&&&nbsp;S_MONAT-LOW.<br />
&nbsp;&nbsp;SELECT&nbsp;SPMON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZXSJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_S901<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;S901<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPMON&nbsp;=&nbsp;L_SPMON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;IN&nbsp;LT_R_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;地点转换成客户<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_S901&nbsp;INTO&nbsp;LW_S901.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'CONVERSION_EXIT_ALPHA_INPUT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INPUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_S901-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_S901-KUNNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;LT_S901&nbsp;FROM&nbsp;LW_S901&nbsp;TRANSPORTING&nbsp;KUNNR.<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
*&nbsp;取客户主数据<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LT_S901_TMP&nbsp;=&nbsp;LT_S901.<br />
&nbsp;&nbsp;SORT&nbsp;LT_S901_TMP&nbsp;BY&nbsp;KUNNR.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT_S901_TMP&nbsp;COMPARING&nbsp;KUNNR.<br />
&nbsp;&nbsp;IF&nbsp;LT_S901_TMP&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;KUNNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGIO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KUKLA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_KNA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;KNA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_S901_TMP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KUNNR&nbsp;=&nbsp;LT_S901_TMP-KUNNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LT_S901_TMP&nbsp;=&nbsp;LT_S901.<br />
&nbsp;&nbsp;SORT&nbsp;LT_S901_TMP&nbsp;BY&nbsp;WERKS.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT_S901_TMP&nbsp;COMPARING&nbsp;WERKS.<br />
&nbsp;&nbsp;IF&nbsp;LT_S901_TMP&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_POS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZT001W<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_ZT001W<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_S901_TMP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;=&nbsp;LT_S901_TMP-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;汇总<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SPXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-PFXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-LSXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-CKXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNPFE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SWPFE.<br />
<br />
<br />
&nbsp;&nbsp;SORT&nbsp;LT_KNA1&nbsp;BY&nbsp;KUNNR.<br />
&nbsp;&nbsp;SORT&nbsp;LT_ZT001W&nbsp;BY&nbsp;WERKS.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_S901&nbsp;INTO&nbsp;LW_S901.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_KNA1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_KNA1&nbsp;INTO&nbsp;LW_KNA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;KUNNR&nbsp;=&nbsp;LW_S901-KUNNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_ZT001W.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_ZT001W&nbsp;INTO&nbsp;LW_ZT001W<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;WERKS&nbsp;=&nbsp;LW_S901-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;商品销售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SPXSE&nbsp;=&nbsp;GW_IN_TAB-SPXSE&nbsp;+&nbsp;LW_S901-ZXSJE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_KNA1-KUKLA&nbsp;=&nbsp;'10'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SPXSE&nbsp;=&nbsp;GW_IN_TAB-SPXSE&nbsp;+&nbsp;LW_S901-ZXSJE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;商品零售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_ZT001W-EX_POS&nbsp;=&nbsp;'00'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-LSXSE&nbsp;=&nbsp;GW_IN_TAB-LSXSE&nbsp;+&nbsp;LW_S901-ZXSJE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_KNA1-REGIO&nbsp;=&nbsp;'010'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNPFE&nbsp;=&nbsp;GW_IN_TAB-SNPFE&nbsp;+&nbsp;LW_S901-ZXSJE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
*&nbsp;批发<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GW_IN_TAB-PFXSE&nbsp;&nbsp;=&nbsp;GW_IN_TAB-SPXSE&nbsp;-&nbsp;GW_IN_TAB-LSXSE&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;市外批发额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GW_IN_TAB-SWPFE&nbsp;&nbsp;=&nbsp;GW_IN_TAB-PFXSE&nbsp;-&nbsp;GW_IN_TAB-SNPFE.<br />
   </div>
   <div class="codeComment">
*&nbsp;出口<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GW_IN_TAB-CKXSE&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;对居民的零售额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GW_IN_TAB-JMLSE&nbsp;=&nbsp;GW_IN_TAB-LSXSE&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_BSID&nbsp;INTO&nbsp;LW_BSID.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_KNA1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_KNA1&nbsp;INTO&nbsp;LW_KNA1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;KUNNR&nbsp;=&nbsp;LW_BSID-KUNNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
**&nbsp;&nbsp;&nbsp;商品销售额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SPXSE&nbsp;=&nbsp;GW_IN_TAB-SPXSE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_BSID-HKONT&nbsp;BETWEEN&nbsp;'1122003001'&nbsp;AND&nbsp;'1122003002'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;批发额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-PFXSE&nbsp;=&nbsp;GW_IN_TAB-PFXSE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_KNA1-LAND1&nbsp;=&nbsp;'CN'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_KNA1-ORT01&nbsp;=&nbsp;'北京'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;市内批发<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SNPFE&nbsp;=&nbsp;GW_IN_TAB-SNPFE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;市外批发<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SWPFE&nbsp;=&nbsp;GW_IN_TAB-SWPFE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;出口<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-CKXSE&nbsp;=&nbsp;GW_IN_TAB-CKXSE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**&nbsp;&nbsp;&nbsp;零售额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-LSXSE&nbsp;=&nbsp;GW_IN_TAB-LSXSE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_BSID-KUNNR&nbsp;BETWEEN&nbsp;'0000008001'&nbsp;AND&nbsp;'0000008999'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-JMLSE&nbsp;=&nbsp;GW_IN_TAB-JMLSE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-SHLSE&nbsp;=&nbsp;GW_IN_TAB-SHLSE&nbsp;+&nbsp;LW_BSID-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="code">
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&取期末库存余额<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FM_GET_QMKCYE.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_TMP&nbsp;&nbsp;&nbsp;TYPE&nbsp;FAGLFLEXT-HSLVT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_FAG&nbsp;&nbsp;TYPE&nbsp;TYT_FAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FAG&nbsp;&nbsp;TYPE&nbsp;TY_FAG.<br />
   </div>
   <div class="codeComment">
*&nbsp;取期间发生额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;RBUKRS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RYEAR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RACCT&nbsp;&nbsp;"科目<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRCRK&nbsp;&nbsp;"借贷标识<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSLVT&nbsp;&nbsp;"期初余额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL01&nbsp;&nbsp;"期间01&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL02&nbsp;&nbsp;"期间02&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL03&nbsp;&nbsp;"期间03&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL04&nbsp;&nbsp;"期间04&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL05&nbsp;&nbsp;"期间05&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL06&nbsp;&nbsp;"期间06&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL07&nbsp;&nbsp;"期间07&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL08&nbsp;&nbsp;"期间08&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL09&nbsp;&nbsp;"期间09&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL10&nbsp;&nbsp;"期间10&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL11&nbsp;&nbsp;"期间11&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL12&nbsp;&nbsp;"期间12&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL13&nbsp;&nbsp;"期间13&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL14&nbsp;&nbsp;"期间14&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL15&nbsp;&nbsp;"期间15&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL16&nbsp;&nbsp;"期间16&nbsp;发生额<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;FAGLFLEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_FAG<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;RYEAR&nbsp;=&nbsp;G_YEAR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;RBUKRS&nbsp;IN&nbsp;S_BUKRS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;RACCT&nbsp;&nbsp;IN&nbsp;('1402001001','1405001001')<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
   </div>
   <div class="codeComment">
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GW_IN_TAB-QMKCYE.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_FAG&nbsp;INTO&nbsp;LW_FAG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;S_MONAT-LOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;L_INDEX&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-QMKCYE&nbsp;=&nbsp;GW_IN_TAB-QMKCYE&nbsp;+&nbsp;LW_FAG-HSLVT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;L_INDEX&nbsp;TIMES&nbsp;VARYING&nbsp;L_TMP&nbsp;FROM&nbsp;LW_FAG-HSL01&nbsp;NEXT&nbsp;LW_FAG-HSL02.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-QMKCYE&nbsp;=&nbsp;GW_IN_TAB-QMKCYE&nbsp;+&nbsp;L_TMP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDDO.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&取持银行卡零售额<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FM_GET_YHKLSE.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;fs&gt;.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_FAGA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOCNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;FAGLFLEXA-DOCNR&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRCRK&nbsp;&nbsp;&nbsp;TYPE&nbsp;FAGLFLEXA-DRCRK&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;FAGLFLEXA-HSL&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_FAGA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_FAGA&nbsp;LIKE&nbsp;LW_FAGA&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;TYPE&nbsp;NUMC2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_R_BUDAT&nbsp;TYPE&nbsp;RANGE&nbsp;OF&nbsp;BUDAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_R_BUDAT&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_R_BUDAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_FIELD&nbsp;TYPE&nbsp;CHAR30,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_TMP&nbsp;&nbsp;&nbsp;TYPE&nbsp;FAGLFLEXT-HSLVT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_FAG&nbsp;&nbsp;TYPE&nbsp;TYT_FAG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FAG&nbsp;&nbsp;TYPE&nbsp;TY_FAG.<br />
   </div>
   <div class="codeComment">
**&nbsp;取期间发生额<br />
*&nbsp;&nbsp;SELECT&nbsp;RBUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RYEAR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RACCT&nbsp;&nbsp;"科目<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DRCRK&nbsp;&nbsp;"借贷标识<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSLVT&nbsp;&nbsp;"期初余额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL01&nbsp;&nbsp;"期间01&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL02&nbsp;&nbsp;"期间02&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL03&nbsp;&nbsp;"期间03&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL04&nbsp;&nbsp;"期间04&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL05&nbsp;&nbsp;"期间05&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL06&nbsp;&nbsp;"期间06&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL07&nbsp;&nbsp;"期间07&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL08&nbsp;&nbsp;"期间08&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL09&nbsp;&nbsp;"期间09&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL10&nbsp;&nbsp;"期间10&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL11&nbsp;&nbsp;"期间11&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL12&nbsp;&nbsp;"期间12&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL13&nbsp;&nbsp;"期间13&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL14&nbsp;&nbsp;"期间14&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL15&nbsp;&nbsp;"期间15&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HSL16&nbsp;&nbsp;"期间16&nbsp;发生额<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;FAGLFLEXT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_FAG<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;RYEAR&nbsp;=&nbsp;G_YEAR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;RBUKRS&nbsp;IN&nbsp;S_BUKRS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;DRCRK&nbsp;=&nbsp;'S'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;RACCT&nbsp;BETWEEN&nbsp;'1221005002'&nbsp;AND&nbsp;'1221005020'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**<br />
*&nbsp;&nbsp;CLEAR&nbsp;GW_IN_TAB-YHKLSE.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_FAG&nbsp;INTO&nbsp;LW_FAG.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;S_MONAT-LOW.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_FIELD&nbsp;=&nbsp;'LW_FAG-HSL'&nbsp;&&&nbsp;L_INDEX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;(L_FIELD)&nbsp;TO&nbsp;&lt;FS&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-YHKLSE&nbsp;=&nbsp;GW_IN_TAB-YHKLSE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&lt;FS&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;L_INDEX&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;TIMES.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_FIELD&nbsp;=&nbsp;'LW_FAG-HSL'&nbsp;&&&nbsp;L_INDEX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;(L_FIELD)&nbsp;TO&nbsp;&lt;FS&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-YHKLSE&nbsp;=&nbsp;GW_IN_TAB-YHKLSE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&lt;FS&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;LW_R_BUDAT.<br />
&nbsp;&nbsp;LW_R_BUDAT-SIGN&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;LW_R_BUDAT-OPTION&nbsp;=&nbsp;'BT'.<br />
&nbsp;&nbsp;LW_R_BUDAT-LOW&nbsp;=&nbsp;G_YEAR&nbsp;&&&nbsp;S_MONAT-LOW&nbsp;&&&nbsp;'01'.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'FIMA_DATE_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_R_BUDAT-LOW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SET_LAST_DAY_OF_MONTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_R_BUDAT-HIGH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LW_R_BUDAT&nbsp;TO&nbsp;LT_R_BUDAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;取发生额<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;A~DOCNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~DRCRK<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~HSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_FAGA<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;FAGLFLEXA&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;BKPF&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~RYEAR&nbsp;=&nbsp;B~GJAHR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~DOCNR&nbsp;=&nbsp;B~BELNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~RBUKRS&nbsp;=&nbsp;B~BUKRS<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~RBUKRS&nbsp;IN&nbsp;S_BUKRS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~RYEAR&nbsp;=&nbsp;G_YEAR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~BLART&nbsp;=&nbsp;'RV'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~BUDAT&nbsp;IN&nbsp;LT_R_BUDAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~RACCT&nbsp;BETWEEN&nbsp;'1221005002'&nbsp;AND&nbsp;'1221005020'<br />
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GW_IN_TAB-YHKLSE.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_FAGA&nbsp;INTO&nbsp;LW_FAGA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LW_FAGA-DRCRK&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-YHKLSE&nbsp;=&nbsp;GW_IN_TAB-YHKLSE&nbsp;+&nbsp;LW_FAGA-HSL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GW_IN_TAB-YHKLSE&nbsp;=&nbsp;GW_IN_TAB-YHKLSE&nbsp;-&nbsp;LW_FAGA-HSL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&显示<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FM_SHOW_ALV.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LW_OUT_TAB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR20,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BENYUE&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TONGQI&nbsp;&nbsp;TYPE&nbsp;BSEG-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LW_OUT_TAB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1&nbsp;LIKE&nbsp;GW_IN_TAB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB2&nbsp;LIKE&nbsp;GW_IN_TAB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_OUT_TAB&nbsp;LIKE&nbsp;LW_OUT_TAB&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_FCAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_T_FCAT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_LAYO.<br />
   </div>
   <div class="codeComment">
*&nbsp;数据转换<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_IN_TAB&nbsp;INTO&nbsp;LW_IN_TAB1&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_IN_TAB&nbsp;INTO&nbsp;LW_IN_TAB2&nbsp;INDEX&nbsp;2.<br />
&nbsp;&nbsp;DEFINE&nbsp;DF_OUT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_OUT_TAB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_OUT_TAB-TXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_OUT_TAB-BENYUE&nbsp;=&nbsp;&2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_OUT_TAB-TONGQI&nbsp;=&nbsp;&3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_OUT_TAB&nbsp;TO&nbsp;LT_OUT_TAB.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
&nbsp;&nbsp;DF_OUT:<br />
&nbsp;&nbsp;&nbsp;&nbsp;'商品购进额'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-SPGJE&nbsp;LW_IN_TAB2-SPGJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　1.市内购进额'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-SNGJE&nbsp;LW_IN_TAB2-SNGJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　2.市外购进额'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-SWGJE&nbsp;LW_IN_TAB2-SWGJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　3.进口'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-JKGJE&nbsp;LW_IN_TAB2-JKGJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'商品销售额'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-SPXSE&nbsp;LW_IN_TAB2-SPXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　1.批发额'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-PFXSE&nbsp;LW_IN_TAB2-PFXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　　①市内批发额'&nbsp;&nbsp;&nbsp;LW_IN_TAB1-SNPFE&nbsp;LW_IN_TAB2-SNPFE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　　②市外批发额'&nbsp;&nbsp;&nbsp;LW_IN_TAB1-SWPFE&nbsp;LW_IN_TAB2-SWPFE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　　③出口'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-CKXSE&nbsp;LW_IN_TAB2-CKXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　2.零售额&nbsp;&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_IN_TAB1-LSXSE&nbsp;LW_IN_TAB2-LSXSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　　①对居民的零售额'&nbsp;LW_IN_TAB1-JMLSE&nbsp;LW_IN_TAB2-JMLSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　　②对社会集团的零售额'&nbsp;LW_IN_TAB1-SHLSE&nbsp;LW_IN_TAB2-SHLSE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'期末商品库存额&nbsp;&nbsp;'&nbsp;&nbsp;&nbsp;LW_IN_TAB1-QMKCYE&nbsp;LW_IN_TAB2-QMKCYE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;'商品销售总额中:	'&nbsp;&nbsp;&nbsp;''&nbsp;'',<br />
&nbsp;&nbsp;&nbsp;&nbsp;'　其中:持银行卡零售额&nbsp;&nbsp;'&nbsp;LW_IN_TAB1-YHKLSE&nbsp;LW_IN_TAB2-YHKLSE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;宏<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DEFINE&nbsp;DF_ADD_FIELDCAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_FIELDCAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"列位置<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"要显示的字段<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"字段名<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-JUST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"对齐方式<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"可编辑<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&6.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"引用表<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&7.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"引用字段<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-INTLEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"内部长度<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_FIELDCAT-INTTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&9&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_FIELDCAT&nbsp;TO&nbsp;LT_FIELDCAT.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;STEP1:创建FIELDCAT<br />
*&nbsp;固定部分<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DF_ADD_FIELDCAT:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;'TXT&nbsp;&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;TEXT-001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'L'&nbsp;''&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;'',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;'BENYUE&nbsp;'&nbsp;&nbsp;TEXT-002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'L'&nbsp;''&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;'',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;'TONGQI'&nbsp;&nbsp;&nbsp;TEXT-003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'L'&nbsp;''&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;''.<br />
<br />
&nbsp;&nbsp;LW_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;ABAP_TRUE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"优化列宽设置<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;调用ALV<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY_LVC'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT_LVC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT_LVC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_FIELDCAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_OUT_TAB<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E001(00)&nbsp;WITH&nbsp;'系统错误'&nbsp;SPACE&nbsp;SPACE&nbsp;SPACE.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;001&nbsp;指标名称<br />
*&nbsp;002&nbsp;本月<br />
*&nbsp;003&nbsp;上年同期<br />
*&nbsp;004&nbsp;进口<br />
*&nbsp;005&nbsp;商品销售额<br />
*&nbsp;006&nbsp;批发额<br />
*&nbsp;007&nbsp;零售额<br />
*&nbsp;008&nbsp;出口<br />
*&nbsp;009&nbsp;市内批发额<br />
*&nbsp;010&nbsp;市外批发额<br />
*&nbsp;011&nbsp;期末商品库存余额<br />
*&nbsp;012&nbsp;持银行卡零售额<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;S_BUKRS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;公司代码<br />
*&nbsp;S_GJAHR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;会计年度<br />
*&nbsp;S_MONAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;会计期间<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;00<br />
*001&nbsp;&nbsp;&nbsp;&1&2&3&4&5&6&7&8<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
