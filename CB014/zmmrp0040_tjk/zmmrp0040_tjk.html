<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZMMRP0040_TJK</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZMMRP0040_TJK</h2>
<h3> Description: 配货规则-匹配推荐款</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
REPORT ZMMRP0040_TJK.<br />
<br />
TYPE-POOLS: SLIS, VRM.<br />
TABLES ZMMEX0010_MARA.<br />
   </div>
   <div class="codeComment">
************************************************************************<br />
*&nbsp;Types<br />
************************************************************************<br />
   </div>
   <div class="code">
TYPES: BEGIN OF TY_MARA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;MARA-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_MARA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;TY_XSK_XL_KC,&nbsp;"&nbsp;相似款销量和库存<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XNKH&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-EX_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FKIMG&nbsp;&nbsp;&nbsp;TYPE&nbsp;VBRP-FKIMG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLABS&nbsp;&nbsp;&nbsp;TYPE&nbsp;MCHB-CLABS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_XSK_XL_KC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;TY_MCHB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;MCHB-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARG&nbsp;&nbsp;&nbsp;TYPE&nbsp;MCHB-CHARG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;&nbsp;TYPE&nbsp;MCHB-WERKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LGORT&nbsp;&nbsp;&nbsp;TYPE&nbsp;MCHB-LGORT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLABS&nbsp;&nbsp;&nbsp;TYPE&nbsp;MCHB-CLABS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEINS&nbsp;&nbsp;&nbsp;TYPE&nbsp;MARA-MEINS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XNKH&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-EX_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZJZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-ZJZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_MCHB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;TY_VBRP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBELN&nbsp;&nbsp;&nbsp;TYPE&nbsp;VBRP-VBELN,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;VBRP-POSNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZXSJS&nbsp;&nbsp;&nbsp;TYPE&nbsp;VBRP-ZXSJS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XNKH&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-EX_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_VBRP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;TY_XSK,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZYKS&nbsp;&nbsp;TYPE&nbsp;ZMMRP0040_XSK-ZYKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZXSK&nbsp;&nbsp;TYPE&nbsp;ZMMRP0040_XSK-ZXSK,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FKIMG&nbsp;TYPE&nbsp;VBRP-FKIMG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLABS&nbsp;TYPE&nbsp;MCHB-CLABS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_XSK,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;TY_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARG&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-CHARG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XNKH&nbsp;TYPE&nbsp;ZMMRP0210_BATCH-EX_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TY_XNKH&nbsp;&nbsp;.<br />
   </div>
   <div class="codeComment">
************************************************************************<br />
*&nbsp;Tables<br />
************************************************************************<br />
   </div>
   <div class="code">
DATA:<br />
&nbsp;&nbsp;GT_DATA&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ZMMRP0040_TJK,<br />
&nbsp;&nbsp;GS_DATA&nbsp;&nbsp;TYPE&nbsp;ZMMRP0040_TJK,<br />
&nbsp;&nbsp;G_EXTWG&nbsp;&nbsp;TYPE&nbsp;MARA-EXTWG.<br />
<br />
DATA: GS_MSG TYPE BAPIRET2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GT_MSG&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;GS_MSG.<br />
<br />
DATA: GRT_YKS_DEL TYPE RANGE OF ZMMRP0040_TJK-ZYKS ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRS_YKS_DEL&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GRT_YKS_DEL&nbsp;.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV显示字段属性内表和工作区<br />
   </div>
   <div class="code">
DATA: GT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT&nbsp;TYPE&nbsp;SLIS_FIELDCAT_ALV,<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV屏幕布局工作区<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_LAYOUT&nbsp;&nbsp;&nbsp;TYPE&nbsp;SLIS_LAYOUT_ALV,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GT_EVENTS&nbsp;&nbsp;&nbsp;TYPE&nbsp;SLIS_T_EVENT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_EVENTS&nbsp;&nbsp;&nbsp;TYPE&nbsp;SLIS_ALV_EVENT.<br />
DATA: GR_GRID TYPE REF TO CL_GUI_ALV_GRID.<br />
<br />
<br />
   </div>
   <div class="codeComment">
************************************************************************<br />
*&nbsp;Parameters<br />
************************************************************************<br />
   </div>
   <div class="code">
SELECTION-SCREEN BEGIN OF BLOCK B01 WITH FRAME TITLE TEXT-T01.<br />
SELECT-OPTIONS  S_EXTWG FOR  G_EXTWG OBLIGATORY.<br />
PARAMETERS      P_MONAT TYPE MONAT OBLIGATORY .<br />
SELECT-OPTIONS: S_GJS   FOR  ZMMEX0010_MARA-EX_GJS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_PZ01&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_PZ01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_PZ02&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_PZ02,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_PZ03&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_PZ03,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_PZ04&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_PZ04,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_ZT01&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_ZT01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_ZT02&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_ZT02,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_ZT03&nbsp;&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-EX_ZT03,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S_MATNR&nbsp;FOR&nbsp;&nbsp;ZMMEX0010_MARA-MATNR.<br />
SELECTION-SCREEN END OF BLOCK B01.<br />
SELECTION-SCREEN BEGIN OF BLOCK B02 WITH FRAME TITLE TEXT-T02.<br />
PARAMETERS      P_WERKS TYPE T001W-WERKS OBLIGATORY .<br />
SELECTION-SCREEN END OF BLOCK B02.<br />
<br />
SELECTION-SCREEN BEGIN OF BLOCK B03 WITH FRAME TITLE TEXT-T03.<br />
PARAMETERS: CBX_1 AS CHECKBOX DEFAULT '' .<br />
PARAMETERS: CBX_2 AS CHECKBOX DEFAULT 'X' .<br />
SELECTION-SCREEN END OF BLOCK B03.<br />
   </div>
   <div class="codeComment">
************************************************************************<br />
*&nbsp;At&nbsp;SELECTION-SCREEN<br />
************************************************************************<br />
   </div>
   <div class="code">
AT SELECTION-SCREEN.<br />
<br />
   </div>
   <div class="codeComment">
************************************************************************<br />
*&nbsp;Start&nbsp;of&nbsp;Selection<br />
************************************************************************<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
   </div>
   <div class="codeComment">
*&nbsp;取得数据<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FRM_GET_DATA.<br />
   </div>
   <div class="codeComment">
*&nbsp;保存数据<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FRM_UPDATE_DATA&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;展示报表<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;FRM_DIS_RESULT.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_GET_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_GET_DATA .<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DATA.<br />
<br />
&nbsp;&nbsp;GET&nbsp;TIME&nbsp;.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_MSG&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'推荐款计算开始，日期：'&nbsp;&&&nbsp;SY-DATUM&nbsp;.&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;'，时间：'&nbsp;&&&nbsp;SY-UZEIT&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;FRM_GET_TJK.<br />
<br />
&nbsp;&nbsp;GET&nbsp;TIME&nbsp;.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_MSG&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'推荐款计算结束，日期：'&nbsp;&&&nbsp;SY-DATUM&nbsp;.&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;'，时间：'&nbsp;&&&nbsp;SY-UZEIT&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_DIS_ALV<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_DIS_ALV .<br />
&nbsp;&nbsp;PERFORM&nbsp;FRM_BUILD_FIELDCAT.&nbsp;&nbsp;&nbsp;"&nbsp;设置显示字段属性<br />
&nbsp;&nbsp;PERFORM&nbsp;FRM_BUILD_LAYOUT.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;设置屏幕布局<br />
&nbsp;&nbsp;PERFORM&nbsp;FRM_ALV_DISPLAY.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV显示<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_BUILD_FIELDCAT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设置显示字段属性<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_BUILD_FIELDCAT .<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZYKS'&nbsp;&nbsp;'原款'&nbsp;&nbsp;&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ1'&nbsp;&nbsp;'推荐款1'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ2'&nbsp;&nbsp;'推荐款2'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ3'&nbsp;&nbsp;'推荐款3'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ4'&nbsp;&nbsp;'推荐款4'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ5'&nbsp;&nbsp;'推荐款5'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ6'&nbsp;&nbsp;'推荐款6'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ7'&nbsp;&nbsp;'推荐款7'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ8'&nbsp;&nbsp;'推荐款8'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ9'&nbsp;&nbsp;'推荐款9'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ10'&nbsp;'推荐款10'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZTJ10'&nbsp;'推荐款10'&nbsp;12.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS1'&nbsp;'库存1'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS2'&nbsp;'库存2'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS3'&nbsp;'库存3'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS4'&nbsp;'库存4'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS5'&nbsp;'库存5'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS6'&nbsp;'库存6'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS7'&nbsp;'库存7'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS8'&nbsp;'库存8'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS9'&nbsp;'库存9'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZCLABS10'&nbsp;'库存10'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG1'&nbsp;'销量1'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG2'&nbsp;'销量2'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG3'&nbsp;'销量3'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG4'&nbsp;'销量4'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG5'&nbsp;'销量5'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG6'&nbsp;'销量6'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG7'&nbsp;'销量7'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG8'&nbsp;'销量8'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG9'&nbsp;'销量9'&nbsp;6.<br />
&nbsp;&nbsp;PERFORM&nbsp;SUB_SET_FIELDS&nbsp;USING&nbsp;'ZFKIMG10'&nbsp;'销量10'&nbsp;6.<br />
ENDFORM.                    " FRM_BUILD_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SUB_SET_FIELDS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SUB_SET_FIELDS USING I_FIELDNAME TYPE SLIS_FIELDNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_REPTEXT&nbsp;TYPE&nbsp;DD03P-REPTEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_OUTPUTLEN&nbsp;TYPE&nbsp;DD03P-OUTPUTLEN.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;I_FIELDNAME.<br />
&nbsp;&nbsp;GS_FIELDCAT-REPTEXT_DDIC&nbsp;=&nbsp;I_REPTEXT.<br />
&nbsp;&nbsp;GS_FIELDCAT-NO_ZERO&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;I_OUTPUTLEN.<br />
&nbsp;&nbsp;IF&nbsp;I_FIELDNAME&nbsp;=&nbsp;'BOX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CHECKBOX&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
ENDFORM.                    "SUB_SET_FIELDS<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_BUILD_LAYOUT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设置屏幕布局<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_BUILD_LAYOUT .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;输出长度的最优化设计<br />
*&nbsp;&nbsp;gs_layout-colwidth_optimize&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;gs_layout-box_fieldname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BOX'.<br />
<br />
   </div>
   <div class="code">
ENDFORM.                    " FRM_BUILD_LAYOUT<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_ALV_DISPLAY<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALV显示<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_ALV_DISPLAY .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;调用ALV&nbsp;FUNCTION<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'FRM_PF_STATUS_SET'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'FRM_USER_COMMAND'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_HTML_TOP_OF_PAGE&nbsp;=&nbsp;'HTML_TOP_OF_PAGE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DATA.<br />
<br />
ENDFORM.                    " FRM_ALV_DISPLAY<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_PF_STATUS_SET<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设置状态栏<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_PF_STATUS_SET USING RT_EXTAB TYPE SLIS_T_EXTAB.<br />
<br />
&nbsp;&nbsp;SET&nbsp;PF-STATUS&nbsp;'STANDARD'.<br />
<br />
ENDFORM.                    " FRM_PF_STATUS_SET<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;定义按钮功能<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_USER_COMMAND  USING R_UCOMM LIKE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS_SELFIELD&nbsp;TYPE&nbsp;SLIS_SELFIELD.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;G_GRID&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.&nbsp;"&nbsp;刷新数据<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GET_GLOBALS_FROM_SLVC_FULLSCR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_GRID&nbsp;=&nbsp;G_GRID.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;G_GRID-&gt;CHECK_CHANGED_DATA.<br />
&nbsp;&nbsp;IF&nbsp;NOT&nbsp;G_GRID&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;G_GRID-&gt;REFRESH_TABLE_DISPLAY.&nbsp;"refresh&nbsp;alv<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;R_UCOMM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SAVE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FRM_UPDATE_DATA.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;RS_SELFIELD-REFRESH&nbsp;=&nbsp;'X'.<br />
<br />
ENDFORM.                    " FRM_USER_COMMAND<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_GET_TJK<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_GET_TJK .<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_MARA_YKS&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_MARA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_MARA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_MARA,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_BATCH_YKS&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_BATCH_XSK&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_BATCH_YKS&nbsp;&nbsp;TYPE&nbsp;TY_XNKH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_XSK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_XSK,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_XSK,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_XSK_TMP&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LT_XSK&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_VBRP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_VBRP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_VBRP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_VBRP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_MCHB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_MCHB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_MCHB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_MCHB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_XSK_XL_KC&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TY_XSK_XL_KC,&nbsp;"&nbsp;相似款的销量和库存<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC&nbsp;&nbsp;TYPE&nbsp;TY_XSK_XL_KC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_COUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_MONAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;NUMC3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LT_DELEVLGORT&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ZMM_DELEVLGORT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_DELEVLGORT&nbsp;TYPE&nbsp;ZMM_DELEVLGORT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_DATUM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;SY-DATUM.<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LS_XSK&gt;&nbsp;LIKE&nbsp;LS_XSK&nbsp;.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LRT_EXTWG&nbsp;&nbsp;TYPE&nbsp;RANGE&nbsp;OF&nbsp;MARA-EXTWG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LRS_EXTWG&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LRT_EXTWG&nbsp;.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_PP&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ZMMRP0040_XSKPP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_PP&nbsp;TYPE&nbsp;ZMMRP0040_XSKPP.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_XSK_XNKH&nbsp;TYPE&nbsp;zcb01_ty_t_xnkh&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XNKH&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_XSK_XNKH&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lrt_werks&nbsp;TYPE&nbsp;zcb01_ty_r_werks&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lrs_werks&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;lrt_werks&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lrt_lgort&nbsp;TYPE&nbsp;zcb01_ty_r_lgort&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lrs_lgort&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;lrt_lgort&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_stock&nbsp;TYPE&nbsp;zcb01_ty_t_stock,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_stock&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;lt_stock&nbsp;.<br />
<br />
&nbsp;&nbsp;"&nbsp;根据输出参数P_MONAT倒推统计销量的第一天<br />
&nbsp;&nbsp;CLEAR&nbsp;L_DATUM.<br />
&nbsp;&nbsp;L_MONAT&nbsp;=&nbsp;P_MONAT.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'CCM_GO_BACK_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRDATE&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BACKMONTHS&nbsp;=&nbsp;L_MONAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEWDATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_DATUM.<br />
&nbsp;&nbsp;IF&nbsp;L_DATUM&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'销售起始日期取得错误！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_DELEVLGORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMM_DELEVLGORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;=&nbsp;P_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EXTWG&nbsp;IN&nbsp;S_EXTWG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KCDFLG&nbsp;=&nbsp;'01'&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'在配置表ZMM_DELEVLGORT中没有维护地点'&nbsp;&&&nbsp;P_WERKS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;'，以及您输入的商品大类的配货库存地点！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;REFRESH:&nbsp;LRT_EXTWG,LRT_LGORT&nbsp;.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_DELEVLGORT&nbsp;INTO&nbsp;LS_DELEVLGORT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LRS_EXTWG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_EXTWG-SIGN&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_EXTWG-OPTION&nbsp;=&nbsp;'EQ'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_EXTWG-LOW&nbsp;=&nbsp;LS_DELEVLGORT-EXTWG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_EXTWG-HIGH&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LRS_EXTWG&nbsp;TO&nbsp;LRT_EXTWG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_LGORT-SIGN&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_LGORT-OPTION&nbsp;=&nbsp;'EQ'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_LGORT-LOW&nbsp;=&nbsp;LS_DELEVLGORT-LGORT&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LRS_LGORT-HIGH&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LRS_LGORT&nbsp;TO&nbsp;LRT_LGORT&nbsp;.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"&nbsp;取得所有相似款匹配规则，在该表中品种四级是KEY值，如果品种四级没有在<br />
&nbsp;&nbsp;"&nbsp;这个表中维护，就不需要匹配相似款，那也就不用计算推荐款了<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_PP<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMMRP0040_XSKPP<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;EX_PZ04&nbsp;IN&nbsp;S_PZ04&nbsp;.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SELECT&nbsp;MARA~MATNR&nbsp;MARA~EXTWG&nbsp;ZMMEX0010_MARA~EX_PZ04<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;MARA~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_MARA_YKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;MARA&nbsp;INNER&nbsp;JOIN&nbsp;ZMMEX0010_MARA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;MARA~MATNR&nbsp;=&nbsp;ZMMEX0010_MARA~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_PP<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;MARA~EXTWG&nbsp;IN&nbsp;LRT_EXTWG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MARA~MATNR&nbsp;IN&nbsp;S_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_GJS&nbsp;&nbsp;IN&nbsp;S_GJS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_PZ01&nbsp;IN&nbsp;S_PZ01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_PZ02&nbsp;IN&nbsp;S_PZ02<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_PZ03&nbsp;IN&nbsp;S_PZ03<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_ZT01&nbsp;IN&nbsp;S_ZT01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_ZT02&nbsp;IN&nbsp;S_ZT02<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_ZT03&nbsp;IN&nbsp;S_ZT03<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMEX0010_MARA~EX_PZ04&nbsp;=&nbsp;LT_PP-EX_PZ04&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'在表MARA没有找到需要计算推荐款的商品！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;LT_BATCH_YKS.<br />
<br />
&nbsp;&nbsp;"&nbsp;需要计算推荐款的虚拟款号，以下称原款<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SELECT&nbsp;MATNR&nbsp;EX_XNKH<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;EX_XNKH<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_BATCH_YKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMMRP0210_BATCH<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_MARA_YKS<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LT_MARA_YKS-MATNR.<br />
&nbsp;&nbsp;IF&nbsp;LT_BATCH_YKS[]&nbsp;IS&nbsp;INITIAL&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'在表ZMMRP0210_BATCH没有找到需要计算推荐款的虚拟款号！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SORT&nbsp;LT_BATCH_YKS&nbsp;BY&nbsp;MATNR&nbsp;EX_XNKH.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;LT_BATCH_YKS&nbsp;BY&nbsp;EX_XNKH.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT_BATCH_YKS&nbsp;COMPARING&nbsp;EX_XNKH.<br />
<br />
&nbsp;&nbsp;"&nbsp;取得原款与相似款对应表，以下称相似款<br />
&nbsp;&nbsp;SELECT&nbsp;ZYKS&nbsp;ZXSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_XSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMMRP0040_XSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_BATCH_YKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ZYKS&nbsp;=&nbsp;LT_BATCH_YKS-EX_XNKH.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'在表ZMMRP0040_XSK没有找到相似款，无法计算推荐款！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_XSK&nbsp;INTO&nbsp;LS_XSK&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_XSK_XNKH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XNKH-EX_XNKH&nbsp;=&nbsp;LS_XSK-ZXSK&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_XSK_XNKH&nbsp;TO&nbsp;LT_XSK_XNKH&nbsp;.<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;SORT&nbsp;LT_XSK_XNKH&nbsp;BY&nbsp;EX_XNKH&nbsp;.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT_XSK_XNKH&nbsp;COMPARING&nbsp;EX_XNKH&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;LT_XSK_XNKH[]&nbsp;&nbsp;IS&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'没有找到相似款，无法计算推荐款！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CLEAR&nbsp;LS_XSK&nbsp;.<br />
*&nbsp;&nbsp;LT_XSK_TMP[]&nbsp;=&nbsp;LT_XSK[]&nbsp;.<br />
*&nbsp;&nbsp;MODIFY&nbsp;LT_XSK_TMP&nbsp;FROM&nbsp;LS_XSK&nbsp;TRANSPORTING&nbsp;ZYKS&nbsp;WHERE&nbsp;ZXSK&nbsp;&lt;&gt;&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;SORT&nbsp;LT_XSK_TMP&nbsp;BY&nbsp;ZXSK&nbsp;.<br />
*&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT_XSK_TMP&nbsp;COMPARING&nbsp;ZXSK&nbsp;.<br />
*&nbsp;&nbsp;IF&nbsp;LT_XSK_TMP[]&nbsp;&nbsp;IS&nbsp;INITIAL&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'没有找到相似款，无法计算推荐款！'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;相似款的虚拟款号信息<br />
   </div>
   <div class="codeComment">
*&nbsp;方案一<br />
*&nbsp;&nbsp;SELECT&nbsp;MATNR&nbsp;CHARG&nbsp;EX_XNKH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_BATCH_XSK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMMRP0210_BATCH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_XSK_TMP<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;EX_XNKH&nbsp;=&nbsp;LT_XSK_TMP-ZXSK.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'没有找到相似款的虚拟款号！'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
*&nbsp;&nbsp;ENDIF.<br />
*&nbsp;相似款的按商品+批次的销售数量<br />
*&nbsp;&nbsp;REFRESH:&nbsp;LT_VBRP.<br />
*&nbsp;&nbsp;"&nbsp;to-do&nbsp;未来这个数据从信息结构中提取，提高效率<br />
*&nbsp;方案一<br />
*&nbsp;&nbsp;SELECT&nbsp;VBRP~VBELN<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBRP~VBELP<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBRP~ZXSJS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZMMRP0210_BATCH~EX_XNKH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_VBRP<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;VBRK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;VBRP&nbsp;ON&nbsp;VBRK~VBELN&nbsp;=&nbsp;VBRP~VBELN<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;ZMMRP0210_BATCH&nbsp;ON&nbsp;VBRP~MATNR&nbsp;=&nbsp;ZMMRP0210_BATCH~MATNR&nbsp;AND<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBRP~CHARG&nbsp;=&nbsp;ZMMRP0210_BATCH~CHARG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_BATCH_XSK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBRK~FKDAT&nbsp;BETWEEN&nbsp;L_DATUM&nbsp;AND&nbsp;SY-DATUM<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;VBRK~FKART&nbsp;IN&nbsp;('ZF2','FP')<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;VBRP~MATNR&nbsp;=&nbsp;LT_BATCH_XSK-MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;VBRP~CHARG&nbsp;=&nbsp;LT_BATCH_XSK-CHARG&nbsp;.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_VBRP&nbsp;INTO&nbsp;LS_VBRP.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_XSK_XL_KC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-EX_XNKH&nbsp;=&nbsp;LS_VBRP-EX_XNKH&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-FKIMG&nbsp;=&nbsp;LS_VBRP-ZXSJS&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;LS_XSK_XL_KC&nbsp;INTO&nbsp;LT_XSK_XL_KC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*&nbsp;&nbsp;ENDIF.<br />
*&nbsp;相似款的按商品+批次的库存<br />
*&nbsp;&nbsp;REFRESH:&nbsp;LT_MCHB&nbsp;.<br />
*&nbsp;方案一<br />
*&nbsp;&nbsp;SELECT&nbsp;MCHB~MATNR&nbsp;MCHB~CHARG&nbsp;MCHB~WERKS&nbsp;MCHB~LGORT&nbsp;MCHB~CLABS&nbsp;MARA~MEINS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZMMRP0210_BATCH~EX_XNKH&nbsp;ZMMRP0210_BATCH~ZJZ<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_MCHB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;MCHB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;MARA&nbsp;ON&nbsp;MCHB~MATNR&nbsp;=&nbsp;MARA~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;ZMMRP0210_BATCH&nbsp;ON&nbsp;MCHB~MATNR&nbsp;=&nbsp;ZMMRP0210_BATCH~MATNR&nbsp;AND<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MCHB~CHARG&nbsp;=&nbsp;ZMMRP0210_BATCH~CHARG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_BATCH_XSK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LT_BATCH_XSK-MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CHARG&nbsp;=&nbsp;LT_BATCH_XSK-CHARG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;P_WERKS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LGORT&nbsp;IN&nbsp;LRT_LGORT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CLABS&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_MCHB&nbsp;INTO&nbsp;LS_MCHB.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_XSK_XL_KC&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-EX_XNKH&nbsp;=&nbsp;LS_MCHB-EX_XNKH&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_MCHB-MEINS&nbsp;=&nbsp;'ST'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_MCHB-CLABS&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_MCHB-ZJZ&nbsp;&lt;&gt;&nbsp;0&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_MCHB-CLABS&nbsp;/&nbsp;LS_MCHB-ZJZ&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_MCHB-CLABS&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;LS_XSK_XL_KC&nbsp;INTO&nbsp;LT_XSK_XL_KC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
*&nbsp;方案二：<br />
*&nbsp;1.&nbsp;先取库存，对于没有库存的虚拟款号，没有必要取销量了<br />
*&nbsp;2.&nbsp;与方案一相比，使用虚拟款号来查询，而不是通过商品号码+批次号码查询，主要是担心&nbsp;LT_BATCH_XSK中数量太大<br />
*&nbsp;相似款的按商品+批次的库存<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LRS_WERKS-SIGN&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;LRS_WERKS-OPTION&nbsp;=&nbsp;'EQ'&nbsp;.<br />
&nbsp;&nbsp;LRS_WERKS-LOW&nbsp;=&nbsp;P_WERKS&nbsp;.<br />
&nbsp;&nbsp;LRS_WERKS-HIGH&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LRS_WERKS&nbsp;TO&nbsp;LRT_WERKS&nbsp;.<br />
<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zmm_get_stock_xnkh/zmm_get_stock_xnkh.html">'ZMM_GET_STOCK_XNKH'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IM_HAS_ZCT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_XNKH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_XSK_XNKH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR_WERKS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LRT_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR_LGORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LRT_LGORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_STOCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_STOCK<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMPTY_IT_XNKH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMPTY_IR_WERKS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LT_STOCK[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_STOCK&nbsp;INTO&nbsp;LS_STOCK&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_XSK_XL_KC&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-EX_XNKH&nbsp;=&nbsp;LS_STOCK-EX_XNKH&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_STOCK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;LS_XSK_XL_KC&nbsp;INTO&nbsp;LT_XSK_XL_KC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'所有相似款都没有库存，没有必要计算推荐款了！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;REFRESH:&nbsp;LT_MCHB&nbsp;.<br />
*&nbsp;&nbsp;SELECT&nbsp;MCHB~MATNR&nbsp;MCHB~CHARG&nbsp;MCHB~WERKS&nbsp;MCHB~LGORT&nbsp;MCHB~CLABS&nbsp;MARA~MEINS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZMMRP0210_BATCH~EX_XNKH&nbsp;ZMMRP0210_BATCH~ZJZ<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_MCHB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;MCHB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;MARA&nbsp;ON&nbsp;MCHB~MATNR&nbsp;=&nbsp;MARA~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;ZMMRP0210_BATCH&nbsp;ON&nbsp;MCHB~MATNR&nbsp;=&nbsp;ZMMRP0210_BATCH~MATNR&nbsp;AND<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MCHB~CHARG&nbsp;=&nbsp;ZMMRP0210_BATCH~CHARG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_XSK_TMP<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ZMMRP0210_BATCH~EX_XNKH&nbsp;=&nbsp;LT_XSK_TMP-ZXSK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MCHB~WERKS&nbsp;=&nbsp;P_WERKS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MCHB~LGORT&nbsp;IN&nbsp;LRT_LGORT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MCHB~CLABS&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_MCHB&nbsp;INTO&nbsp;LS_MCHB.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_XSK_XL_KC&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-EX_XNKH&nbsp;=&nbsp;LS_MCHB-EX_XNKH&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_MCHB-MEINS&nbsp;=&nbsp;'ST'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_MCHB-CLABS&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_MCHB-ZJZ&nbsp;&lt;&gt;&nbsp;0&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_MCHB-CLABS&nbsp;/&nbsp;LS_MCHB-ZJZ&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-CLABS&nbsp;=&nbsp;LS_MCHB-CLABS&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;LS_XSK_XL_KC&nbsp;INTO&nbsp;LT_XSK_XL_KC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'所有相似款都没有库存，没有必要计算推荐款了！'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
*&nbsp;相似款的销售数量<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH:&nbsp;LT_VBRP.<br />
&nbsp;&nbsp;SELECT&nbsp;VBRP~VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBRP~POSNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBRP~ZXSJS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZMMRP0210_BATCH~EX_XNKH<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_VBRP<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;VBRK<br />
&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;VBRP&nbsp;ON&nbsp;VBRK~VBELN&nbsp;=&nbsp;VBRP~VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;ZMMRP0210_BATCH&nbsp;ON&nbsp;VBRP~MATNR&nbsp;=&nbsp;ZMMRP0210_BATCH~MATNR&nbsp;AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBRP~CHARG&nbsp;=&nbsp;ZMMRP0210_BATCH~CHARG<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;LT_XSK_XL_KC<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBRK~FKDAT&nbsp;BETWEEN&nbsp;L_DATUM&nbsp;AND&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;VBRK~FKART&nbsp;IN&nbsp;('ZF2','FP')<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ZMMRP0210_BATCH~EX_XNKH&nbsp;=&nbsp;LT_XSK_XL_KC-EX_XNKH.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_VBRP&nbsp;INTO&nbsp;LS_VBRP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_XSK_XL_KC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-EX_XNKH&nbsp;=&nbsp;LS_VBRP-EX_XNKH&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_XSK_XL_KC-FKIMG&nbsp;=&nbsp;LS_VBRP-ZXSJS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;LS_XSK_XL_KC&nbsp;INTO&nbsp;LT_XSK_XL_KC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;LT_XSK_XL_KC&nbsp;BY&nbsp;EX_XNKH&nbsp;.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_XSK&nbsp;ASSIGNING&nbsp;&lt;LS_XSK&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_XSK_XL_KC&nbsp;INTO&nbsp;LS_XSK_XL_KC&nbsp;WITH&nbsp;KEY&nbsp;EX_XNKH&nbsp;=&nbsp;&lt;LS_XSK&gt;-ZXSK&nbsp;BINARY&nbsp;SEARCH&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;LS_XSK&gt;-FKIMG&nbsp;=&nbsp;LS_XSK_XL_KC-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;LS_XSK&gt;-CLABS&nbsp;=&nbsp;LS_XSK_XL_KC-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;LT_XSK&nbsp;BY&nbsp;ZYKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLABS&nbsp;DESCENDING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FKIMG&nbsp;DESCENDING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZXSK&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DATA&nbsp;.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_BATCH_YKS&nbsp;INTO&nbsp;LS_BATCH_YKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;GS_DATA,LV_COUNT&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZYKS&nbsp;=&nbsp;LS_BATCH_YKS-EX_XNKH&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_XSK&nbsp;INTO&nbsp;LS_XSK&nbsp;WHERE&nbsp;ZYKS&nbsp;=&nbsp;LS_BATCH_YKS-EX_XNKH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CLABS&nbsp;&gt;&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_COUNT&nbsp;=&nbsp;LV_COUNT&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LV_COUNT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ1&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG1&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS1&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ2&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG2&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS2&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ3&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG3&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS3&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ4&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG4&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS4&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ5&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG5&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS5&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;6.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ6&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG6&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS6&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;7.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ7&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG7&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS7&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ8&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG8&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS8&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ9&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG9&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS9&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZTJ10&nbsp;=&nbsp;LS_XSK-ZXSK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZFKIMG10&nbsp;=&nbsp;LS_XSK-FKIMG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ZCLABS10&nbsp;=&nbsp;LS_XSK-CLABS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LV_COUNT&nbsp;&gt;=&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DATA-ZTJ1&nbsp;IS&nbsp;NOT&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;只有找到推荐款的才保存<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DATA&nbsp;TO&nbsp;GT_DATA&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;没有找到推荐款的原款式，要从表ZMMRP0040_TJK中删除<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GRS_YKS_DEL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRS_YKS_DEL-SIGN&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRS_YKS_DEL-OPTION&nbsp;=&nbsp;'EQ'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRS_YKS_DEL-LOW&nbsp;=&nbsp;GS_DATA-ZYKS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRS_YKS_DEL-HIGH&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GRS_YKS_DEL&nbsp;TO&nbsp;GRT_YKS_DEL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_UPDATE_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_UPDATE_DATA .<br />
&nbsp;&nbsp;DATA:&nbsp;LV_LINES&nbsp;TYPE&nbsp;I&nbsp;.<br />
<br />
&nbsp;&nbsp;IF&nbsp;CBX_2&nbsp;=&nbsp;'X'&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_LINES&nbsp;=&nbsp;LINES(&nbsp;GT_DATA&nbsp;)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'您选择的是模拟执行，不需要保存数据！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;'本次为'&nbsp;&&&nbsp;LV_LINES&nbsp;&&&nbsp;'条虚拟款计算了推荐款！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_LINES&nbsp;=&nbsp;LINES(&nbsp;GRT_YKS_DEL&nbsp;)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;'本次有'&nbsp;&&&nbsp;LV_LINES&nbsp;&&&nbsp;'条虚拟款没有推荐款！'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GT_DATA[]&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;GRT_YKS_DEL[]&nbsp;IS&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'本次执行没有数据需要保存！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;.<br />
&nbsp;&nbsp;ENDIF&nbsp;.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GRT_YKS_DEL[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;FROM&nbsp;ZMMRP0040_TJK&nbsp;WHERE&nbsp;ZYKS&nbsp;IN&nbsp;GRT_YKS_DEL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'本次执行有'&nbsp;&&&nbsp;SY-DBCNT&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;'条虚拟款没有推荐款，因此从表ZMMRP0040_TJK中删除原有记录！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GT_DATA[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DATA&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GET&nbsp;TIME&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-AEDAT&nbsp;=&nbsp;SY-DATUM&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-AEZET&nbsp;=&nbsp;SY-UZEIT&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-AENAM&nbsp;=&nbsp;SY-UNAME&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;TRANSPORTING&nbsp;AEDAT&nbsp;AEZET&nbsp;AENAM&nbsp;WHERE&nbsp;ZYKS&nbsp;&lt;&gt;&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;保存到数据库<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;ZMMRP0040_TJK&nbsp;FROM&nbsp;TABLE&nbsp;GT_DATA&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_LINES&nbsp;=&nbsp;LINES(&nbsp;GT_DATA&nbsp;)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZCB'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'000'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V1&nbsp;=&nbsp;'本次执行有'&nbsp;&&&nbsp;LV_LINES&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V2&nbsp;=&nbsp;'条虚拟款的推荐款信息保存到表ZMMRP0040_TJK中！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V3&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSG-MESSAGE_V4&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSG&nbsp;TO&nbsp;GT_MSG&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_DIS_RESULT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_DIS_RESULT .<br />
&nbsp;&nbsp;IF&nbsp;CBX_1&nbsp;=&nbsp;''&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FRM_WRITE_MSG&nbsp;.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FRM_DIS_ALV&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FRM_WRITE_MSG<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FRM_WRITE_MSG .<br />
&nbsp;&nbsp;DATA&nbsp;LV_STR&nbsp;TYPE&nbsp;STRING&nbsp;.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MSG&nbsp;INTO&nbsp;GS_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;GS_MSG-ID&nbsp;TYPE&nbsp;GS_MSG-TYPE&nbsp;NUMBER&nbsp;GS_MSG-NUMBER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_STR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;GS_MSG-MESSAGE_V1&nbsp;GS_MSG-MESSAGE_V2&nbsp;GS_MSG-MESSAGE_V3&nbsp;GS_MSG-MESSAGE_V4&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WRITE:&nbsp;/&nbsp;LV_STR&nbsp;.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
<br />
FORM HTML_TOP_OF_PAGE USING CL_DD TYPE REF TO CL_DD_DOCUMENT.<br />
&nbsp;&nbsp;DATA&nbsp;LV_TEXT&nbsp;TYPE&nbsp;C&nbsp;LENGTH&nbsp;255&nbsp;.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MSG&nbsp;INTO&nbsp;GS_MSG&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;GS_MSG-ID&nbsp;TYPE&nbsp;GS_MSG-TYPE&nbsp;NUMBER&nbsp;GS_MSG-NUMBER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;GS_MSG-MESSAGE_V1&nbsp;GS_MSG-MESSAGE_V2&nbsp;GS_MSG-MESSAGE_V3&nbsp;GS_MSG-MESSAGE_V4&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_DD-&gt;ADD_TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;=&nbsp;LV_TEXT&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_DD-&gt;NEW_LINE&nbsp;.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM .<br />
<br />
   </div>
   <div class="codeComment">
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;T01&nbsp;选择条件<br />
*&nbsp;T02&nbsp;动作<br />
*&nbsp;T03&nbsp;选择结果保存方式<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;CBX_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以ALV显示相似款匹配结果（数据量大时请勿选择）<br />
*&nbsp;CBX_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;模拟执行，不将结果保存到数据库<br />
*&nbsp;P_MONAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;销售统计月数<br />
*&nbsp;P_WERKS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为该物流中心的库存计算推荐款<br />
*&nbsp;S_EXTWG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;商品大类<br />
*&nbsp;S_GJS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;贵金属材质<br />
*&nbsp;S_MATNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;商品编码<br />
*&nbsp;S_PZ01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;品种一级<br />
*&nbsp;S_PZ02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;品种二级<br />
*&nbsp;S_PZ03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;品种三级<br />
*&nbsp;S_PZ04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;品种四级<br />
*&nbsp;S_ZT01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;主题一级<br />
*&nbsp;S_ZT02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;主题二级<br />
*&nbsp;S_ZT03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;主题三级<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
