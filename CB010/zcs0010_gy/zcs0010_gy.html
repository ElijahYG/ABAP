<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZCS0010_GY</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZCS0010_GY</h2>
<h3> Description: 测试练习程序</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
REPORT  Z_OOALV.<br />
<br />
TYPE-POOLS: ICON.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&引入表<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TABLES: SFLIGHT,ZMMIF0150_PDITEM.<br />
<br />
<br />
CLASS LCL_EVENT_RECEIVER DEFINITION DEFERRED."for event handling<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&CLASS&nbsp;定义<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CLASS LCL_EVENT_RECEIVER DEFINITION.<br />
&nbsp;&nbsp;PUBLIC&nbsp;SECTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;METHODS:<br />
   </div>
   <div class="codeComment">
*&nbsp;修改工具栏<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;&nbsp;TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_OBJECT,"&nbsp;E_INTERACTIVE,<br />
   </div>
   <div class="codeComment">
*&nbsp;响应用户命令<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_USER_COMMAND&nbsp;&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;&nbsp;USER_COMMAND&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_UCOMM,<br />
   </div>
   <div class="codeComment">
****************************************以下定义的方法必要的时候可激活<br />
*Hotspot&nbsp;click&nbsp;control<br />
*热点点击控制<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_HOTSPOT_CLICK&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;HOTSPOT_CLICK&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_ROW_ID&nbsp;E_COLUMN_ID&nbsp;ES_ROW_NO&nbsp;,<br />
   </div>
   <div class="codeComment">
*Double-click&nbsp;control<br />
*双击控制<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_DOUBLE_CLICK&nbsp;&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;DOUBLE_CLICK&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_ROW&nbsp;E_COLUMN&nbsp;ES_ROW_NO,<br />
   </div>
   <div class="codeComment">
*To&nbsp;be&nbsp;triggered&nbsp;before&nbsp;user&nbsp;commands<br />
*在用户命令之前被触发<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_BEFORE_USER_COMMAND&nbsp;FOR&nbsp;EVENT&nbsp;BEFORE_USER_COMMAND&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_UCOMM,<br />
   </div>
   <div class="codeComment">
*Controlling&nbsp;data&nbsp;changes&nbsp;when&nbsp;ALV&nbsp;Grid&nbsp;is&nbsp;editable<br />
*控制数据变化时，可编辑网格<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_DATA_CHANGED<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;DATA_CHANGED&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING&nbsp;ER_DATA_CHANGED&nbsp;,<br />
   </div>
   <div class="codeComment">
*To&nbsp;be&nbsp;triggered&nbsp;after&nbsp;data&nbsp;changing&nbsp;is&nbsp;finished<br />
**在完成数据更改后触发<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_DATA_CHANGED_FINISHED<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;DATA_CHANGED_FINISHED&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING&nbsp;E_MODIFIED&nbsp;,<br />
   </div>
   <div class="codeComment">
*To&nbsp;control&nbsp;menu&nbsp;buttons<br />
*控制菜单按钮<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE_MENU_BUTTON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;EVENT&nbsp;MENU_BUTTON&nbsp;OF&nbsp;CL_GUI_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING&nbsp;E_OBJECT&nbsp;E_UCOMM&nbsp;.<br />
<br />
ENDCLASS.                    "lcl_event_receiver DEFINITION<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLASS&nbsp;lcl_event_receiver&nbsp;IMPLEMENTATION<br />
*----------------------------------------------------------------------*<br />
**&CLASS&nbsp;实现<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CLASS LCL_EVENT_RECEIVER IMPLEMENTATION.<br />
   </div>
   <div class="codeComment">
*&nbsp;修改工具栏<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FM_SET_TOOLBAR&nbsp;CHANGING&nbsp;&nbsp;E_OBJECT.<br />
&nbsp;&nbsp;ENDMETHOD.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_toolbar<br />
   </div>
   <div class="codeComment">
*&nbsp;响应用户命令<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_USER_COMMAND.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FM_USER_COMMAND&nbsp;USING&nbsp;E_UCOMM.<br />
&nbsp;&nbsp;ENDMETHOD.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_user_command<br />
<br />
   </div>
   <div class="codeComment">
*Handle&nbsp;Hotspot&nbsp;Click<br />
*处理热点点击<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_HOTSPOT_CLICK&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;handle_hotspot_click&nbsp;USING&nbsp;e_row_id&nbsp;e_column_id&nbsp;es_row_no&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDMETHOD&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_hotspot_click<br />
<br />
   </div>
   <div class="codeComment">
*Handle&nbsp;Double&nbsp;Click<br />
*处理双击<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_DOUBLE_CLICK&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;HANDLE_DOUBLE_CLICK&nbsp;USING&nbsp;E_ROW&nbsp;E_COLUMN&nbsp;ES_ROW_NO&nbsp;.<br />
&nbsp;&nbsp;ENDMETHOD&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_double_click<br />
<br />
   </div>
   <div class="codeComment">
*Handle&nbsp;Before&nbsp;User&nbsp;Command<br />
*用户命令前处理<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_BEFORE_USER_COMMAND&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;handle_before_user_command&nbsp;USING&nbsp;e_ucomm&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDMETHOD&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_before_user_command<br />
<br />
   </div>
   <div class="codeComment">
*Handle&nbsp;Data&nbsp;Changed<br />
*处理数据更改<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_DATA_CHANGED&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;handle_data_changed&nbsp;USING&nbsp;er_data_changed&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDMETHOD.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_data_changed<br />
<br />
   </div>
   <div class="codeComment">
*Handle&nbsp;Data&nbsp;Changed&nbsp;Finished<br />
*处理数据更改完成<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_DATA_CHANGED_FINISHED&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;handle_data_changed_finished&nbsp;USING&nbsp;e_modified&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDMETHOD&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_data_changed_finished<br />
<br />
   </div>
   <div class="codeComment">
*Handle&nbsp;Menu&nbsp;Buttons<br />
*处理菜单按钮<br />
   </div>
   <div class="code">
&nbsp;&nbsp;METHOD&nbsp;HANDLE_MENU_BUTTON&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;handle_menu_button&nbsp;USING&nbsp;e_object&nbsp;e_ucomm&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDMETHOD&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"handle_menu_button<br />
ENDCLASS.               "lcl_event_receiver<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义类型<br />
*&---------------------------------------------------------------------*<br />
*定义工作区<br />
   </div>
   <div class="code">
TYPES: BEGIN OF ST_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCLUDE&nbsp;STRUCTURE&nbsp;SFLIGHT.<br />
TYPES: ZPDBH TYPE ZMMIF0150_PDITEM-ZPDBH.<br />
TYPES: ZITEM TYPE ZMMIF0150_PDITEM-ZITEM.<br />
TYPES: MATNR TYPE ZMMIF0150_PDITEM-MATNR.<br />
TYPES: CHARG TYPE ZMMIF0150_PDITEM-CHARG.<br />
TYPES: CLABS TYPE ZMMIF0150_PDITEM-CLABS.<br />
TYPES: ZBQMC TYPE ZMMIF0150_PDITEM-ZBQMC.<br />
TYPES: ZDPJS TYPE ZMMIF0150_PDITEM-ZDPJS.<br />
TYPES: TRAFFIC_LIGHT TYPE C.<br />
TYPES: LINE_COLOR(4) TYPE C.<br />
TYPES: PTYPE_DD_HNDL TYPE INT4 .<br />
TYPES: CELLSTYLES TYPE LVC_T_STYL.<br />
TYPES: END OF ST_SFLIGHT.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义全局数据<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
DATA:<br />
&nbsp;&nbsp;GI_INDEX_ROWS&nbsp;&nbsp;TYPE&nbsp;LVC_T_ROW,<br />
&nbsp;&nbsp;G_SELECTED_ROW&nbsp;LIKE&nbsp;LVC_S_ROW.<br />
DATA:<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV显示字段的内表<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GT_FIELDCAT&nbsp;TYPE&nbsp;LVC_T_FCAT,<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV显示字段的工作区<br />
   </div>
   <div class="code">
&nbsp;&nbsp;WA_FIELDCAT&nbsp;TYPE&nbsp;LVC_S_FCAT,<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV显示格式的工作区<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_LAYO.<br />
<br />
DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O_EVENT_RECEIVER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;LCL_EVENT_RECEIVER.<br />
DATA:ZCW   TYPE  LVC_T_CELL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_CW&nbsp;TYPE&nbsp;&nbsp;LVC_S_CELL.<br />
<br />
<br />
DATA:M1_FLAG TYPE I VALUE 1.           "手工输入的开关<br />
<br />
DATA:ZD TYPE SFLIGHT."内表<br />
<br />
DATA:ZKEY(1) TYPE C.<br />
DATA:ZC TYPE STRING.<br />
DATA:ZTEXT TYPE STRING.<br />
DATA:L_LINES TYPE I.<br />
DATA:ZROW_NO TYPE LVC_T_ROID.<br />
   </div>
   <div class="codeComment">
*DATA:ZNO1&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROID.<br />
<br />
   </div>
   <div class="code">
DATA: TAB_TOOLBAR TYPE  TTB_BUTTON,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_TOOLBAR&nbsp;&nbsp;TYPE&nbsp;&nbsp;STB_BUTTON.<br />
<br />
<br />
DATA: G_WA_SFLIGHT TYPE ST_SFLIGHT.<br />
DATA: IT_SFLIGHT LIKE TABLE OF SFLIGHT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_SFLIGHT&nbsp;LIKE&nbsp;SFLIGHT.<br />
DATA: GI_SFLIGHT TYPE STANDARD TABLE OF ST_SFLIGHT.<br />
DATA: OK_CODE LIKE SY-UCOMM.<br />
<br />
DATA:<br />
&nbsp;&nbsp;GO_GRID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID,"行项目ALV<br />
&nbsp;&nbsp;GO_CUSTOM_CONTAINER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_CUSTOM_CONTAINER."容器<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义选择屏幕<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT-OPTIONS:ZID&nbsp;FOR&nbsp;SFLIGHT-CARRID.<br />
&nbsp;&nbsp;SELECT-OPTIONS:ZCOID&nbsp;FOR&nbsp;SFLIGHT-CONNID.<br />
&nbsp;&nbsp;SELECT-OPTIONS:ZPDBH&nbsp;FOR&nbsp;ZMMIF0150_PDITEM-ZPDBH.<br />
&nbsp;&nbsp;PARAMETER:ZSXDW&nbsp;AS&nbsp;LISTBOX&nbsp;VISIBLE&nbsp;LENGTH&nbsp;10.<br />
<br />
   </div>
   <div class="codeComment">
*****************************"&nbsp;选择屏幕窗口对像表结构表<br />
   </div>
   <div class="code">
TABLES SSCRFIELDS.<br />
SELECTION-SCREEN:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;LINE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSHBUTTON&nbsp;2(10)&nbsp;S1&nbsp;USER-COMMAND&nbsp;C1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSHBUTTON&nbsp;12(10)&nbsp;S2&nbsp;USER-COMMAND&nbsp;C2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LINE.<br />
<br />
   </div>
   <div class="codeComment">
**************************为下拉列表的定义<br />
   </div>
   <div class="code">
TYPE-POOLS: VRM.<br />
DATA: IT_VAL TYPE VRM_VALUES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W_LINE&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;IT_VAL.<br />
   </div>
   <div class="codeComment">
*****************************<br />
<br />
   </div>
   <div class="code">
INITIALIZATION.<br />
   </div>
   <div class="codeComment">
**********************初始下拉列表<br />
   </div>
   <div class="code">
&nbsp;&nbsp;W_LINE-KEY&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;W_LINE-TEXT&nbsp;=&nbsp;'销售部'.<br />
&nbsp;&nbsp;APPEND&nbsp;W_LINE&nbsp;TO&nbsp;IT_VAL.<br />
&nbsp;&nbsp;CLEAR&nbsp;W_LINE.<br />
&nbsp;&nbsp;W_LINE-KEY&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;W_LINE-TEXT&nbsp;=&nbsp;'国贸部'.<br />
&nbsp;&nbsp;APPEND&nbsp;W_LINE&nbsp;TO&nbsp;IT_VAL.<br />
&nbsp;&nbsp;CLEAR&nbsp;W_LINE.<br />
&nbsp;&nbsp;W_LINE-KEY&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;W_LINE-TEXT&nbsp;=&nbsp;'洁具销售部'.<br />
&nbsp;&nbsp;APPEND&nbsp;W_LINE&nbsp;TO&nbsp;IT_VAL.<br />
&nbsp;&nbsp;CLEAR&nbsp;W_LINE.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'VRM_SET_VALUES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZSXDW'&nbsp;"'zsxdw'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;=&nbsp;IT_VAL.<br />
   </div>
   <div class="codeComment">
*************************按钮初始化<br />
   </div>
   <div class="code">
&nbsp;&nbsp;S1&nbsp;=&nbsp;'按钮1'.<br />
&nbsp;&nbsp;S2&nbsp;=&nbsp;'按钮2'.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***************************选择屏幕按钮的触发<br />
   </div>
   <div class="code">
AT SELECTION-SCREEN.<br />
&nbsp;&nbsp;CASE&nbsp;SSCRFIELDS-UCOMM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'C1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZID-LOW&nbsp;=&nbsp;'AC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZID-SIGN&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZID-OPTION&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ZID[].<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ZID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZSXDW&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'C2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZID-LOW&nbsp;=&nbsp;'AF'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZID-SIGN&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZID-OPTION&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ZID[].<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ZID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZSXDW&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&F8处理<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA.<br />
&nbsp;&nbsp;SET&nbsp;SCREEN&nbsp;200.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA:&nbsp;NUM1(4)&nbsp;TYPE&nbsp;N&nbsp;VALUE&nbsp;'800'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"初始化窗口800。<br />
   </div>
   <div class="codeComment">
*********************************************根据选择读下拉列表<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_VAL&nbsp;WITH&nbsp;KEY&nbsp;KEY&nbsp;=&nbsp;ZSXDW&nbsp;INTO&nbsp;W_LINE.<br />
&nbsp;&nbsp;ZKEY&nbsp;=&nbsp;W_LINE-KEY.<br />
&nbsp;&nbsp;ZTEXT&nbsp;=&nbsp;&nbsp;W_LINE-TEXT.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Module&nbsp;&nbsp;STATUS_8000&nbsp;&nbsp;OUTPUT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
**********************************************************屏幕的输出处理<br />
   </div>
   <div class="code">
MODULE STATUS_0200 OUTPUT.<br />
&nbsp;&nbsp;SET&nbsp;PF-STATUS&nbsp;'ZSTANDARD'.<br />
&nbsp;&nbsp;SET&nbsp;TITLEBAR&nbsp;&nbsp;'TITLE'.<br />
   </div>
   <div class="codeComment">
**********************************************初始客户在标准屏幕上的控件<br />
*&nbsp;如果容器为空，则实例化<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;GO_CUSTOM_CONTAINER&nbsp;IS&nbsp;INITIAL.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;初始化容器<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CUSTOM_CONTAINER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'BIG'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CUSTOM_CONTAINER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;LOAD_DATA_INTO_GRID.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;O_EVENT_RECEIVER."创造事件对象<br />
   </div>
   <div class="codeComment">
*************************************注册时间对象<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_USER_COMMAND&nbsp;FOR&nbsp;GO_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_TOOLBAR&nbsp;FOR&nbsp;GO_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_MENU_BUTTON&nbsp;FOR&nbsp;GO_GRID&nbsp;.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_DOUBLE_CLICK&nbsp;FOR&nbsp;GO_GRID&nbsp;.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_HOTSPOT_CLICK&nbsp;FOR&nbsp;GO_GRID&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;o_event_receiver-&gt;handle_button_click&nbsp;FOR&nbsp;go_grid&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_BEFORE_USER_COMMAND&nbsp;FOR&nbsp;GO_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_DATA_CHANGED&nbsp;FOR&nbsp;GO_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;O_EVENT_RECEIVER-&gt;HANDLE_DATA_CHANGED_FINISHED&nbsp;FOR&nbsp;GO_GRID.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;SET_TOOLBAR_INTERACTIVE.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CONTROL=&gt;SET_FOCUS<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTROL&nbsp;=&nbsp;GO_GRID.<br />
<br />
ENDMODULE.                 " STATUS_0100  OUTPUT<br />
<br />
   </div>
   <div class="codeComment">
**********************************************************屏幕的输入处理<br />
   </div>
   <div class="code">
MODULE USER_COMMAND_0200 INPUT.<br />
&nbsp;&nbsp;CASE&nbsp;OK_CODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'EXIT'&nbsp;OR&nbsp;'BACK'&nbsp;OR&nbsp;'UP'&nbsp;OR&nbsp;'CANCEL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;&nbsp;SCREEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZZSAVE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;:SHOW_NUM&nbsp;TYPE&nbsp;N.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOW_NUM&nbsp;=&nbsp;ZC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;SHOW_NUM&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_CHANGES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZF'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOW_NUM&nbsp;=&nbsp;ZC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;SHOW_NUM&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDMODULE.                 " USER_COMMAND_0100  INPUT<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;load_data_into_grid<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM LOAD_DATA_INTO_GRID .<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;L_LAYOUT&nbsp;TYPE&nbsp;DISVARIANT.<br />
&nbsp;&nbsp;L_LAYOUT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GI_SFLIGHT&nbsp;INTO&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;G_WA_SFLIGHT-PAYMENTSUM&nbsp;&lt;&nbsp;1000.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G_WA_SFLIGHT-TRAFFIC_LIGHT&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G_WA_SFLIGHT-LINE_COLOR&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C610'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;G_WA_SFLIGHT-PAYMENTSUM&nbsp;=&gt;&nbsp;1000&nbsp;AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G_WA_SFLIGHT-PAYMENTSUM&nbsp;&lt;&nbsp;2000.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G_WA_SFLIGHT-TRAFFIC_LIGHT&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G_WA_SFLIGHT-TRAFFIC_LIGHT&nbsp;=&nbsp;'3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GI_SFLIGHT&nbsp;FROM&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;PREPARE_FIELD_CATALOG&nbsp;CHANGING&nbsp;GT_FIELDCAT&nbsp;.<br />
&nbsp;&nbsp;PERFORM&nbsp;PREPARE_LAYOUT&nbsp;CHANGING&nbsp;GS_LAYOUT&nbsp;.<br />
&nbsp;&nbsp;PERFORM&nbsp;PREPARE_DRILLDOWN_VALUES.<br />
<br />
&nbsp;&nbsp;GO_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BUFFER_ACTIVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;I_BUFFER_ACTIVE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BYPASSING_BUFFER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;I_BYPASSING_BUFFER<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CONSISTENCY_CHECK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;I_CONSISTENCY_CHECK<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'SFLIGHT'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IS_VARIANT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_PRINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IS_PRINT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SPECIAL_GROUPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_SPECIAL_GROUPS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_TOOLBAR_EXCLUDING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_HYPERLINK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_HYPERLINK<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ALV_GRAPHICS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_ALV_GRAPHICS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_EXCEPT_QINFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_EXCEPT_QINFO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR_SALV_ADAPTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IR_SALV_ADAPTER<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GI_SFLIGHT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_SORT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FILTER<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
<br />
ENDFORM.                    " load_data_into_grid<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;save_changes<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_CHANGES .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;L_TRAFFIC_LIGHT&nbsp;TYPE&nbsp;C.<br />
&nbsp;&nbsp;IF&nbsp;ZD-CARRID&nbsp;&lt;&gt;&nbsp;''&nbsp;AND&nbsp;ZD-CONNID&nbsp;&lt;&gt;&nbsp;''&nbsp;AND&nbsp;ZD-FLDATE&nbsp;&lt;&gt;&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZD&nbsp;TO&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GI_SFLIGHT&nbsp;INDEX&nbsp;G_SELECTED_ROW-INDEX&nbsp;FROM&nbsp;G_WA_SFLIGHT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;REFRESH_TABLE_DISPLAY."&nbsp;数据刷新<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;FLUSH.&nbsp;"&nbsp;数据刷新<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ZD.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000(ZD003)&nbsp;WITH&nbsp;'请填写前三项！'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " save_changes<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;get_data<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM<br />
&nbsp;&nbsp;GET_DATA&nbsp;.<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMMIF0150_PDITEM<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GI_SFLIGHT<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ZPDBH&nbsp;IN&nbsp;ZPDBH.<br />
ENDFORM.                    " get_data<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;prepare_field_catalog<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_GT_FIELDCAT&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM PREPARE_FIELD_CATALOG  CHANGING PT_FIELDCAT TYPE LVC_T_FCAT .<br />
&nbsp;&nbsp;DATA&nbsp;LS_FCAT&nbsp;TYPE&nbsp;LVC_S_FCAT&nbsp;.<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_FCAT&nbsp;.<br />
&nbsp;&nbsp;LS_FCAT-FIELDNAME&nbsp;=&nbsp;'FLDATE'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'SFLIGHT'&nbsp;.<br />
*&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'CONNID'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_FCAT-OUTPUTLEN&nbsp;=&nbsp;'10'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-emphasize&nbsp;=&nbsp;'C410'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_FCAT-DRDN_HNDL&nbsp;=&nbsp;'1'&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"设置为下拉表形式<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-drdn_field&nbsp;=&nbsp;'FLDATE'.<br />
<br />
*ls_fcat-EDIT&nbsp;=&nbsp;'X'.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;LS_FCAT&nbsp;TO&nbsp;PT_FIELDCAT&nbsp;.<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_FCAT&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;ls_fcat-drdn_field&nbsp;=&nbsp;'PLANETYPE'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_FCAT-FIELDNAME&nbsp;=&nbsp;'PLANETYPE'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'SFLIGHT'&nbsp;.<br />
*&nbsp;&nbsp;ls_fcat-ref_table&nbsp;=&nbsp;'CONNID'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_FCAT-OUTPUTLEN&nbsp;=&nbsp;'10'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-emphasize&nbsp;=&nbsp;'C410'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_FCAT-DRDN_HNDL&nbsp;=&nbsp;'2'&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"设置为下拉表形式<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ls_fcat-drdn_field&nbsp;=&nbsp;'PLANETYPE'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;LS_FCAT&nbsp;TO&nbsp;PT_FIELDCAT&nbsp;.<br />
<br />
ENDFORM.                    " prepare_field_catalog<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;prepare_layout<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--P_GS_LAYOUT&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM  PREPARE_LAYOUT  CHANGING PS_LAYOUT TYPE LVC_S_LAYO.<br />
   </div>
   <div class="codeComment">
*************************************************布局设置<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;'Flights'."ALV的标题<br />
&nbsp;&nbsp;PS_LAYOUT-EXCP_FNAME&nbsp;=&nbsp;'TRAFFIC_LIGHT'.<br />
&nbsp;&nbsp;PS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'LINE_COLOR'.<br />
&nbsp;&nbsp;PS_LAYOUT-ZEBRA&nbsp;=&nbsp;'X'&nbsp;.<br />
&nbsp;&nbsp;PS_LAYOUT-SEL_MODE&nbsp;=&nbsp;'D'.<br />
&nbsp;&nbsp;PS_LAYOUT-STYLEFNAME&nbsp;=&nbsp;'CELLSTYLES'&nbsp;.<br />
<br />
ENDFORM.                    " prepare_layout<br />
<br />
   </div>
   <div class="codeComment">
*---&nbsp;Drilldown&nbsp;values<br />
   </div>
   <div class="code">
FORM  PREPARE_DRILLDOWN_VALUES.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LT_DDVAL&nbsp;TYPE&nbsp;LVC_T_DROP&nbsp;.<br />
&nbsp;&nbsp;DATA&nbsp;LS_DDVAL&nbsp;TYPE&nbsp;LVC_S_DROP&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'20080502'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_DDVAL&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'JSF-44'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_DDVAL&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'KMDA-53'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_DDVAL&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'SS3O/N'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_DDVAL&nbsp;.<br />
<br />
&nbsp;&nbsp;GO_GRID-&gt;SET_DROP_DOWN_TABLE(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_DROP_DOWN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_DDVAL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LT_VAL&nbsp;TYPE&nbsp;LVC_T_DROP&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;ls_ddval&nbsp;TYPE&nbsp;lvc_s_drop&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'2'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'aaa'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_VAL&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'2'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'bbb'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_VAL&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'2'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'ccc'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_VAL&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-HANDLE&nbsp;=&nbsp;'2'&nbsp;.<br />
&nbsp;&nbsp;LS_DDVAL-VALUE&nbsp;=&nbsp;'ddd'&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DDVAL&nbsp;TO&nbsp;LT_VAL&nbsp;.<br />
<br />
&nbsp;&nbsp;GO_GRID-&gt;SET_DROP_DOWN_TABLE(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_DROP_DOWN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_VAL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
ENDFORM. " prepare_drilldown_values<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;handle_double_click<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;I_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;I_COLUMN&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;I_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;I_COLUMN&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;IS_ROW_NO&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_DOUBLE_CLICK USING I_ROW TYPE LVC_S_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_COLUMN&nbsp;TYPE&nbsp;LVC_S_COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_ROW_NO&nbsp;TYPE&nbsp;LVC_S_ROID.<br />
&nbsp;&nbsp;DATA:&nbsp;ZVALUE&nbsp;TYPE&nbsp;STRING.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GI_SFLIGHT&nbsp;INTO&nbsp;G_WA_SFLIGHT&nbsp;INDEX&nbsp;IS_ROW_NO-ROW_ID&nbsp;.<br />
&nbsp;&nbsp;CONCATENATE&nbsp;'G_WA_SFLIGHT-'&nbsp;I_COLUMN&nbsp;INTO&nbsp;ZVALUE.<br />
&nbsp;&nbsp;MESSAGE&nbsp;S000(ZD003)&nbsp;WITH&nbsp;'你双击的单元格值为：'&nbsp;&nbsp;(ZVALUE).<br />
ENDFORM. .                    "handle_double_click<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;adjust_editables<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_GI_SFLIGHT&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ADJUST_EDITABLES  USING   PT_LIST LIKE GI_SFLIGHT .<br />
&nbsp;&nbsp;IF&nbsp;M1_FLAG&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LS_LISTROW&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;PT_LIST&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LS_STYLEROW&nbsp;TYPE&nbsp;LVC_S_STYL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LT_STYLETAB&nbsp;TYPE&nbsp;LVC_T_STYL&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;PT_LIST&nbsp;INTO&nbsp;LS_LISTROW&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_LISTROW-CARRID&nbsp;=&nbsp;'AC'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STYLEROW-FIELDNAME&nbsp;=&nbsp;'FLDATE'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STYLEROW-STYLE&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_STYLEROW&nbsp;TO&nbsp;LT_STYLETAB&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_LISTROW-CONNID&nbsp;=&nbsp;'0455'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STYLEROW-FIELDNAME&nbsp;=&nbsp;'PAYMENTSUM'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STYLEROW-STYLE&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_ENABLED&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_STYLEROW&nbsp;TO&nbsp;LT_STYLETAB&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_STYLEROW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_STYLETAB&nbsp;&nbsp;INTO&nbsp;LS_STYLEROW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_STYLEROW&nbsp;TO&nbsp;LS_LISTROW-CELLSTYLES.<br />
   </div>
   <div class="codeComment">
*INSERT&nbsp;LINES&nbsp;OF&nbsp;lt_styletab&nbsp;INTO&nbsp;ls_listrow-cellstyles&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;PT_LIST&nbsp;FROM&nbsp;LS_LISTROW&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LT_STYLETAB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;REFRESH_TABLE_DISPLAY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;FLUSH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;M1_FLAG&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.                    " adjust_editable<br />
<br />
<br />
FORM FM_SET_TOOLBAR  CHANGING E_OBJECT TYPE REF TO CL_ALV_EVENT_TOOLBAR_SET..<br />
&nbsp;&nbsp;CONSTANTS:<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_BUTTON_NORMAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_MENU_AND_DEFAULT_BUTTON&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_MENU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_SEPARATOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;3,<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_RADIO_BUTTON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;4,<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_CHECKBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;5,<br />
&nbsp;&nbsp;&nbsp;&nbsp;C_MENU_ENTRY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;6.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR&nbsp;TYPE&nbsp;STB_BUTTON,<br />
&nbsp;&nbsp;&nbsp;&nbsp;NO_TOOLBAR&nbsp;TYPE&nbsp;STB_BUTTON.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;MOVE&nbsp;C_SEPARATOR&nbsp;TO&nbsp;LS_TOOLBAR-BUTN_TYPE.<br />
&nbsp;&nbsp;TAB_TOOLBAR&nbsp;=&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
   </div>
   <div class="codeComment">
**************************屏幕更新的时候&nbsp;&nbsp;按钮&nbsp;只添加一次。<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;TAB_TOOLBAR&nbsp;WITH&nbsp;KEY&nbsp;FUNCTION&nbsp;=&nbsp;'ZCHANGE'&nbsp;INTO&nbsp;NO_TOOLBAR.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
   </div>
   <div class="codeComment">
****************************添加按钮&nbsp;函数<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'ZCHANGE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-FUNCTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;&nbsp;ICON_CHANGE&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'Change&nbsp;flight'&nbsp;TO&nbsp;LS_TOOLBAR-QUICKINFO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'修改'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-TEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-DISABLED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;CLEAR&nbsp;NO_TOOLBAR.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;TAB_TOOLBAR&nbsp;WITH&nbsp;KEY&nbsp;FUNCTION&nbsp;=&nbsp;'ZSAVE'&nbsp;INTO&nbsp;NO_TOOLBAR.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'ZSAVE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-FUNCTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;&nbsp;ICON_SYSTEM_SAVE&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'保存表里的数据到系统数据库'&nbsp;TO&nbsp;LS_TOOLBAR-QUICKINFO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'保存到数据库'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-TEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-DISABLED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;TAB_TOOLBAR&nbsp;WITH&nbsp;KEY&nbsp;FUNCTION&nbsp;=&nbsp;'ZSELECTION'&nbsp;INTO&nbsp;NO_TOOLBAR.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'ZSELECTION'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-FUNCTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'编辑列'&nbsp;TO&nbsp;LS_TOOLBAR-QUICKINFO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'编辑列'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-TEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-DISABLED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;TAB_TOOLBAR&nbsp;WITH&nbsp;KEY&nbsp;FUNCTION&nbsp;=&nbsp;'ZINPUT'&nbsp;INTO&nbsp;NO_TOOLBAR.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'ZINPUT'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-FUNCTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'手工输入'&nbsp;TO&nbsp;LS_TOOLBAR-QUICKINFO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'手工输入'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-TEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-DISABLED.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;TAB_TOOLBAR&nbsp;WITH&nbsp;KEY&nbsp;FUNCTION&nbsp;=&nbsp;'ZREF'&nbsp;INTO&nbsp;NO_TOOLBAR.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'ZREF'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-FUNCTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'刷新'&nbsp;TO&nbsp;LS_TOOLBAR-QUICKINFO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;'刷新'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-TEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;LS_TOOLBAR-DISABLED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
<br />
FORM FM_USER_COMMAND CHANGING E_UCOMM.<br />
&nbsp;&nbsp;CASE&nbsp;E_UCOMM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZCHANGE'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ZCHANGE'.<br />
*****************8判断是否选择行,&nbsp;没有则提示<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;GET_SELECTED_ROWS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_INDEX_ROWS&nbsp;=&nbsp;GI_INDEX_ROWS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZROW_NO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GI_INDEX_ROWS&nbsp;LINES&nbsp;L_LINES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;L_LINES&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_DISPLAY_TEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITEL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'操作提示！&nbsp;'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXTLINE1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'请选择你要修改的行记录之后，'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXTLINE2&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;&nbsp;&nbsp;再点“修改”按钮。'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_COLUMN&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_ROW&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GI_INDEX_ROWS&nbsp;INTO&nbsp;G_SELECTED_ROW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GI_SFLIGHT&nbsp;INDEX&nbsp;G_SELECTED_ROW-INDEX&nbsp;INTO&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;G_WA_SFLIGHT&nbsp;TO&nbsp;ZD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;'200'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZSAVE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GI_INDEX_ROWS&nbsp;LINES&nbsp;L_LINES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;IT_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GI_SFLIGHT&nbsp;INTO&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;G_WA_SFLIGHT&nbsp;TO&nbsp;WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_SFLIGHT&nbsp;TO&nbsp;IT_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SFLIGHT&nbsp;FROM&nbsp;TABLE&nbsp;IT_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZD003)&nbsp;WITH&nbsp;'保存成功！'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E000(ZD003)&nbsp;WITH&nbsp;'保存不成功！'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZSELECTION'.<br />
   </div>
   <div class="codeComment">
************************888框架操作<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_GRID-&gt;GET_FRONTEND_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_FIELDCATALOG&nbsp;=&nbsp;GT_FIELDCAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;WA_FIELDCAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'PRICE'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;=&nbsp;'X'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;WA_FIELDCAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;SET_FRONTEND_FIELDCATALOG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;=&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;REFRESH_TABLE_DISPLAY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;FLUSH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;ZVALUE&nbsp;TYPE&nbsp;STRING.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO_GRID-&gt;GET_SELECTED_CELLS(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_CELL&nbsp;=&nbsp;ZCW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;ZCW&nbsp;INTO&nbsp;WA_CW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GI_SFLIGHT&nbsp;INTO&nbsp;G_WA_SFLIGHT&nbsp;INDEX&nbsp;WA_CW-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'g_wa_sflight-'&nbsp;WA_CW-COL_ID&nbsp;INTO&nbsp;ZVALUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZD003)&nbsp;WITH&nbsp;'你选择的值为：'&nbsp;&nbsp;(ZVALUE).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZINPUT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ADJUST_EDITABLES&nbsp;USING&nbsp;GI_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZREF'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GI_SFLIGHT&nbsp;INTO&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;G_WA_SFLIGHT-CELLSTYLES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GI_SFLIGHT&nbsp;FROM&nbsp;G_WA_SFLIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M1_FLAG&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;REFRESH_TABLE_DISPLAY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;FLUSH.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDFORM.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*REPORT&nbsp;Z.<br />
*TYPE-POOLS:&nbsp;VRM.<br />
*DATA:&nbsp;IT_VAL&nbsp;TYPE&nbsp;VRM_VALUES,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W_LINE&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;IT_VAL.<br />
*PARAMETERS&nbsp;P_BUKRS&nbsp;LIKE&nbsp;T001-BUKRS&nbsp;AS&nbsp;LISTBOX<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VISIBLE&nbsp;LENGTH&nbsp;25&nbsp;OBLIGATORY.<br />
*<br />
*INITIALIZATION.<br />
*&nbsp;&nbsp;SELECT&nbsp;BUKRS&nbsp;BUTXT&nbsp;FROM&nbsp;T001&nbsp;INTO&nbsp;(W_LINE-KEY,&nbsp;W_LINE-TEXT).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;W_LINE&nbsp;TO&nbsp;IT_VAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;P_BUKRS&nbsp;IS&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;P_BUKRS&nbsp;=&nbsp;W_LINE-KEY.<br />
*&nbsp;&nbsp;ENDSELECT.<br />
*<br />
*AT&nbsp;SELECTION-SCREEN&nbsp;OUTPUT.<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'VRM_SET_VALUES'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'P_BUKRS'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;=&nbsp;IT_VAL.<br />
*<br />
*END-OF-SELECTION.<br />
*&nbsp;&nbsp;WRITE:&nbsp;/&nbsp;'Company&nbsp;Code:',&nbsp;P_BUKRS.<br />
<br />
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;001&nbsp;测试001<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;ZCOID&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;ZID&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;ZPDBH&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
