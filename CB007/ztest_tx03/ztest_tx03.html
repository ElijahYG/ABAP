<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZTEST_TX03</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZTEST_TX03</h2>
<h3> Description: 测试</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
REPORT ZTEST_TX03.<br />
<br />
   </div>
   <div class="codeComment">
***********************************************************************<br />
*&nbsp;Report&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;ZTEST_TX02<br />
*&nbsp;Application&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;HR<br />
*&nbsp;Subject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;人力资源预览表测试<br />
*&nbsp;Author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;tangxu<br />
<br />
<br />
<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;引用表<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TABLES:<br />
&nbsp;&nbsp;ZMMRP0520SBGLB.<br />
<br />
DATA: IT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV.<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV显示字段的工作区<br />
   </div>
   <div class="code">
DATA: WA_FIELDCAT TYPE SLIS_FIELDCAT_ALV.<br />
   </div>
   <div class="codeComment">
*&nbsp;定义ALV显示格式的工作区<br />
   </div>
   <div class="code">
DATA: WA_LAYOUT     TYPE SLIS_LAYOUT_ALV.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义结构体<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
TYPES:BEGIN OF STRU_0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SJBH&nbsp;TYPE&nbsp;&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SJBH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SNH&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SNH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GSBH&nbsp;TYPE&nbsp;&nbsp;&nbsp;ZMMRP0520SBGLB-EX_GSBH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SBLX&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SBLX,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SBXH&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SBXH,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GMJE&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_GMJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SBMC&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SBMC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SBSL&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SBSL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GMRQ&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_GMRQ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CJMC&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_CJMC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_DJRQ&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_DJRQ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_DJSJ&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_DJSJ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_DJRY&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_DJRY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXRQ&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_GXRQ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXSJ&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_GXSJ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXRY&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_GXRY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BMDM&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_BMDM,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BMMC&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_BMMC,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SZWZ&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_SZWZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BZ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZMMRP0520SBGLB-EX_BZ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010.<br />
<br />
DATA: IT_TABLE  TYPE  STANDARD TABLE OF STRU_0010.<br />
DATA: WA_TABLE  TYPE                    STRU_0010.<br />
DATA: WA_TABLE1  TYPE                    STRU_0010.<br />
DATA: IT_TABLE1  TYPE  STANDARD TABLE OF STRU_0010.<br />
<br />
<br />
<br />
SELECT-OPTIONS:<br />
S_SJBH FOR ZMMRP0520SBGLB-EX_SJBH,<br />
S_SNH  FOR ZMMRP0520SBGLB-EX_SNH,<br />
S_GSBH FOR ZMMRP0520SBGLB-EX_GSBH,<br />
S_SBLX FOR ZMMRP0520SBGLB-EX_SBLX.<br />
<br />
START-OF-SELECTION.<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA.<br />
   </div>
   <div class="codeComment">
*PERFORM&nbsp;GET_QXJC.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_SHOW.<br />
<br />
<br />
FORM GET_DATA.<br />
<br />
&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SJBH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SNH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GSBH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SBLX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SBXH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GMJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SBMC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SBSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GMRQ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_CJMC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_DJRQ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_DJSJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_DJRY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GXRQ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GXSJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GXRY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_BMDM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_BMMC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SZWZ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_BZ<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;IT_TABLE<br />
&nbsp;&nbsp;FROM&nbsp;ZMMRP0520SBGLB&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;A~EX_SJBH&nbsp;IN&nbsp;S_SJBH<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SNH&nbsp;&nbsp;IN&nbsp;S_SNH<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GSBH&nbsp;IN&nbsp;S_GSBH<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;&nbsp;A~EX_SBLX&nbsp;IN&nbsp;S_SBLX<br />
&nbsp;&nbsp;&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;&nbsp;A~EX_SJBH.<br />
ENDFORM.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*FORM&nbsp;GET_QXJC.<br />
*&nbsp;&nbsp;DATA:&nbsp;IT_TABLE2&nbsp;&nbsp;TYPE&nbsp;&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ZHRRP0160QXJB.<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;IT_TABLE2<br />
*&nbsp;&nbsp;FROM&nbsp;ZHRRP0160QXJB.<br />
*<br />
*ENDFORM.<br />
<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;定义常量,定义宏<br />
*&---------------------------------------------------------------------*<br />
*定义ALV显示宏<br />
   </div>
   <div class="code">
FORM GET_SHOW.<br />
   </div>
   <div class="codeComment">
*&nbsp;宏<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DEFINE&nbsp;DF_ADD_FIELDCAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_FIELDCAT.<br />
<br />
&nbsp;&nbsp;WA_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"列位置<br />
&nbsp;&nbsp;WA_FIELDCAT-TABNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"内表名称<br />
&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"字段名称<br />
&nbsp;&nbsp;IF&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'SEL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-CHECKBOX&nbsp;=&nbsp;ABAP_TRUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_TRUE.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;WA_FIELDCAT-COL_POS&nbsp;&lt;&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-KEY&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"字段描述<br />
&nbsp;&nbsp;WA_FIELDCAT-REF_TABNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"引用表<br />
&nbsp;&nbsp;WA_FIELDCAT-REF_FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&6.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"引用字段<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
&nbsp;&nbsp;END-OF-DEFINITION.<br />
<br />
&nbsp;&nbsp;DF_ADD_FIELDCAT:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SJBH'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'数据编号'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SNH'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SN号/服务号'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_GSBH'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'公司编号'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SBLX'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'设备类型'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SBXH'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'设备型号'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_GMJE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'购买金额'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SBMC'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'设备名称'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SBSL'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'设备数量'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_GMRQ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'购买日期'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_CJMC'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'厂家名称'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_DJRQ'&nbsp;&nbsp;&nbsp;&nbsp;'登记日期'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_DJSJ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'登记时间'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_DJRY'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'登记人员'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_GXRQ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'更新日期'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_GXSJ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'更新时间'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_GXRY'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'更新人员'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;17&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_BMDM'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'部门代码（设备地点）'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_BMMC'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'部门名称（设备地点）'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_SZWZ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'所在位置（设备地点）'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,<br />
&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;'gt_e_data'&nbsp;&nbsp;&nbsp;'EX_BZ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'备注'&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;ABAP_TRUE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"优化列宽设置<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;调用ALV<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'FM_GUI_STATUS'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'FM_USER_COMMAND'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E001(00)&nbsp;WITH&nbsp;'系统错误'&nbsp;SPACE&nbsp;SPACE&nbsp;SPACE.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;S_GZYF&nbsp;D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;S_PERNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;人员代码<br />
*&nbsp;S_SHORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;部门代码<br />
*&nbsp;S_VORNA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;人员姓名<br />
*&nbsp;S_ZCJDM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;厂家代码<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;00<br />
*001&nbsp;&nbsp;&nbsp;&1&2&3&4&5&6&7&8<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
