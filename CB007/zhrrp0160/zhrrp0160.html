<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZHRRP0160</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZHRRP0160</h2>
<h3> Description: 工资模板上传下载</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
***********************************************************************<br />
*&nbsp;Report&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;ZHRRP0010<br />
*&nbsp;Application&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;HR<br />
*&nbsp;Subject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;员工工资模板上传下载<br />
*&nbsp;Author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;LIUWEI<br />
<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUTHOR<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------<br />
*&&nbsp;2015/06/26&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIUWEI<br />
***********************************************************************<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
REPORT ZHRRP0160 USING DATABASE PNPCE MESSAGE-ID PN.<br />
<br />
TABLES: PERNR,HRP9101,T527X,ZHRRP0160DKZT,ZHRRP0160QXJB.<br />
<br />
INFOTYPES: 0000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0006,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0009,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0016,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0021,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0022,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0041,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0105,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0185,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0529,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0533,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0534,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0536,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3211,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3527,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3529,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9003,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9004.<br />
<br />
include <a href ="zfi_common_form.html">ZFI_COMMON_FORM</a>.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义常量<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CONSTANTS:<br />
&nbsp;&nbsp;CNS_OBJID&nbsp;TYPE&nbsp;W3OBJID&nbsp;VALUE&nbsp;'ZHRRP0010'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"模板名称<br />
<br />
DATA: IT_T517T   TYPE  T517T   OCCURS 0 WITH HEADER LINE.                                                   "文化程度<br />
DATA: IT_T005U   TYPE  T005U   OCCURS 0 WITH HEADER LINE.                                                   "地址<br />
DATA: IT_HRP1000 TYPE  HRP1000 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP9101 TYPE  HRP9101 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP1001 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100101 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100102 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100103 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100104 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
<br />
DATA: IT_DD07T   TYPE  DD07T   OCCURS 0 WITH HEADER LINE.                                                   "域内信息<br />
DATA: IT_T7CN6U  TYPE  T7CN6U  OCCURS 0 WITH HEADER LINE.                                                    "职位<br />
DATA: IT_T005T   TYPE  T005T   OCCURS 0 WITH HEADER LINE.                                                    "国籍<br />
DATA: IT_T502T   TYPE  T502T   OCCURS 0 WITH HEADER LINE.                                                    "婚姻状况<br />
DATA: IT_T505S   TYPE  T505S   OCCURS 0 WITH HEADER LINE.                                                    "名族<br />
DATA: IT_T7CN5R  TYPE  T7CN5R  OCCURS 0 WITH HEADER LINE.                                                    "政治面貌<br />
DATA: WA_T7CN5R  TYPE                    T7CN5R.                                                            "政治面貌<br />
DATA: IT_ZHRT_FWXZ TYPE ZHRT_FWXZ OCCURS 0 WITH HEADER LINE.                                                 "房屋性质<br />
DATA: IT_PA3529  TYPE STANDARD TABLE OF  PA3529.                                                            "教育经历<br />
DATA: WA_PA3529  TYPE                    PA3529.                                                            "教育经历<br />
DATA: IT_PA0022 TYPE STANDARD TABLE OF   PA0022.                                                            "HR主记录:信息类型0022 (教育)<br />
DATA: WA_PA0022 TYPE                     PA0022.                                                            "HR主记录:信息类型0022 (教育)<br />
DATA: IT_PA0001  TYPE STANDARD TABLE OF  PA0001.                                                            "人力资源主记录:<br />
DATA: WA_PA0001  TYPE                    PA0001.                                                            "人力资源主记录:<br />
DATA: IT_T528T  TYPE STANDARD TABLE OF   T528T.                                                            "职位文本<br />
DATA: WA_T528T  TYPE                     T528T.                                                            "职位文本<br />
DATA: IT_PA0006  TYPE STANDARD TABLE OF  PA0006.                                                            "户籍地址<br />
DATA: WA_PA0006  TYPE                    PA0006.                                                            "户籍地址<br />
DATA: IT_PA0105  TYPE STANDARD TABLE OF  PA0105.                                                            "人力资源主记录：信息类型0105（通信）<br />
DATA: WA_PA0105  TYPE                    PA0105.                                                            "人力资源主记录：信息类型0105（通信）<br />
DATA: IT_PA9005  TYPE STANDARD TABLE OF  PA9005.                                                            "信息类别 9005 培训<br />
DATA: WA_PA9005  TYPE                    PA9005.                                                            "信息类别 9005 培训<br />
DATA: IT_ZHRT_ZSMC  TYPE STANDARD TABLE OF  ZHRT_ZSMC.                                                      "信息类别  培训证书名称<br />
DATA: WA_ZHRT_ZSMC  TYPE                    ZHRT_ZSMC.                                                      "信息类别  培训证书名称<br />
DATA: IT_PA0023  TYPE STANDARD TABLE OF  PA0023.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)<br />
DATA: WA_PA0023  TYPE                    PA0023.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)<br />
DATA: IT_PA3528  TYPE STANDARD TABLE OF  PA3528.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)取部门和职务<br />
DATA: WA_PA3528  TYPE                    PA3528.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)取部门和职务<br />
DATA: IT_PA0021  TYPE STANDARD TABLE OF  PA0021.                                                            "HR 主记录: 信息类别 0021 (家庭)<br />
DATA: WA_PA0021  TYPE                    PA0021.                                                            "HR 主记录: 信息类别 0021 (家庭)<br />
DATA: IT_PA0528  TYPE STANDARD TABLE OF  PA0528.                                                            "人力资源主记录: 信息类型 0528 (家庭信息)<br />
DATA: WA_PA0528  TYPE                    PA0528.                                                            "人力资源主记录: 信息类型 0528 (家庭信息)<br />
DATA: IT_T591S   TYPE STANDARD TABLE OF   T591S.                                                            "家庭成员类型<br />
DATA: WA_T591S   TYPE                     T591S.                                                            "<br />
DATA: IT_PA9004   TYPE STANDARD TABLE OF  PA9004.                                                            "奖励惩罚<br />
DATA: WA_PA9004   TYPE                    PA9004.                                                            "<br />
DATA: WA1_PA9004   TYPE                   PA9004.                                                            "<br />
DATA: IT_PA0529   TYPE STANDARD TABLE OF  PA0529.                                                            "籍贯和个人特长<br />
DATA: WA_PA0529   TYPE                    PA0529.                                                            "籍贯和个人特长<br />
<br />
<br />
DATA: IT_T501T   TYPE STANDARD TABLE OF  T501T .                                                            "员工组描述<br />
DATA: WA_T501T   TYPE                    T501T .                                                            "<br />
DATA: IT_T503T   TYPE STANDARD TABLE OF  T503T.                                                            "员工子组描述<br />
DATA: WA_T503T   TYPE                    T503T.                                                            "<br />
<br />
<br />
DATA: IT_QXJB   TYPE STANDARD TABLE OF   ZHRRP0160QXJB .<br />
DATA: WA_QXJB   TYPE   ZHRRP0160QXJB .<br />
<br />
DATA: IT_QXJB1   TYPE STANDARD TABLE OF   ZHRRP0160QXJB .<br />
DATA: WA_QXJB1   TYPE   ZHRRP0160QXJB .<br />
<br />
<br />
<br />
DATA: IT_DKZT   TYPE STANDARD TABLE OF   ZHRRP0160DKZT .<br />
DATA: WA_DKZT   TYPE   ZHRRP0160DKZT .<br />
<br />
<br />
DATA: WA_HRP9101 TYPE HRP9101.<br />
DATA: WA_HRP1001 TYPE  HRP1001 .                                                   "部门<br />
DATA: WA_HRP100102 TYPE  HRP1001.                                                   "部门<br />
DATA: WA_HRP100103 TYPE  HRP1001.                                                   "部门<br />
DATA: WA_HRP100104 TYPE  HRP1001.                                                   "部门<br />
<br />
<br />
DATA: WA_DD07T TYPE DD07T.<br />
DATA: WA_DD07T_MD TYPE DD07T.<br />
DATA: WA_DD07T_ZD TYPE DD07T.<br />
DATA: WA_DD07T_FD TYPE DD07T.<br />
<br />
<br />
<br />
<br />
<br />
<br />
DATA: V_DARXX TYPE DATAR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V_DATXX&nbsp;TYPE&nbsp;DARDT.<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*ALV显示使用到的共享池<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
TYPE-POOLS: SLIS.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*&nbsp;定义ALV显示字段的内表及工作区<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
DATA: IT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV.<br />
DATA: WA_FIELDCAT TYPE SLIS_FIELDCAT_ALV.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*&nbsp;定义ALV显示格式的工作区<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
DATA: WA_LAYOUT     TYPE SLIS_LAYOUT_ALV.<br />
<br />
DATA: GD_REPID LIKE SY-REPID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REF_GRID&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
   </div>
   <div class="codeComment">
*-----------------------------------------------*<br />
*定义数据结构<br />
*-----------------------------------------------*<br />
   </div>
   <div class="code">
TYPES: BEGIN OF STRUCT ,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"序号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERNR&nbsp;&nbsp;LIKE&nbsp;P0001-PERNR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NACHN&nbsp;&nbsp;LIKE&nbsp;P0002-NACHN,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员姓<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VORNA&nbsp;&nbsp;LIKE&nbsp;P0002-VORNA,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员名<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHORT&nbsp;&nbsp;LIKE&nbsp;HRP1000-STEXT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZORG1&nbsp;&nbsp;LIKE&nbsp;P0001-ORGEH,&nbsp;"部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT1&nbsp;&nbsp;LIKE&nbsp;HRP1000-SHORT,&nbsp;"一级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT2&nbsp;&nbsp;LIKE&nbsp;HRP1000-SHORT,&nbsp;"二级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT3&nbsp;&nbsp;LIKE&nbsp;HRP1000-SHORT,&nbsp;"三级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T527X&nbsp;&nbsp;LIKE&nbsp;T527X-ORGTX,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员部门文本<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERSG&nbsp;&nbsp;LIKE&nbsp;P0001-PERSG,&nbsp;&nbsp;"员工组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YGZMS&nbsp;&nbsp;LIKE&nbsp;T501T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERSK&nbsp;&nbsp;LIKE&nbsp;P0001-PERSK,&nbsp;&nbsp;"员工子组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YGZZMS&nbsp;LIKE&nbsp;T503T-PTEXT,&nbsp;&nbsp;&nbsp;&nbsp;"员工子组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZCJDM&nbsp;&nbsp;LIKE&nbsp;P0001-ZCJDM,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR&nbsp;&nbsp;&nbsp;&nbsp;like&nbsp;ZHRIF0010_SGM_INFO-LIFNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR_NAME&nbsp;LIKE&nbsp;&nbsp;ZHRIF0010_SGM_INFO-LIFNR_NAME,<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GZYF&nbsp;&nbsp;&nbsp;LIKE&nbsp;ZHRRP0160DKZT-EX_GZYF,&nbsp;&nbsp;"工资月份<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT4&nbsp;&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT5&nbsp;&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT6&nbsp;&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT7&nbsp;&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT8&nbsp;&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT9&nbsp;&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT10&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT11&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT12&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT13&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT14&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT15&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT16&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT17&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT18&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT19&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT20&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT21&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT22&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT23&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT24&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT25&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT26&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT27&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT28&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT29&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT30&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT31&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT32&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT33&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT34&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT35&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT36&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT37&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT38&nbsp;LIKE&nbsp;P0001-ENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT39&nbsp;LIKE&nbsp;P0001-ENAME,<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRUCT.<br />
<br />
DATA: IT_STRUCT TYPE STANDARD TABLE OF  STRUCT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRUCT.<br />
DATA: IT_TABLE1  TYPE  STANDARD TABLE OF ZHRRP0160QXJB.<br />
DATA: IT_TABLE2  TYPE  STANDARD TABLE OF ZHRRP0160QXJB.<br />
DATA: WA_TABLE1  TYPE                    ZHRRP0160QXJB.<br />
<br />
DATA: IT_STR TYPE STANDARD TABLE OF  STRUCT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STR&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRUCT.<br />
<br />
<br />
<br />
DATA: IT_STRUCT1 TYPE STANDARD TABLE OF  STRUCT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRUCT.<br />
<br />
DATA: ZRYDM       TYPE CHAR8 .<br />
<br />
DATA: INTI  TYPE I VALUE 0.<br />
<br />
DATA: BEGIN TYPE P0001-ENDDA.<br />
DATA: END   TYPE P0001-ENDDA.<br />
DATA: BEG TYPE P0001-ENDDA.<br />
<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&初始化<br />
*&---------------------------------------------------------------------*<br />
<br />
<br />
<br />
   </div>
   <div class="code">
SELECTION-SCREEN BEGIN OF BLOCK TIME1 WITH FRAME TITLE TEXT-S01.<br />
<br />
PARAMETERS: ZRCKHTJB AS CHECKBOX .<br />
PARAMETERS: ZJJFPB AS CHECKBOX .<br />
PARAMETERS: ZXSTJB AS CHECKBOX .<br />
PARAMETERS: ZKQTJB AS CHECKBOX .<br />
PARAMETERS: ZXXYGZ AS CHECKBOX .<br />
SELECTION-SCREEN COMMENT /1(50) TEXT-T02 .<br />
SELECTION-SCREEN COMMENT /2(50) TEXT-T03 .<br />
<br />
SELECTION-SCREEN END OF BLOCK TIME1.<br />
<br />
INITIALIZATION.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&初始化<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
INITIALIZATION.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*程序开始<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;SY-UNAME&nbsp;&lt;&gt;&nbsp;'10734'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_BF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_10734.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_BM.<br />
<br />
&nbsp;&nbsp;GET&nbsp;PERNR.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;INTI&nbsp;=&nbsp;INTI&nbsp;+&nbsp;1.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA.<br />
<br />
END-OF-SELECTION.<br />
&nbsp;&nbsp;PERFORM&nbsp;POST_DATA.<br />
<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZRCKHTJB&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZRCKHTJB.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZJJFPB&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZJJFPB.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZXSTJB&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZXSTJB.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZKQTJB&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZKQTJB.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZXXYGZ.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZRCKHTJB&nbsp;&lt;&gt;&nbsp;'X'&nbsp;AND&nbsp;ZJJFPB&nbsp;&lt;&gt;&nbsp;'X'AND&nbsp;ZXSTJB&nbsp;&lt;&gt;&nbsp;'X'&nbsp;AND&nbsp;ZKQTJB&nbsp;&lt;&gt;&nbsp;'X'&nbsp;AND&nbsp;ZXXYGZ&nbsp;&lt;&gt;&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'请选择模板'&nbsp;.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*FORM&nbsp;GET_DATA_10734.<br />
*<br />
*&nbsp;&nbsp;BEGIN&nbsp;=&nbsp;PN-BEGDA+0(6)&nbsp;&&&nbsp;'01'.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_DAY_OF_MONTH&nbsp;=&nbsp;END<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN_NO_DATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;END&nbsp;=&nbsp;END.<br />
*<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'+'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;BEG.<br />
*<br />
*<br />
*<br />
*&nbsp;&nbsp;CONCATENATE&nbsp;'000'&nbsp;SY-UNAME&nbsp;INTO&nbsp;ZRYDM&nbsp;.<br />
*<br />
*&nbsp;&nbsp;CLEAR:&nbsp;WA_TABLE1,IT_HRP1001,IT_HRP100101.<br />
*&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_TABLE1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;SY-UNAME.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'您无权下载工资模板！'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING&nbsp;.<br />
*<br />
*&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_TABLE1&nbsp;TO&nbsp;IT_TABLE1.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_DKZT&nbsp;FROM&nbsp;ZHRRP0160DKZT&nbsp;WHERE&nbsp;EX_GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;AND&nbsp;EX_GZZT&nbsp;&lt;&gt;&nbsp;'0'&nbsp;AND&nbsp;ORGEH&nbsp;=&nbsp;'50000000'.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'输入月份工资报表状态未打开&nbsp;请联系人力资源部！'&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING&nbsp;.<br />
*<br />
*&nbsp;&nbsp;ENDIF.<br />
*<br />
*ENDFORM.<br />
<br />
*取个人数据<br />
   </div>
   <div class="code">
FORM GET_DATA_BM.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T517T&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T517T&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"学位<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T005U&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T005U&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;LAND1&nbsp;=&nbsp;'CN'&nbsp;AND&nbsp;SPRAS&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"省份地区<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_HRP1000&nbsp;&nbsp;FROM&nbsp;&nbsp;HRP1000&nbsp;&nbsp;WHERE&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;ISTAT&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_HRP9101&nbsp;&nbsp;FROM&nbsp;&nbsp;HRP9101.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"级别<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;&nbsp;FROM&nbsp;&nbsp;HRP1001&nbsp;&nbsp;WHERE&nbsp;SUBTY&nbsp;=&nbsp;'A002'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T7CN6U&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T7CN6U&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"职位<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T005T&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T005T&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRAS&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"国籍<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T502T&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T502T&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"婚姻状况<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T505S&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T505S&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'&nbsp;AND&nbsp;MOLGA&nbsp;=&nbsp;'28'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"民族<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T7CN5R&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T7CN5R&nbsp;&nbsp;&nbsp;WHERE&nbsp;LANGU&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"政治面貌<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_ZHRT_FWXZ&nbsp;FROM&nbsp;ZHRT_FWXZ.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"房屋性质<br />
&nbsp;&nbsp;PN-BEGDA&nbsp;=&nbsp;BEG.<br />
ENDFORM.<br />
<br />
<br />
FORM GET_DATA_BF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:BEG.<br />
&nbsp;&nbsp;BEGIN&nbsp;=&nbsp;PN-BEGDA+0(6)&nbsp;&&&nbsp;'01'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_DAY_OF_MONTH&nbsp;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN_NO_DATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;END&nbsp;=&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'+'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;BEG.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;CONCATENATE&nbsp;'000'&nbsp;SY-UNAME&nbsp;INTO&nbsp;ZRYDM&nbsp;.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_TABLE1,IT_HRP1001,IT_HRP100101.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_TABLE1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'您无权下载工资模板！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING&nbsp;.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;APPEND&nbsp;WA_TABLE1&nbsp;TO&nbsp;IT_TABLE1.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CLEAR:&nbsp;WA_TABLE1.<br />
*&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_TABLE1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_TABLE1&nbsp;TO&nbsp;IT_TABLE2.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP1001&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;ZRYDM&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;&nbsp;"通过人员证章号&nbsp;取&nbsp;部门人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN&nbsp;ORDER&nbsp;BY&nbsp;BEGDA&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP1001.<br />
&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;IT_HRP1001&nbsp;BY&nbsp;BEGDA&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;INTO&nbsp;WA_HRP1001&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP100101&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;IT_HRP1001-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;&nbsp;&nbsp;"部门人员代码&nbsp;取&nbsp;部门编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100101.<br />
&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;IF&nbsp;WA_TABLE1-EX_RYJB&nbsp;&lt;&gt;&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_DKZT&nbsp;FROM&nbsp;ZHRRP0160DKZT&nbsp;WHERE&nbsp;EX_GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;AND&nbsp;EX_GZZT&nbsp;&lt;&gt;&nbsp;'0'&nbsp;AND&nbsp;ORGEH&nbsp;=&nbsp;IT_HRP100101-OBJID.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;WA_TABLE1-EX_RYJB&nbsp;=&nbsp;'1'&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_DKZT&nbsp;FROM&nbsp;ZHRRP0160DKZT&nbsp;WHERE&nbsp;EX_GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;AND&nbsp;EX_GZZT&nbsp;&lt;&gt;&nbsp;'0'&nbsp;AND&nbsp;ORGEH&nbsp;=&nbsp;'50000000'.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'输入月份工资报表状态未打开&nbsp;请联系人力资源部！'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING&nbsp;.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
ENDFORM.<br />
<br />
FORM GET_DATA.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;Z0001&nbsp;TYPE&nbsp;I.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;P0001&nbsp;WHERE&nbsp;PERSG&nbsp;=&nbsp;'1'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;STRUCT-PERNR&nbsp;=&nbsp;P0001-PERNR.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;Z0001&nbsp;=&nbsp;1.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;P0536&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CHECK&nbsp;Z0001&nbsp;=&nbsp;1.<br />
*宏<br />
   </div>
   <div class="code">
&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;P0001&nbsp;SPACE&nbsp;BEGIN&nbsp;END.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"用于取部门<br />
<br />
&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;P0002&nbsp;SPACE&nbsp;BEGIN&nbsp;END.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"用于取部门<br />
<br />
&nbsp;&nbsp;WA_STRUCT-PERNR&nbsp;=&nbsp;PERNR-PERNR.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员代码<br />
<br />
&nbsp;&nbsp;WA_STRUCT-NACHN&nbsp;=&nbsp;P0002-NACHN.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"姓<br />
&nbsp;&nbsp;WA_STRUCT-VORNA&nbsp;=&nbsp;P0002-VORNA.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"名<br />
&nbsp;&nbsp;WA_STRUCT-VORNA&nbsp;=&nbsp;WA_STRUCT-NACHN&nbsp;&&&nbsp;WA_STRUCT-VORNA.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"姓名<br />
&nbsp;&nbsp;WA_STRUCT-PERSG&nbsp;=&nbsp;P0001-PERSG.<br />
&nbsp;&nbsp;WA_STRUCT-PERSK&nbsp;=&nbsp;P0001-PERSK.<br />
&nbsp;&nbsp;WA_STRUCT-ZCJDM&nbsp;=&nbsp;P0001-ZCJDM.<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T501T&nbsp;FROM&nbsp;T501T&nbsp;WHERE&nbsp;&nbsp;SPRSL&nbsp;=&nbsp;1&nbsp;&nbsp;AND&nbsp;PERSG&nbsp;=&nbsp;P0001-PERSG.&nbsp;&nbsp;"员工组描述<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_T501T&nbsp;INTO&nbsp;WA_T501T.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-YGZMS&nbsp;=&nbsp;WA_T501T-PTEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T503T&nbsp;FROM&nbsp;T503T&nbsp;WHERE&nbsp;&nbsp;SPRSL&nbsp;=&nbsp;1&nbsp;&nbsp;AND&nbsp;PERSK&nbsp;=&nbsp;P0001-PERSK.&nbsp;"员工子组描述<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_T503T&nbsp;INTO&nbsp;WA_T503T.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-YGZZMS&nbsp;=&nbsp;WA_T503T-PTEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;WA_STRUCT-YGZZMS&nbsp;=&nbsp;WA_STRUCT-YGZMS&nbsp;&&&nbsp;'--'&nbsp;&&&nbsp;WA_STRUCT-YGZZMS.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1000&nbsp;WITH&nbsp;KEY&nbsp;OBJID&nbsp;=&nbsp;P0001-ORGEH.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-ZORG1&nbsp;=&nbsp;P0001-ORGEH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-SHORT&nbsp;=&nbsp;IT_HRP1000-STEXT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;CHECK&nbsp;P0000-STAT2&nbsp;=&nbsp;'3'&nbsp;AND&nbsp;P0001-PERSG&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"满足这两个条件的人员代码<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"插入内表<br />
&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT.<br />
<br />
ENDFORM.<br />
<br />
FORM POST_DATA.<br />
&nbsp;&nbsp;DATA:&nbsp;L_INDEX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;NUMC4.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;CLEAR:WA_TABLE1,IT_HRP1001,IT_HRP100101,WA_HRP100102,IT_HRP100102,WA_STRUCT,WA_HRP100103,IT_HRP100103,WA_HRP100104,IT_HRP100104,WA_QXJB1,IT_QXJB1<br />
,IT_HRP1001[],IT_HRP100101[],WA_HRP100102,IT_HRP100102[],WA_STRUCT,WA_HRP100103,IT_HRP100103[],WA_HRP100104,IT_HRP100104[],WA_QXJB1,IT_QXJB1[]<br />
&nbsp;&nbsp;.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_TABLE1&nbsp;INTO&nbsp;WA_TABLE1&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;WA_TABLE1-EX_RYJB&nbsp;=&nbsp;'8'."领导班子<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;级别8&nbsp;取登录人所在部门人员信息<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP1001&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;ZRYDM&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"通过人员证章号&nbsp;取&nbsp;部门人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP1001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_HRP1001&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;INTO&nbsp;WA_HRP1001&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP100101&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;IT_HRP1001-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;&nbsp;&nbsp;&nbsp;"部门人员代码&nbsp;取&nbsp;部门编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100101.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;"部门人员代码&nbsp;取&nbsp;部门编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员证章号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100103&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT,WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;SOBID&nbsp;=&nbsp;WA_HRP100103-OBJID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100102-OBJID&nbsp;.&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
*&nbsp;删除信息员人员信息<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:IT_STRUCT,WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'&nbsp;OR&nbsp;PERSK&nbsp;=&nbsp;'42'<br />
&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;IT_STRUCT1,WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-XH&nbsp;=&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT1&nbsp;&nbsp;FROM&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*级别1<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;WA_TABLE1-EX_RYJB&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;IT_QXJB&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'2'&nbsp;OR&nbsp;EX_RYJB&nbsp;=&nbsp;'1'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&nbsp;IT_QXJB&nbsp;INTO&nbsp;WA_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_QXJB-PERNR&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;删除信息员人员信息<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:IT_STRUCT,WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'&nbsp;OR&nbsp;PERSK&nbsp;=&nbsp;'42'<br />
&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;IT_STRUCT1,WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-XH&nbsp;=&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT1&nbsp;&nbsp;FROM&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*级别2<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;WA_TABLE1-EX_RYJB&nbsp;=&nbsp;'2'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP1001&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;ZRYDM&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"通过人员证章号&nbsp;取&nbsp;部门人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP1001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_HRP1001&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;INTO&nbsp;WA_HRP1001&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP100101&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;IT_HRP1001-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;&nbsp;&nbsp;"部门人员代码&nbsp;取&nbsp;部门编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100101.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;IT_HRP100101-OBJID&nbsp;=&nbsp;'50000004'&nbsp;OR&nbsp;IT_HRP100101-OBJID&nbsp;=&nbsp;'50000058'&nbsp;."当部门是总店经营部和连锁时候，取3级人员数据<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'O'&nbsp;&nbsp;&nbsp;"取部门编号下的所有部门代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;WA_STRUCT1&nbsp;is&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100104&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100104&nbsp;TO&nbsp;IT_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100104&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;WA_QXJB,WA_STRUCT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100103-OBJID&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;WA_QXJB&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'3'&nbsp;AND&nbsp;PERNR&nbsp;=&nbsp;WA_STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_QXJB&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_QXJB&nbsp;TO&nbsp;IT_QXJB.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100104&nbsp;INTO&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;WA_QXJB&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'3'&nbsp;AND&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100104-SOBID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_QXJB&nbsp;TO&nbsp;IT_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&nbsp;IT_QXJB&nbsp;INTO&nbsp;WA_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_QXJB-PERNR&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT1&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;IT_STRUCT1&nbsp;BY&nbsp;PERNR.<br />
<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;IT_STRUCT1&nbsp;COMPARING&nbsp;ALL&nbsp;FIELDS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:IT_STRUCT,WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'&nbsp;OR&nbsp;PERSK&nbsp;=&nbsp;'42'<br />
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;IT_STRUCT1,WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-XH&nbsp;=&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT1&nbsp;&nbsp;FROM&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;IT_HRP100101-OBJID&nbsp;=&nbsp;'50000208'&nbsp;OR&nbsp;IT_HRP100101-OBJID&nbsp;=&nbsp;'50000200'&nbsp;."当部门是财务部和物流中心时候，取3级人员数据<br />
<br />
   </div>
   <div class="codeComment">
*先取级别是3的对应部门的干部<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'O'&nbsp;&nbsp;&nbsp;"取部门编号下的所有部门代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100102&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;WA_STRUCT1&nbsp;is&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100104&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100104&nbsp;TO&nbsp;IT_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100104&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100104&nbsp;INTO&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;WA_QXJB&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'3'&nbsp;AND&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100104-SOBID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_QXJB&nbsp;TO&nbsp;IT_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;IT_STRUCT1&nbsp;BY&nbsp;PERNR.<br />
&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;IT_STRUCT1&nbsp;COMPARING&nbsp;ALL&nbsp;FIELDS.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;修改20160830<br />
   </div>
   <div class="code">
IF IT_HRP100101-OBJID = '50000208'."财务部删除收银人员<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&nbsp;IT_QXJB&nbsp;INTO&nbsp;WA_QXJB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_QXJB-PERNR&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100104&nbsp;INTO&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100104-SOBID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDIF.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;将级别是2的部门下面的人员取出来<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_TABLE1,WA_HRP100102,IT_HRP100102,WA_STRUCT,WA_HRP100103,IT_HRP100103,WA_HRP100104,IT_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_TABLE1,WA_HRP100102,IT_HRP100102[],WA_STRUCT,WA_HRP100103,IT_HRP100103[],WA_HRP100104,IT_HRP100104[].<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"取部门编号下的所有部门人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员证章号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100103&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT,WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;SOBID&nbsp;=&nbsp;WA_HRP100103-OBJID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100102-OBJID&nbsp;.&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;删除级别是2的人员信息<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;WA_QXJB1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'2'&nbsp;OR&nbsp;EX_RYJB&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_QXJB1&nbsp;TO&nbsp;IT_QXJB1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_QXJB.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&nbsp;IT_QXJB1&nbsp;INTO&nbsp;WA_QXJB1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;WA_QXJB1-PERNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;删除信息员人员信息<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:IT_STRUCT,WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'&nbsp;OR&nbsp;PERSK&nbsp;=&nbsp;'42'<br />
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;IT_STRUCT1,WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-XH&nbsp;=&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT1&nbsp;&nbsp;FROM&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;IT_HRP100101-OBJID&nbsp;&lt;&gt;&nbsp;'50000004'&nbsp;AND&nbsp;&nbsp;IT_HRP100101-OBJID&nbsp;&lt;&gt;&nbsp;'50000058'&nbsp;AND&nbsp;IT_HRP100101-OBJID&nbsp;&lt;&gt;&nbsp;'50000208'&nbsp;AND&nbsp;IT_HRP100101-OBJID&nbsp;&lt;&gt;&nbsp;'50000200'."当部门是不是总店经营部和连锁时候，取4级人员数据<br />
<br />
   </div>
   <div class="codeComment">
*先取部门所有人员信息<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"取部门编号下的所有部门人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员证章号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100103&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT,WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;SOBID&nbsp;=&nbsp;WA_HRP100103-OBJID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100102-OBJID&nbsp;.&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;删除级别是2的人员信息<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;WA_QXJB1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'2'&nbsp;OR&nbsp;EX_RYJB&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_QXJB1&nbsp;TO&nbsp;IT_QXJB1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_QXJB.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&nbsp;IT_QXJB1&nbsp;INTO&nbsp;WA_QXJB1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;WA_QXJB1-PERNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;删除信息员人员信息<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:IT_STRUCT,WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'&nbsp;OR&nbsp;PERSK&nbsp;=&nbsp;'42'<br />
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;IT_STRUCT1,WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-XH&nbsp;=&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT1&nbsp;&nbsp;FROM&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*级别3<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;WA_TABLE1-EX_RYJB&nbsp;=&nbsp;'3'.<br />
<br />
   </div>
   <div class="codeComment">
*先取级别3部门下员工<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;IT_HRP1001&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;&nbsp;SOBID&nbsp;=&nbsp;ZRYDM&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEG&nbsp;."证章号取部门代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP1001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_HRP1001&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;INTO&nbsp;WA_HRP1001&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;IT_HRP100101&nbsp;FROM&nbsp;HRP1001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;IT_HRP1001-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN."部门人员代码&nbsp;取&nbsp;部门编号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100101.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEG&nbsp;."取部门编号下的所有部门人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;IT_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员证章号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100103&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT,WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;SOBID&nbsp;=&nbsp;WA_HRP100103-OBJID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100102-OBJID&nbsp;.&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;取级别是3的人员对应部门的下级部门人员信息<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_TABLE1,WA_HRP100102,IT_HRP100102,WA_STRUCT,WA_HRP100103,IT_HRP100103,WA_HRP100104,IT_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_TABLE1,WA_HRP100102,IT_HRP100102[],WA_STRUCT,WA_HRP100103,IT_HRP100103[],WA_HRP100104,IT_HRP100104[].<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;IT_HRP100102&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;IT_HRP100101-OBJID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;RSIGN&nbsp;=&nbsp;'B'&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;"取部门编号下的所有部门代码<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100102&nbsp;INTO&nbsp;WA_HRP100102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100103&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100102-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;"取部门人员代码对应的人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100103&nbsp;TO&nbsp;IT_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;WA_HRP100104&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;WA_HRP100103-SOBID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;AND&nbsp;SCLAS&nbsp;=&nbsp;'P'&nbsp;&nbsp;&nbsp;"取人员代码对应的人员证章<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BEGDA&nbsp;&lt;&nbsp;BEG&nbsp;AND&nbsp;ENDDA&nbsp;&gt;&nbsp;BEGIN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_HRP100104&nbsp;TO&nbsp;IT_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;IT_HRP100104&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_HRP100104&nbsp;INTO&nbsp;WA_HRP100104.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_STRUCT,WA_HRP100103.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP100103&nbsp;INTO&nbsp;WA_HRP100103&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;SOBID&nbsp;=&nbsp;WA_HRP100104-OBJID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_HRP100104-SOBID&nbsp;ZORG1&nbsp;=&nbsp;WA_HRP100103-OBJID&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;删除级别是3的人员信息<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;&nbsp;WA_QXJB1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'3'&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_QXJB1&nbsp;TO&nbsp;IT_QXJB1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_QXJB.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&nbsp;IT_QXJB1&nbsp;INTO&nbsp;WA_QXJB1&nbsp;WHERE&nbsp;EX_RYJB&nbsp;=&nbsp;'3'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;WA_QXJB1-PERNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*取级别3下面的部门下面人员信息<br />
<br />
*取信息员数据<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZXXYGZ&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:IT_STRUCT,WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'&nbsp;OR&nbsp;PERSK&nbsp;=&nbsp;'42'<br />
&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;IT_STRUCT1,WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT1&nbsp;TO&nbsp;IT_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT1&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT1&nbsp;INTO&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_INDEX&nbsp;=&nbsp;L_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-XH&nbsp;=&nbsp;L_INDEX&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT1&nbsp;&nbsp;FROM&nbsp;WA_STRUCT1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
ENDFORM.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&ALV处理函数<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_SHOW_ZRCKHTJB.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MARK'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-CHECKBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;'序号'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'GZYF'&nbsp;'工资年月'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZORG1'&nbsp;'部门代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERSK'&nbsp;'人员类型'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'YGZZMS'&nbsp;'人员类型描述'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'T527X&nbsp;'&nbsp;'考核日期'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT2&nbsp;'&nbsp;'考核原因'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT3&nbsp;'&nbsp;'考核金额'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_STRUCT1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
ENDFORM.<br />
<br />
<br />
<br />
FORM ALV_SHOW_ZJJFPB.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MARK'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-CHECKBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;'序号'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'GZYF'&nbsp;'工资年月'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZORG1'&nbsp;'部门代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERSK'&nbsp;'人员类型'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'YGZZMS'&nbsp;'人员类型描述'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'T527X'&nbsp;'奖金金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT2'&nbsp;'加时金额'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_STRUCT1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
ENDFORM.<br />
<br />
FORM ALV_SHOW_ZXSTJB.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MARK'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-CHECKBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;'序号'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'GZYF'&nbsp;'工资年月'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZORG1'&nbsp;'部门代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERSK'&nbsp;'人员类型'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'YGZZMS'&nbsp;'人员类型描述'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'T527X'&nbsp;'贵金属销售计划'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT2'&nbsp;'贵金属实际完成'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT3'&nbsp;'贵金属克重计划'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT4'&nbsp;'贵金属克重完成'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT5'&nbsp;'贵金属件数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT6'&nbsp;'镶嵌金额计划'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT7'&nbsp;'镶嵌实际完成'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT8'&nbsp;'镶嵌件数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT9'&nbsp;'服务计划次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT10'&nbsp;'服务完成次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT11'&nbsp;'收银收款金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT12'&nbsp;'收银收款次数'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_STRUCT1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
ENDFORM.<br />
<br />
<br />
<br />
<br />
FORM ALV_SHOW_ZKQTJB.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MARK'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-CHECKBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;'序号'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'GZYF'&nbsp;'工资年月'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZORG1'&nbsp;'部门代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERSK'&nbsp;'人员类型'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'YGZZMS'&nbsp;'人员类型描述'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'T527X'&nbsp;'出勤'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT2'&nbsp;'公休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT3'&nbsp;'节休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT4'&nbsp;'年假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT5'&nbsp;'增休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT6'&nbsp;'节后补休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT7'&nbsp;'病假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT8'&nbsp;'事假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT9'&nbsp;'产假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT10'&nbsp;'婚假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT11'&nbsp;'丧假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT12'&nbsp;'探亲假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT13'&nbsp;'学习假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT14'&nbsp;'其他假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT15'&nbsp;'盘点次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT16'&nbsp;'节日加班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT17'&nbsp;'其他加班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT18'&nbsp;'夜班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT19'&nbsp;'出差天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT20'&nbsp;'外埠天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT21'&nbsp;'日常考核扣款金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT22'&nbsp;'备注'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT23'&nbsp;'交通补助'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT24'&nbsp;'存公休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT25'&nbsp;'存年假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT26'&nbsp;'当季未休增休'.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_STRUCT1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&ALV显示列<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ZALV_SHOW_TOTAL USING    FIELDNAME  TYPE CHAR30<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELTEXT&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR30.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
&nbsp;&nbsp;WA_FIELDCAT-TABNAME&nbsp;&nbsp;&nbsp;=&nbsp;'STRUCT'.<br />
&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;=&nbsp;&nbsp;FIELDNAME.<br />
&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;=&nbsp;SELTEXT.<br />
&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
ENDFORM.<br />
<br />
<br />
FORM ALV_SHOW_ZXXYGZ.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MARK'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-CHECKBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;WA_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WA_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;'序号'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZCJDM'&nbsp;'厂家代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZORG1'&nbsp;'部门代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'GZYF'&nbsp;'工资年月'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT3'&nbsp;'本厂-钻石'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT4'&nbsp;'本厂-钻石2'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT5'&nbsp;'本厂-珠宝'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT6'&nbsp;'本厂-珠宝2'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT7'&nbsp;'本厂-翡翠白玉'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT8'&nbsp;'本厂-翡翠白玉2'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT9'&nbsp;'本厂-K金'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT10'&nbsp;'本厂-银饰'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT11'&nbsp;'本厂-销售合计'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT12'&nbsp;'非本厂-钻石'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT13'&nbsp;'非本厂-钻石2'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT14'&nbsp;'非本厂-珠宝'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT15'&nbsp;'非本厂-珠宝2'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT16'&nbsp;'非本厂-翡翠白玉'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT17'&nbsp;'非本厂-翡翠白玉2'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT18'&nbsp;'非本厂-K金'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT19'&nbsp;'非本厂-银饰'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT20'&nbsp;'非本厂-销售合计'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT21'&nbsp;'出勤天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT22'&nbsp;'饭补'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT25'&nbsp;'公休天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT27'&nbsp;'节休天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT28'&nbsp;'年假天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT29'&nbsp;'增休天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT31'&nbsp;'病假天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT32'&nbsp;'事假天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT33'&nbsp;'婚假天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT34'&nbsp;'丧假天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT35'&nbsp;'其它假天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT36'&nbsp;'节日加班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT37'&nbsp;'其它加班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT38'&nbsp;'百分考核'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT39'&nbsp;'日常考核扣款'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT30'&nbsp;'备注'.<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_STRUCT1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
ENDFORM.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&ALV工具栏处理事件<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM USER_COMMAND USING R_UCOMM LIKE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS_SELFIELD&nbsp;TYPE&nbsp;SLIS_SELFIELD.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;DIRPATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;Z_TEXT&nbsp;&nbsp;TYPE&nbsp;CHAR100.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;REF_GRID&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GET_GLOBALS_FROM_SLVC_FULLSCR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_GRID&nbsp;=&nbsp;REF_GRID.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;NOT&nbsp;REF_GRID&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;REF_GRID-&gt;CHECK_CHANGED_DATA&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;CASE&nbsp;R_UCOMM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DOWN_DATA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;RS_SELFIELD-REFRESH&nbsp;=&nbsp;'X'.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&工具栏状态<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM PF_STATUS_SET USING P_EXTAB TYPE SLIS_T_EXTAB..<br />
&nbsp;&nbsp;"Set&nbsp;the&nbsp;Button&nbsp;using&nbsp;the&nbsp;staus<br />
&nbsp;&nbsp;"Copy&nbsp;the&nbsp;Standard&nbsp;status&nbsp;from&nbsp;the&nbsp;program&nbsp;SAPLKKBL&nbsp;status<br />
&nbsp;&nbsp;"&nbsp;STANDARD&nbsp;using&nbsp;SE41,&nbsp;and&nbsp;use&nbsp;that&nbsp;here.<br />
&nbsp;&nbsp;"Pf&nbsp;status<br />
&nbsp;&nbsp;SET&nbsp;PF-STATUS&nbsp;'ZHRRP0010_ST'.<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&excel下载<br />
*&---------------------------------------------------------------------*<br />
<br />
<br />
<br />
<br />
*FORM&nbsp;FM_DOWNLOAD&nbsp;USING&nbsp;PERNR&nbsp;LIKE&nbsp;STRUCT&nbsp;L_PATH.<br />
*<br />
*&nbsp;&nbsp;DATA:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_TEXT&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR100,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LW_OUT_TAB&nbsp;TYPE&nbsp;STRUCT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL&nbsp;TYPE&nbsp;TY_EXCEL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LT_EXCEL&nbsp;TYPE&nbsp;TYT_EXCEL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;DIRPATH&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;Z_TEXT&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR100.<br />
*<br />
*&nbsp;&nbsp;Z_TEXT&nbsp;=&nbsp;&nbsp;'职工履历表_'&&&nbsp;STRUCT-PERNR&nbsp;&&&nbsp;STRUCT-VORNA.<br />
*<br />
**&nbsp;获取路径<br />
*<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;L_PATH&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;下载模板到指定路径<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FM_GET_TEMPLATE&nbsp;USING&nbsp;CNS_OBJID&nbsp;L_PATH.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;INI&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;INI1&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;INI2&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;INI3&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;1.<br />
*<br />
**&nbsp;&nbsp;&nbsp;编辑数据行<br />
**&nbsp;&nbsp;&nbsp;第一行&nbsp;姓名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;性别&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;民族<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-VORNA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;20.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;''.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-GESCH.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-LTEXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第二行&nbsp;曾用名&nbsp;&nbsp;政治面貌&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;籍贯<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-NAME2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-PTEXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_PA0529.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0529&nbsp;FROM&nbsp;PA0529&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_PA0529&nbsp;INTO&nbsp;WA_PA0529&nbsp;INDEX&nbsp;1.<br />
*<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0529-ZJIGN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;第三行&nbsp;&nbsp;&nbsp;"出生日期"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"健康状况"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;血型<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-GBDAT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;3.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-PTEXT.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-ZXUEX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第四行&nbsp;"入团时间"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"入党时间"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;身份证号码<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-BEGDA1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-BEGDA1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;'`'&nbsp;&&&nbsp;STRUCT-ICNUM.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第五行<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;''.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;''.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;''.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第六行&nbsp;婚育状况&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"本人是否为独生子女"<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;6.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-FATXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;6.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-ZDSZN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;第⑦行&nbsp;&nbsp;"已毕业学历（学信网认证）"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;毕业学校<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-STEXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-INSTI.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;第8行&nbsp;所学专业&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;毕业时间<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;8.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-FACH3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;8.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-ENDDA1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第9行&nbsp;参加工作时间&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;调入本企业时间<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;9.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-DAT01.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;9.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-DAT02.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第10行&nbsp;现工作部门&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;职务或工种<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-SHORT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;WA_PA0001,WA_T528T.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0001&nbsp;FROM&nbsp;PA0001&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_PA0001&nbsp;INTO&nbsp;WA_PA0001&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T528T&nbsp;FROM&nbsp;T528T&nbsp;WHERE&nbsp;PLANS&nbsp;=&nbsp;WA_PA0001-PLANS.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_T528T&nbsp;INTO&nbsp;WA_T528T&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;STRUCT-JOBTX&nbsp;=&nbsp;''&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_T528T-PLSTX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;STRUCT-JOBTX&nbsp;&lt;&gt;&nbsp;''&nbsp;AND&nbsp;WA_T528T-PLSTX&nbsp;&lt;&gt;&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_T528T-PLSTX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;STRUCT-JOBTX&nbsp;&lt;&gt;&nbsp;''&nbsp;AND&nbsp;WA_T528T-PLSTX&nbsp;=&nbsp;''&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-JOBTX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;第11行&nbsp;家庭住址<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;11.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-STATE&nbsp;&&&nbsp;STRUCT-ORT01&nbsp;&&&nbsp;STRUCT-LOCAT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第12行&nbsp;现居住地址&nbsp;&nbsp;&nbsp;是否为租房<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-STATE_X&nbsp;&&&nbsp;STRUCT-ORT01_X&nbsp;&&&nbsp;STRUCT-LOCAT_X.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;13.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-ZFWXZ.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第13行&nbsp;&nbsp;户口登记地址&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"户口所属街道"<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;13.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-STATE_HJ&nbsp;&&&nbsp;STRUCT-ORT01_HJ&nbsp;&&&nbsp;STRUCT-LOCAT_HJ.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_PA0006.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0006&nbsp;FROM&nbsp;PA0006&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_PA0006&nbsp;INTO&nbsp;WA_PA0006&nbsp;INDEX&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;13.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;13.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0006-STRAS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第14行&nbsp;户口性质<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;14.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;STRUCT-HUKOT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;第15-16行&nbsp;&nbsp;本人联系电话&nbsp;&nbsp;紧急联系人电话<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_PA0105.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0105&nbsp;FROM&nbsp;PA0105&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_PA0105&nbsp;INTO&nbsp;WA_PA0105&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WA_PA0105-USRTY&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0002'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;15.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0105-USRID.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0003'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;15.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0105-USRID.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0007'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;16.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0105-USRID.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'0008'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;16.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0105-USRID.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第17行&nbsp;&nbsp;教育经历<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA3529&nbsp;FROM&nbsp;PA3529&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_PA3529&nbsp;BY&nbsp;ENDDA&nbsp;DESCENDING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA3529&nbsp;INTO&nbsp;WA_PA3529.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;INI&nbsp;&lt;&nbsp;6.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;17&nbsp;+&nbsp;INI.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA3529-BEGDA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;17&nbsp;+&nbsp;INI.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA3529-ENDDA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0022&nbsp;FROM&nbsp;PA0022&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;WA_PA3529-PERNR&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;WA_PA3529-SUBTY&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA0022&nbsp;INTO&nbsp;WA_PA0022.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;17&nbsp;+&nbsp;INI.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0022-INSTI.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;17&nbsp;+&nbsp;INI.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA3529-FACH3.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;17&nbsp;+&nbsp;SY-INDEX.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;14.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;P3529-SLABS.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INI&nbsp;=&nbsp;INI&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第25行&nbsp;培训经历<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA9005&nbsp;FROM&nbsp;PA9005&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_PA9005&nbsp;BY&nbsp;ZPXQS&nbsp;DESCENDING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA9005&nbsp;INTO&nbsp;WA_PA9005.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;INI1&nbsp;&lt;&nbsp;6.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;25&nbsp;+&nbsp;INI1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA9005-ZPXQS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;25&nbsp;+&nbsp;INI1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA9005-ZPXZS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;25&nbsp;+&nbsp;INI1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA9005-ZPXDW.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;25&nbsp;+&nbsp;INI1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA9005-ZPXXM.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_ZHRT_ZSMC&nbsp;FROM&nbsp;ZHRT_ZSMC&nbsp;WHERE&nbsp;ZZSMC&nbsp;=&nbsp;WA_PA9005-ZZSMC&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_ZHRT_ZSMC&nbsp;INTO&nbsp;WA_ZHRT_ZSMC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;25&nbsp;+&nbsp;INI1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;14.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_ZHRT_ZSMC-ZTZSMC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INI1&nbsp;=&nbsp;INI1&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;第33行&nbsp;&nbsp;工作经历<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0023&nbsp;FROM&nbsp;PA0023&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_PA0023&nbsp;BY&nbsp;ENDDA&nbsp;DESCENDING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA0023&nbsp;INTO&nbsp;WA_PA0023.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;INI2&nbsp;&lt;&nbsp;6.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;33&nbsp;+&nbsp;INI2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0023-BEGDA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;33&nbsp;+&nbsp;INI2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;5.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0023-ENDDA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;33&nbsp;+&nbsp;INI2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0023-ARBGB.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA3528&nbsp;&nbsp;FROM&nbsp;PA3528&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;=&nbsp;WA_PA0023-BEGDA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA3528&nbsp;INTO&nbsp;WA_PA3528&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;33&nbsp;+&nbsp;INI2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;12.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA3528-DEPTN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;33&nbsp;+&nbsp;INI2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;14.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA3528-JOBINFO.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INI2&nbsp;=&nbsp;INI2&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;&nbsp;WA_PA0021,WA_T591S,WA_PA0528,&nbsp;WA_T7CN5R.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0021&nbsp;FROM&nbsp;PA0021&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_PA0021&nbsp;BY&nbsp;FAMSA&nbsp;DESCENDING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA0021&nbsp;INTO&nbsp;WA_PA0021.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_PA0021-FAMSA&nbsp;=&nbsp;'1'.<br />
**&nbsp;&nbsp;&nbsp;第41行&nbsp;&nbsp;&nbsp;家庭成员-配偶<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;41&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0021-FANAM&nbsp;&&&nbsp;&nbsp;WA_PA0021-FAVOR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;41&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;6.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0021-FGBDT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_PA0528,WA_T7CN5R.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0528&nbsp;FROM&nbsp;PA0528&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;WA_PA0021-PERNR&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;WA_PA0021-SUBTY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_PA0528&nbsp;INTO&nbsp;WA_PA0528&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T7CN5R&nbsp;FROM&nbsp;T7CN5R&nbsp;&nbsp;WHERE&nbsp;PCODE&nbsp;=&nbsp;WA_PA0528-PSTAT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_T7CN5R&nbsp;INTO&nbsp;WA_T7CN5R&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;41&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_T7CN5R-PTEXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_PA0528-OLCHD&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;41&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;'是'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;41&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;'否'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;41&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;14.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0528-TELNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;&nbsp;WA_PA0021,WA_T591S,WA_PA0528,&nbsp;WA_T7CN5R.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0021&nbsp;FROM&nbsp;PA0021&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;IT_PA0021&nbsp;BY&nbsp;FAMSA&nbsp;DESCENDING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA0021&nbsp;INTO&nbsp;WA_PA0021.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_PA0021-FAMSA&nbsp;&lt;&gt;&nbsp;'1'.<br />
**&nbsp;&nbsp;&nbsp;第42行&nbsp;家庭成员-其他<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;INI3&nbsp;&lt;&nbsp;6&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T591S&nbsp;FROM&nbsp;T591S&nbsp;&nbsp;WHERE&nbsp;SUBTY&nbsp;=&nbsp;WA_PA0021-FAMSA&nbsp;AND&nbsp;INFTY&nbsp;=&nbsp;'0021'&nbsp;AND&nbsp;SPRSL&nbsp;=&nbsp;'1'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_T591S&nbsp;INTO&nbsp;WA_T591S&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;42&nbsp;+&nbsp;INI3&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_T591S-STEXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;42&nbsp;+&nbsp;INI3&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0021-FANAM&nbsp;&&&nbsp;&nbsp;WA_PA0021-FAVOR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;42&nbsp;+&nbsp;INI3&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;6.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0021-FGBDT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA0528&nbsp;FROM&nbsp;PA0528&nbsp;&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;WA_PA0021-PERNR&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;WA_PA0021-SUBTY&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_PA0528&nbsp;INTO&nbsp;WA_PA0528&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T7CN5R&nbsp;FROM&nbsp;T7CN5R&nbsp;&nbsp;WHERE&nbsp;PCODE&nbsp;=&nbsp;WA_PA0528-PSTAT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_T7CN5R&nbsp;INTO&nbsp;WA_T7CN5R&nbsp;INDEX&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;42&nbsp;+&nbsp;INI3&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_T7CN5R-PTEXT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;42&nbsp;+&nbsp;INI3&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;14.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0528-TELNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INI3&nbsp;=&nbsp;INI3&nbsp;+&nbsp;1&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
**&nbsp;&nbsp;&nbsp;第51行&nbsp;&nbsp;本人奖励情况（区级以上）<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_PA9004,WA1_PA9004&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_PA9004&nbsp;FROM&nbsp;PA9004&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;STRUCT-PERNR..<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_PA9004&nbsp;INTO&nbsp;WA1_PA9004&nbsp;.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_PA9004-ZYYIN&nbsp;=&nbsp;WA_PA9004-ZYYIN&nbsp;&&&nbsp;WA1_PA9004-ZYYIN.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;51&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;6.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA9004-ZYYIN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
**&nbsp;&nbsp;&nbsp;第56行&nbsp;&nbsp;有何特长和爱好<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LW_EXCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-ROW&nbsp;=&nbsp;56.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-COL&nbsp;=&nbsp;6.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL-VALUE&nbsp;=&nbsp;WA_PA0529-ZGRTC.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LW_EXCEL&nbsp;TO&nbsp;LT_EXCEL.<br />
*<br />
*<br />
*<br />
*<br />
*<br />
*<br />
*<br />
**&nbsp;&nbsp;&nbsp;数据填充<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FM_FILL_DATA1&nbsp;USING&nbsp;L_PATH&nbsp;LT_EXCEL.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S001(00)&nbsp;WITH&nbsp;'取消下载'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
*&nbsp;&nbsp;ENDIF.<br />
*ENDFORM.<br />
*<br />
*DATA:&nbsp;COMPS2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;SCMS_DOINF&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMP_NAMES&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;SCMS_DONAM&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
*<br />
*<br />
*<br />
*<br />
*<br />
*<br />
*<br />
*FORM&nbsp;PHOTO_DOWN&nbsp;USING&nbsp;PERNR&nbsp;LIKE&nbsp;STRUCT.<br />
*<br />
*&nbsp;&nbsp;DATA:&nbsp;L_CONNECT_INFO&nbsp;LIKE&nbsp;TOAV0,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_EXISTS(1)&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;C.<br />
*&nbsp;&nbsp;DATA:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_TEXT&nbsp;TYPE&nbsp;CHAR100,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;F_PATH&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;Z_TEXT&nbsp;TYPE&nbsp;CHAR100.<br />
*<br />
*&nbsp;&nbsp;Z_TEXT&nbsp;=&nbsp;'C:\HRphoto'&nbsp;.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;&nbsp;'C:\HRPHOTO'&nbsp;STRUCT-PERNR&nbsp;'.JPG'&nbsp;INTO&nbsp;Z_TEXT.<br />
*<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'HR_IMAGE_EXISTS'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_PERNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STRUCT-PERNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_EXISTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_EXISTS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_CONNECT_INFO&nbsp;=&nbsp;L_CONNECT_INFO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4&nbsp;.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXIT&nbsp;.<br />
*&nbsp;&nbsp;else.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SCMS_DOC_READ_FILES'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOR_CAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SPACE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREP_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_CONNECT_INFO-ARCHIV_ID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOC_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_CONNECT_INFO-ARC_DOC_ID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Z_TEXT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FRONTEND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;COMPS2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMP_NAMES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;COMP_NAMES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BAD_STORAGE_TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BAD_REQUEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNAUTHORIZED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONFLICT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERNAL_SERVER_ERROR&nbsp;=&nbsp;6<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_HTTP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_SIGNATURE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_CONFIG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_HIERARCHY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_DOWNLOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;11<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_OPEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;12<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;13<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;14<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;15.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
**.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4&nbsp;.<br />
*&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;endif.<br />
*.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDFORM.<br />
<br />
*FORM&nbsp;FM_GET_FILEPATH1&nbsp;USING&nbsp;C_FULLPATH&nbsp;I_NAME.<br />
*&nbsp;&nbsp;DATA:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_DEFAULT&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_FILENAME&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_FULLPATH&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_DEFAULT&nbsp;=&nbsp;I_NAME.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;FILE_SAVE_DIALOG&nbsp;"调用保存对话框<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_EXTENSION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'XLSM'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_FILE_NAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_DEFAULT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_FILENAME<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_PATH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FULLPATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_FULLPATH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C_FULLPATH&nbsp;=&nbsp;L_FULLPATH.<br />
*ENDFORM.<br />
<br />
*FORM&nbsp;FM_GET_FILEPATH1&nbsp;USING&nbsp;C_FULLPATH&nbsp;I_NAME.<br />
*<br />
*&nbsp;&nbsp;DATA:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_DEFAULT&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_FILENAME&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_FULLPATH&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_DEFAULT&nbsp;=&nbsp;I_NAME.<br />
*<br />
*<br />
*CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;FILE_SAVE_DIALOG<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'下载到本地文件'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_EXTENSION&nbsp;=&nbsp;'XLS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"缺省文件类型<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_FILE_NAME&nbsp;=&nbsp;L_DEFAULT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'文本文件(*.TXT)|*.TXT|EXCEL&nbsp;文件&nbsp;(*.XLS)|*.XLS;*.XLSX|所有文件&nbsp;(*.*)|*.*|'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH_ENCODING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;CHANGING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_FILENAME<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_PATH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FULLPATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L_FULLPATH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*ENDFORM.<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
FORM FM_GET_FILEPATH2 CHANGING DIRPATH .<br />
<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;Z_TEXT&nbsp;TYPE&nbsp;CHAR100.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;DIRECTORY_BROWSE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择目录'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECTED_FOLDER&nbsp;=&nbsp;DIRPATH.&nbsp;"<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;PERFORM&nbsp;FM_GET_FILEPATH1&nbsp;USING&nbsp;L_PATH&nbsp;Z_TEXT&nbsp;.<br />
<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*FORM&nbsp;FM_FILL_DATA1&nbsp;USING&nbsp;I_PATH<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_EXCEL&nbsp;TYPE&nbsp;TYT_EXCEL.<br />
*&nbsp;&nbsp;DATA:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_EXCEL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_EXCEL&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"application<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_WORKBOOK&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"workbook<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_SHEET&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"sheet<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_CELL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT.&nbsp;&nbsp;"单元格<br />
*&nbsp;&nbsp;L_PATH&nbsp;=&nbsp;I_PATH.<br />
***********&nbsp;&nbsp;STEP1:打开excel程序<br />
*&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;L_EXCEL&nbsp;'EXCEL.APPLICATION'.<br />
**&nbsp;0：不显示（后台运行），1：显示<br />
**&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'VISIBLE'&nbsp;=&nbsp;0.<br />
***********&nbsp;&nbsp;STEP2:读取workbook<br />
**&nbsp;创建具体excel文件对象<br />
**&nbsp;默认带有一个sheet<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'WORKBOOKS'&nbsp;=&nbsp;L_WORKBOOK&nbsp;.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'OPEN'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;L_PATH.<br />
***********&nbsp;&nbsp;STEP3:创建sheet<br />
**&nbsp;获取当前激活的sheet，并设定sheet名<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'SHEETS'&nbsp;=&nbsp;L_SHEET<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_SHEET&nbsp;'SELECT'.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_SHEET&nbsp;'ACTIVATE'.<br />
***********&nbsp;&nbsp;STEP4:数据填充<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;T_EXCEL&nbsp;INTO&nbsp;LW_EXCEL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'CELLS'&nbsp;=&nbsp;L_CELL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_EXCEL-ROW<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_EXCEL-COL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_CELL&nbsp;'VALUE'&nbsp;&nbsp;=&nbsp;LW_EXCEL-VALUE.<br />
*<br />
*<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*<br />
**&nbsp;不显示警告消息<br />
*&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'DISPLAYALERTS'&nbsp;=&nbsp;0.<br />
*<br />
***********&nbsp;&nbsp;STEP5:保存、关闭、退出<br />
**&nbsp;保存文件<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'SAVE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;L_PATH.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'CLOSE'.<br />
*<br />
*<br />
**&nbsp;关闭文件<br />
**&nbsp;退出EXCEL<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'QUIT'.<br />
*<br />
*WRITE&nbsp;'DONE'.<br />
*<br />
*FREE&nbsp;OBJECT&nbsp;L_CELL.<br />
*<br />
*FREE&nbsp;OBJECT&nbsp;L_WORKBOOK.<br />
*<br />
*FREE&nbsp;OBJECT&nbsp;L_EXCEL.<br />
*<br />
*<br />
*ENDFORM.<br />
<br />
   </div>
   <div class="code">
FORM FM_FILL_DATA1 USING I_PATH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_EXCEL&nbsp;TYPE&nbsp;TYT_EXCEL.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_EXCEL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_EXCEL&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"application<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_WORKBOOK&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"workbook<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_SHEET&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"sheet<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_CELL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT.&nbsp;&nbsp;"单元格<br />
&nbsp;&nbsp;L_PATH&nbsp;=&nbsp;I_PATH.<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP1:打开excel程序<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;L_EXCEL&nbsp;'EXCEL.APPLICATION'.<br />
   </div>
   <div class="codeComment">
*&nbsp;0：不显示（后台运行），1：显示<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'VISIBLE'&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP2:读取workbook<br />
*&nbsp;创建具体excel文件对象<br />
*&nbsp;默认带有一个sheet<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'WORKBOOKS'&nbsp;=&nbsp;L_WORKBOOK&nbsp;.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'OPEN'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;L_PATH.<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP3:创建sheet<br />
*&nbsp;获取当前激活的sheet，并设定sheet名<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'Sheets'&nbsp;=&nbsp;L_SHEET<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_SHEET&nbsp;'Select'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_SHEET&nbsp;'ACTIVATE'.<br />
<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP4:数据填充<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;T_EXCEL&nbsp;INTO&nbsp;LW_EXCEL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'CELLS'&nbsp;=&nbsp;L_CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_EXCEL-ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_EXCEL-COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_CELL&nbsp;'VALUE'&nbsp;&nbsp;=&nbsp;LW_EXCEL-VALUE.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;不显示警告消息<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'DISPLAYALERTS'&nbsp;=&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP5:保存、关闭、退出<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'ActiveSheet'&nbsp;=&nbsp;L_SHEET&nbsp;.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;L_SHEET&nbsp;.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;L_WORKBOOK&nbsp;.<br />
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'ActiveWorkbook'&nbsp;=&nbsp;L_WORKBOOK&nbsp;.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'SAVE'&nbsp;.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'VISIBLE'&nbsp;=&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'CLOSE'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'QUIT'.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT:&nbsp;L_SHEET,&nbsp;L_WORKBOOK,L_EXCEL&nbsp;.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;get_org_name<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;读取部门或班组等的名称<br />
*----------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;输入参数:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ZZUNI&nbsp;&nbsp;&nbsp;&nbsp;部门班组代码<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_BEGDA&nbsp;&nbsp;&nbsp;&nbsp;开始时间<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ENDDA&nbsp;&nbsp;&nbsp;&nbsp;结束时间<br />
*&&nbsp;&nbsp;输出参数：<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ORG_NAME&nbsp;部门班组名称<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_ORG_NAME USING P_ZZUNI P_BEGDA P_ENDDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_ORG_NAME&nbsp;LIKE&nbsp;P1000-SHORT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;P_ORG_NAME.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'HR_READ_FOREIGN_OBJECT_TEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_ZZUNI<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_BEGDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_ENDDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFERENCE_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_BEGDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHORT_TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_ORG_NAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTHING_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRONG_OBJECTTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MISSING_COSTCENTER_DATA&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MISSING_OBJECT_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
<br />
ENDFORM .                    "GET_ORG_name<br />
<br />
   </div>
   <div class="codeComment">
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;S01&nbsp;选择模板<br />
*&nbsp;T02&nbsp;注：请确认本月人力资源部已将部门和人员调整<br />
*&nbsp;T03&nbsp;并且总店经营管理部和&nbsp;连锁经营管理部部门代码没有变更<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;ZJJFPB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;奖金分配表<br />
*&nbsp;ZKQTJB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;考勤统计表<br />
*&nbsp;ZRCKHTJB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;日常考核统计表<br />
*&nbsp;ZXSTJB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;销售统计表<br />
*&nbsp;ZXXYGZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;信息员工资上传表格<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;00<br />
*001&nbsp;&nbsp;&nbsp;&1&2&3&4&5&6&7&8<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;ZCB<br />
*000&nbsp;&nbsp;&nbsp;&1&2&3&4<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
