<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZHRRP0174</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZHRRP0174</h2>
<h3> Description: 工资汇总表（合同制、合作方、退休返聘）</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
<br />
*&&nbsp;REPORT&nbsp;&nbsp;ZHRRP0174<br />
*&&nbsp;Application&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;HR-RP-0174<br />
*&&nbsp;Subject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;工资汇总表（合同制、合作方、退休返聘）<br />
*&&nbsp;Author&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUTHOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIPTION<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----------&nbsp;&nbsp;&nbsp;&nbsp;-----------------<br />
*&&nbsp;2016/07/21&nbsp;&nbsp;&nbsp;&nbsp;----------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initial<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
REPORT ZHRRP0174 USING DATABASE PNPCE MESSAGE-ID PN.<br />
<br />
TABLES: PERNR,HRP9101,T527X,PA0001,ZHRRP0160DKZT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZHRRP0160QXJB,ZHRRP0160RCKH,ZHRRP0160JJFPB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZHRRP0160XSTJB,ZHRRP0160KQTJB,ZHRRP0160XXGZ.<br />
<br />
INFOTYPES: 0000,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0006,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0009,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0016,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0021,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0022,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0041,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0105,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0185,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0529,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0533,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0534,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0536,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3211,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3527,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3529,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9002,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9003,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9004.<br />
<br />
include <a href ="zfi_common_form.html">ZFI_COMMON_FORM</a>.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&定义常量<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
CONSTANTS:<br />
&nbsp;&nbsp;CNS_OBJID&nbsp;TYPE&nbsp;W3OBJID&nbsp;VALUE&nbsp;'ZHRRP0010'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"模板名称<br />
<br />
DATA: IT_T517T   TYPE  T517T   OCCURS 0 WITH HEADER LINE.                                                   "文化程度<br />
DATA: IT_T005U   TYPE  T005U   OCCURS 0 WITH HEADER LINE.                                                   "地址<br />
DATA: IT_HRP1000 TYPE  HRP1000 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP9101 TYPE  HRP9101 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP1001 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100101 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100102 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100103 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
DATA: IT_HRP100104 TYPE  HRP1001 OCCURS 0 WITH HEADER LINE.                                                   "部门<br />
<br />
DATA: IT_DD07T   TYPE  DD07T   OCCURS 0 WITH HEADER LINE.                                                   "域内信息<br />
DATA: IT_T7CN6U  TYPE  T7CN6U  OCCURS 0 WITH HEADER LINE.                                                    "职位<br />
DATA: IT_T005T   TYPE  T005T   OCCURS 0 WITH HEADER LINE.                                                    "国籍<br />
DATA: IT_T502T   TYPE  T502T   OCCURS 0 WITH HEADER LINE.                                                    "婚姻状况<br />
DATA: IT_T505S   TYPE  T505S   OCCURS 0 WITH HEADER LINE.                                                    "名族<br />
DATA: IT_T7CN5R  TYPE  T7CN5R  OCCURS 0 WITH HEADER LINE.                                                    "政治面貌<br />
DATA: WA_T7CN5R  TYPE                    T7CN5R.                                                            "政治面貌<br />
DATA: IT_ZHRT_FWXZ TYPE ZHRT_FWXZ OCCURS 0 WITH HEADER LINE.                                                 "房屋性质<br />
DATA: IT_PA3529  TYPE STANDARD TABLE OF  PA3529.                                                            "教育经历<br />
DATA: WA_PA3529  TYPE                    PA3529.                                                            "教育经历<br />
DATA: IT_PA0022 TYPE STANDARD TABLE OF   PA0022.                                                            "HR主记录:信息类型0022 (教育)<br />
DATA: WA_PA0022 TYPE                     PA0022.                                                            "HR主记录:信息类型0022 (教育)<br />
DATA: IT_PA0001  TYPE STANDARD TABLE OF  PA0001.                                                            "人力资源主记录:<br />
DATA: WA_PA0001  TYPE                    PA0001.                                                            "人力资源主记录:<br />
DATA: IT_T528T  TYPE STANDARD TABLE OF   T528T.                                                            "职位文本<br />
DATA: WA_T528T  TYPE                     T528T.                                                            "职位文本<br />
DATA: IT_PA0006  TYPE STANDARD TABLE OF  PA0006.                                                            "户籍地址<br />
DATA: WA_PA0006  TYPE                    PA0006.                                                            "户籍地址<br />
DATA: IT_PA0105  TYPE STANDARD TABLE OF  PA0105.                                                            "人力资源主记录：信息类型0105（通信）<br />
DATA: WA_PA0105  TYPE                    PA0105.                                                            "人力资源主记录：信息类型0105（通信）<br />
DATA: IT_PA9005  TYPE STANDARD TABLE OF  PA9005.                                                            "信息类别 9005 培训<br />
DATA: WA_PA9005  TYPE                    PA9005.                                                            "信息类别 9005 培训<br />
DATA: IT_ZHRT_ZSMC  TYPE STANDARD TABLE OF  ZHRT_ZSMC.                                                      "信息类别  培训证书名称<br />
DATA: WA_ZHRT_ZSMC  TYPE                    ZHRT_ZSMC.                                                      "信息类别  培训证书名称<br />
DATA: IT_PA0023  TYPE STANDARD TABLE OF  PA0023.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)<br />
DATA: WA_PA0023  TYPE                    PA0023.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)<br />
DATA: IT_PA3528  TYPE STANDARD TABLE OF  PA3528.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)取部门和职务<br />
DATA: WA_PA3528  TYPE                    PA3528.                                                            "HR 主记录: 信息类型 0023 (其他/前雇主)取部门和职务<br />
DATA: IT_PA0021  TYPE STANDARD TABLE OF  PA0021.                                                            "HR 主记录: 信息类别 0021 (家庭)<br />
DATA: WA_PA0021  TYPE                    PA0021.                                                            "HR 主记录: 信息类别 0021 (家庭)<br />
DATA: IT_PA0528  TYPE STANDARD TABLE OF  PA0528.                                                            "人力资源主记录: 信息类型 0528 (家庭信息)<br />
DATA: WA_PA0528  TYPE                    PA0528.                                                            "人力资源主记录: 信息类型 0528 (家庭信息)<br />
DATA: IT_T591S   TYPE STANDARD TABLE OF   T591S.                                                            "家庭成员类型<br />
DATA: WA_T591S   TYPE                     T591S.                                                            "<br />
DATA: IT_PA9004   TYPE STANDARD TABLE OF  PA9004.                                                            "奖励惩罚<br />
DATA: WA_PA9004   TYPE                    PA9004.                                                            "<br />
DATA: WA1_PA9004   TYPE                   PA9004.                                                            "<br />
DATA: IT_PA0529   TYPE STANDARD TABLE OF  PA0529.                                                            "籍贯和个人特长<br />
DATA: WA_PA0529   TYPE                    PA0529.                                                            "籍贯和个人特长<br />
<br />
<br />
DATA: IT_T501T   TYPE STANDARD TABLE OF  T501T .                                                            "员工组描述<br />
DATA: WA_T501T   TYPE                    T501T .                                                            "<br />
DATA: IT_T503T   TYPE STANDARD TABLE OF  T503T.                                                            "员工子组描述<br />
DATA: WA_T503T   TYPE                    T503T.                                                            "<br />
<br />
<br />
DATA: IT_QXJB   TYPE STANDARD TABLE OF   ZHRRP0160QXJB .<br />
DATA: WA_QXJB   TYPE   ZHRRP0160QXJB .<br />
<br />
DATA: IT_QXJB1   TYPE STANDARD TABLE OF   ZHRRP0160QXJB .<br />
DATA: WA_QXJB1   TYPE   ZHRRP0160QXJB .<br />
<br />
<br />
<br />
DATA: IT_DKZT   TYPE STANDARD TABLE OF   ZHRRP0160DKZT .<br />
DATA: WA_DKZT   TYPE   ZHRRP0160DKZT .<br />
<br />
<br />
<br />
DATA: WA_HRP9101 TYPE HRP9101.<br />
DATA: WA_HRP1001 TYPE  HRP1001 .                                                   "部门<br />
DATA: WA_HRP100102 TYPE  HRP1001.                                                   "部门<br />
DATA: WA_HRP100103 TYPE  HRP1001.                                                   "部门<br />
DATA: WA_HRP100104 TYPE  HRP1001.                                                   "部门<br />
<br />
<br />
DATA: WA_DD07T TYPE DD07T.<br />
DATA: WA_DD07T_MD TYPE DD07T.<br />
DATA: WA_DD07T_ZD TYPE DD07T.<br />
DATA: WA_DD07T_FD TYPE DD07T.<br />
<br />
<br />
<br />
DATA: V_DARXX TYPE DATAR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V_DATXX&nbsp;TYPE&nbsp;DARDT.<br />
<br />
<br />
<br />
TYPES:BEGIN OF STRU_0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"序号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR1,&nbsp;"&nbsp;检查字段<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERNR&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0001-PERNR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0001-ORGEH,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NACHN&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0002-NACHN,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员姓<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VORNA&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0002-VORNA,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员名<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHORT&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;HRP1000-STEXT,&nbsp;&nbsp;&nbsp;"人员部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT1&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;HRP1000-SHORT,&nbsp;&nbsp;&nbsp;"一级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT2&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;HRP1000-SHORT,&nbsp;&nbsp;&nbsp;"二级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT3&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;HRP1000-SHORT,&nbsp;&nbsp;&nbsp;"三级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T527X&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;T527X-ORGTX,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员部门文本<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERSG&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0001-PERSG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"员工组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YGZMS&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;T501T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERSK&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0001-PERSK,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"员工子组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YGZZMS&nbsp;&nbsp;&nbsp;TYPE&nbsp;T503T-PTEXT,&nbsp;&nbsp;&nbsp;&nbsp;"员工子组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZCJDM&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;P0001-ZCJDM,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GZYF&nbsp;&nbsp;TYPE&nbsp;ZHRRP0160DKZT-EX_GZYF,&nbsp;&nbsp;"工资月份<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZFRQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR10,&nbsp;&nbsp;"支付日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_KHRQ&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160RCKH-EX_KHRQ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_KHYY&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160RCKH-EX_KHYY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_KHJE&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160RCKH-EX_KHJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JJJE&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160JJFPB-EX_JJJE,&nbsp;&nbsp;""奖金金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JSJE&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160JJFPB-EX_JSJE,&nbsp;&nbsp;""加时金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXXJH&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GXXJH,&nbsp;""贵金属销售计划<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GSJWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GSJWC,&nbsp;""贵金属实际完成<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GKZJH&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GKZJH,&nbsp;""贵金属克重计划<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GKZWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GKZWC,&nbsp;""贵金属克重完成<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXXJS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GXXJS,&nbsp;""贵金属件数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XJEWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_XJEWC,&nbsp;""镶嵌金额计划<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XSJWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_XSJWC,&nbsp;""镶嵌实际完成<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XXXJS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_XXXJS,&nbsp;""镶嵌件数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_FJHCS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_FJHCS,&nbsp;""服务计划次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_FWCCS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_FWCCS,&nbsp;""服务完成次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SSKJE&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_SSKJE,&nbsp;""收银收款金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SSKCS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_SSKCS,&nbsp;""收银收款次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CQ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CQ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;出勤<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_GX&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;公休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JX&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;节休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_NJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_NJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;年假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_ZX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_ZX&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;增休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JH&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JH&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;"节后补休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_BJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;病假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_SJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;事假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;产假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_HJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_HJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;婚假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SJ1&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_SJ1&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;丧假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_TQJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_TQJ&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;探亲假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XXJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_XXJ&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;学习假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_QTJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_QTJ&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;其他假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_PDCS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_PDCS&nbsp;,&nbsp;""&nbsp;&nbsp;盘点次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JRJB&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JRJB&nbsp;,&nbsp;""&nbsp;&nbsp;节日加班天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_QTJB&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_QTJB&nbsp;,&nbsp;""&nbsp;&nbsp;其他加班天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_YBTS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_YBTS&nbsp;,&nbsp;""&nbsp;&nbsp;夜班天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CCTS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CCTS&nbsp;,&nbsp;""&nbsp;&nbsp;出差天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_WFTS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_WFTS&nbsp;,&nbsp;""&nbsp;&nbsp;外埠天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_RCKH&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_RCKH&nbsp;,&nbsp;""&nbsp;&nbsp;日常考核扣款金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BZ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_BZ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;备注<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JTBZ&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JTBZ&nbsp;,&nbsp;""&nbsp;&nbsp;交通补助<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CGX&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CGX&nbsp;&nbsp;,&nbsp;""&nbsp;存公休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CNJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CNJ&nbsp;&nbsp;,&nbsp;""&nbsp;存年假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_WXZX&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_WXZX&nbsp;,&nbsp;""&nbsp;&nbsp;当季未休增休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTEXT&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;T503T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;501TEXT&nbsp;&nbsp;TYPE&nbsp;T501T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROWCOLOR&nbsp;TYPE&nbsp;CHAR4,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010.<br />
<br />
<br />
DATA: IT_TABLE  TYPE  STANDARD TABLE OF STRU_0010.<br />
DATA: WA_TABLE  TYPE                    STRU_0010.<br />
<br />
   </div>
   <div class="codeComment">
*最终输出ALV<br />
   </div>
   <div class="code">
DATA: IT_TABLE3  TYPE  STANDARD TABLE OF STRU_0010.<br />
DATA: WA_TABLE3  TYPE                    STRU_0010.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*ALV显示使用到的共享池<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
TYPE-POOLS: SLIS.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*&nbsp;定义ALV显示字段的内表及工作区<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
DATA: IT_FIELDCAT TYPE SLIS_T_FIELDCAT_ALV.<br />
DATA: WA_FIELDCAT TYPE SLIS_FIELDCAT_ALV.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*&nbsp;定义ALV显示格式的工作区<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
DATA: WA_LAYOUT     TYPE SLIS_LAYOUT_ALV.<br />
<br />
DATA: GD_REPID LIKE SY-REPID,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REF_GRID&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
   </div>
   <div class="codeComment">
*-----------------------------------------------*<br />
*定义数据结构&nbsp;&nbsp;20160725<br />
*-----------------------------------------------*<br />
   </div>
   <div class="code">
TYPES: BEGIN OF STRUCT ,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"序号<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERNR&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-PERNR,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员代码<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NACHN&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0002-NACHN,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员姓<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VORNA&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0002-VORNA,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员名<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHORT&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;HRP1000-STEXT,&nbsp;&nbsp;&nbsp;"人员部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-ORGEH,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZORG1&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-ORGEH,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZORG2&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-ORGEH,&nbsp;"部门2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZORG3&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-ORGEH,&nbsp;"部门3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT1&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;HRP1000-SHORT,&nbsp;&nbsp;&nbsp;"一级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT2&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;HRP1000-SHORT,&nbsp;&nbsp;&nbsp;"二级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZTXT3&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;HRP1000-SHORT,&nbsp;&nbsp;&nbsp;"三级部门<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T527X&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;T527X-ORGTX,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员部门文本<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERSG&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-PERSG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"员工组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YGZMS&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;T501T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERSK&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-PERSK,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"员工子组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YGZZMS&nbsp;&nbsp;&nbsp;LIKE&nbsp;T503T-PTEXT,&nbsp;&nbsp;&nbsp;&nbsp;"员工子组<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZCJDM&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;P0001-ZCJDM,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GZYF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;ZHRRP0160DKZT-EX_GZYF,&nbsp;&nbsp;"工资月份<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GZYF&nbsp;&nbsp;TYPE&nbsp;ZHRRP0160DKZT-EX_GZYF,&nbsp;&nbsp;"工资月份<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZFRQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR10,&nbsp;&nbsp;"支付日期<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_KHRQ&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160RCKH-EX_KHRQ,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_KHYY&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160RCKH-EX_KHYY,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_KHJE&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160RCKH-EX_KHJE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JJJE&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160JJFPB-EX_JJJE,&nbsp;&nbsp;""奖金金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JSJE&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160JJFPB-EX_JSJE,&nbsp;&nbsp;""加时金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXXJH&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GXXJH,&nbsp;""贵金属销售计划<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GSJWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GSJWC,&nbsp;""贵金属实际完成<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GKZJH&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GKZJH,&nbsp;""贵金属克重计划<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GKZWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GKZWC,&nbsp;""贵金属克重完成<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GXXJS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_GXXJS,&nbsp;""贵金属件数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XJEWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_XJEWC,&nbsp;""镶嵌金额计划<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XSJWC&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_XSJWC,&nbsp;""镶嵌实际完成<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XXXJS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_XXXJS,&nbsp;""镶嵌件数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_FJHCS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_FJHCS,&nbsp;""服务计划次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_FWCCS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_FWCCS,&nbsp;""服务完成次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SSKJE&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_SSKJE,&nbsp;""收银收款金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SSKCS&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160XSTJB-EX_SSKCS,&nbsp;""收银收款次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CQ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CQ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;出勤<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_GX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_GX&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;公休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JX&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;节休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_NJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_NJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;年假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_ZX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_ZX&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;增休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JH&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JH&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;"节后补休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_BJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;病假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_SJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;事假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;产假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_HJ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_HJ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;婚假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_SJ1&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_SJ1&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;丧假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_TQJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_TQJ&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;探亲假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_XXJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_XXJ&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;学习假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_QTJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_QTJ&nbsp;,&nbsp;&nbsp;""&nbsp;&nbsp;其他假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_PDCS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_PDCS&nbsp;,&nbsp;""&nbsp;&nbsp;盘点次数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JRJB&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JRJB&nbsp;,&nbsp;""&nbsp;&nbsp;节日加班天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_QTJB&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_QTJB&nbsp;,&nbsp;""&nbsp;&nbsp;其他加班天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_YBTS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_YBTS&nbsp;,&nbsp;""&nbsp;&nbsp;夜班天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CCTS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CCTS&nbsp;,&nbsp;""&nbsp;&nbsp;出差天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_WFTS&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_WFTS&nbsp;,&nbsp;""&nbsp;&nbsp;外埠天数<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_RCKH&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_RCKH&nbsp;,&nbsp;""&nbsp;&nbsp;日常考核扣款金额<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_BZ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_BZ&nbsp;,&nbsp;&nbsp;&nbsp;""&nbsp;&nbsp;备注<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_JTBZ&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_JTBZ&nbsp;,&nbsp;""&nbsp;&nbsp;交通补助<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CGX&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CGX&nbsp;&nbsp;,&nbsp;""&nbsp;存公休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_CNJ&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_CNJ&nbsp;&nbsp;,&nbsp;""&nbsp;存年假<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX_WXZX&nbsp;&nbsp;TYPE&nbsp;&nbsp;ZHRRP0160KQTJB-EX_WXZX&nbsp;,&nbsp;""&nbsp;&nbsp;当季未休增休<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTEXT&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;T503T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;501TEXT&nbsp;&nbsp;TYPE&nbsp;T501T-PTEXT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROWCOLOR&nbsp;TYPE&nbsp;CHAR4,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRUCT.<br />
<br />
DATA: IT_STRUCT TYPE STANDARD TABLE OF  STRUCT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRUCT.<br />
<br />
DATA: IT_STRUCT1 TYPE STANDARD TABLE OF  STRU_0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT1&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_0010.<br />
<br />
<br />
DATA: IT_TABLE1  TYPE  STANDARD TABLE OF ZHRRP0160QXJB.<br />
DATA: IT_TABLE2  TYPE  STANDARD TABLE OF ZHRRP0160QXJB.<br />
DATA: WA_TABLE1  TYPE                    ZHRRP0160QXJB.<br />
<br />
<br />
DATA: ZRYDM       TYPE CHAR8 .<br />
<br />
DATA: INTI  TYPE I VALUE 0.<br />
<br />
DATA: BEGIN TYPE P0001-ENDDA.<br />
DATA: END   TYPE P0001-ENDDA.<br />
DATA: BEG TYPE P0001-ENDDA.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;修改20160825<br />
   </div>
   <div class="code">
DATA: BEGDATE TYPE P0001-ENDDA. "取上月<br />
DATA: ENDDATE TYPE P0001-ENDDA.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;修改20160829<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;WA_HRP1001_3&nbsp;TYPE&nbsp;HRP1001.<br />
&nbsp;&nbsp;DATA:&nbsp;WA_HRP9101_3&nbsp;TYPE&nbsp;HRP9101.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;WA_HRP1001_2&nbsp;TYPE&nbsp;HRP1001.<br />
&nbsp;&nbsp;DATA:&nbsp;WA_HRP9101_2&nbsp;TYPE&nbsp;HRP9101.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;WA_HRP1001_1&nbsp;TYPE&nbsp;HRP1001.<br />
&nbsp;&nbsp;DATA:&nbsp;WA_HRP9101_1&nbsp;TYPE&nbsp;HRP9101.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&初始化<br />
*&---------------------------------------------------------------------*<br />
<br />
<br />
   </div>
   <div class="code">
SELECTION-SCREEN BEGIN OF BLOCK TIME1 WITH FRAME TITLE TEXT-S01.<br />
<br />
PARAMETERS: ZFXXY AS CHECKBOX .<br />
SELECTION-SCREEN COMMENT /1(50) TEXT-T02 .<br />
SELECTION-SCREEN COMMENT /2(50) TEXT-T03 .<br />
<br />
SELECTION-SCREEN END OF BLOCK TIME1.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&初始化<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
INITIALIZATION.<br />
<br />
   </div>
   <div class="codeComment">
*----------------------------------------------*<br />
*程序开始<br />
*----------------------------------------------*<br />
   </div>
   <div class="code">
START-OF-SELECTION.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;SY-UNAME&nbsp;&lt;&gt;&nbsp;'10734'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_BF.<br />
*&nbsp;&nbsp;ELSE&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_10734.<br />
*&nbsp;&nbsp;ENDIF.<br />
*<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_BM.<br />
<br />
&nbsp;&nbsp;GET&nbsp;PERNR.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;INTI&nbsp;=&nbsp;INTI&nbsp;+&nbsp;1.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_DATA.<br />
<br />
&nbsp;&nbsp;END-OF-SELECTION.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;POST_DATA.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZFXXY&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;IT_STRUCT&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_170.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZFXXY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;ZFXXY&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DATA_170.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_SHOW_ZFXXY.<br />
*<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;PYBEGDA&nbsp;&lt;&gt;&nbsp;'X'.<br />
<br />
<br />
&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'请输入月份'&nbsp;.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
FORM GET_DATA_10734.<br />
<br />
&nbsp;&nbsp;BEGIN&nbsp;=&nbsp;PN-BEGDA+0(6)&nbsp;&&&nbsp;'01'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_DAY_OF_MONTH&nbsp;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN_NO_DATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;END&nbsp;=&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'+'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;BEG.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CONCATENATE&nbsp;'000'&nbsp;SY-UNAME&nbsp;INTO&nbsp;ZRYDM&nbsp;.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_TABLE1,IT_HRP1001,IT_HRP100101.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_TABLE1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;SY-UNAME.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;WA_TABLE1&nbsp;TO&nbsp;IT_TABLE1.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_DKZT&nbsp;FROM&nbsp;ZHRRP0160DKZT&nbsp;WHERE&nbsp;EX_GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;AND&nbsp;EX_GZZT&nbsp;&lt;&gt;&nbsp;'0'&nbsp;AND&nbsp;ORGEH&nbsp;=&nbsp;'50000000'.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*取个人数据<br />
   </div>
   <div class="code">
FORM GET_DATA_BM.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T517T&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T517T&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"学位<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T005U&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T005U&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;LAND1&nbsp;=&nbsp;'CN'&nbsp;AND&nbsp;SPRAS&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"省份地区<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_HRP1000&nbsp;&nbsp;FROM&nbsp;&nbsp;HRP1000&nbsp;&nbsp;WHERE&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;AND&nbsp;ISTAT&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_HRP9101&nbsp;&nbsp;FROM&nbsp;&nbsp;HRP9101.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"级别<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;&nbsp;FROM&nbsp;&nbsp;HRP1001&nbsp;&nbsp;WHERE&nbsp;SUBTY&nbsp;=&nbsp;'A002'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T7CN6U&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T7CN6U&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"职位<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T005T&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T005T&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRAS&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"国籍<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T502T&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T502T&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"婚姻状况<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T505S&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T505S&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRSL&nbsp;=&nbsp;'1'&nbsp;AND&nbsp;MOLGA&nbsp;=&nbsp;'28'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"民族<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T7CN5R&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;T7CN5R&nbsp;&nbsp;&nbsp;WHERE&nbsp;LANGU&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"政治面貌<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_ZHRT_FWXZ&nbsp;FROM&nbsp;ZHRT_FWXZ.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"房屋性质<br />
<br />
ENDFORM.<br />
<br />
<br />
FORM GET_DATA_BF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:BEG.<br />
&nbsp;&nbsp;BEGIN&nbsp;=&nbsp;PN-BEGDA+0(6)&nbsp;&&&nbsp;'01'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_DAY_OF_MONTH&nbsp;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN_NO_DATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;END&nbsp;=&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'+'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;BEG.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;CONCATENATE&nbsp;'000'&nbsp;SY-UNAME&nbsp;INTO&nbsp;ZRYDM&nbsp;.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_TABLE1,IT_HRP1001,IT_HRP100101.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_TABLE1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;WHERE&nbsp;PERNR&nbsp;=&nbsp;SY-UNAME.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;WA_TABLE1&nbsp;TO&nbsp;IT_TABLE1.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_TABLE1.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_TABLE1&nbsp;FROM&nbsp;ZHRRP0160QXJB&nbsp;.<br />
&nbsp;&nbsp;APPEND&nbsp;WA_TABLE1&nbsp;TO&nbsp;IT_TABLE2.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP1001&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;ZRYDM&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'S'&nbsp;ORDER&nbsp;BY&nbsp;BEGDA&nbsp;DESCENDING.&nbsp;&nbsp;"通过人员证章号&nbsp;取&nbsp;部门人员代码<br />
&nbsp;&nbsp;ENDSELECT.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;IT_HRP1001&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1001&nbsp;INTO&nbsp;WA_HRP1001&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;IT_HRP100101&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;SOBID&nbsp;=&nbsp;IT_HRP1001-OBJID&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'&nbsp;&nbsp;.&nbsp;&nbsp;"部门人员代码&nbsp;取&nbsp;部门编号<br />
&nbsp;&nbsp;ENDSELECT.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;WA_DKZT&nbsp;FROM&nbsp;ZHRRP0160DKZT&nbsp;WHERE&nbsp;EX_GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;AND&nbsp;EX_GZZT&nbsp;&lt;&gt;&nbsp;'0'&nbsp;AND&nbsp;ORGEH&nbsp;=&nbsp;IT_HRP100101-OBJID.<br />
<br />
<br />
ENDFORM.<br />
<br />
FORM GET_DATA.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;Z0001&nbsp;TYPE&nbsp;I.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;P0001&nbsp;WHERE&nbsp;PERSG&nbsp;=&nbsp;'1'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;STRUCT-PERNR&nbsp;=&nbsp;P0001-PERNR.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;Z0001&nbsp;=&nbsp;1.<br />
<br />
   </div>
   <div class="code">
DATA:<br />
BBHZ1 TYPE  ZBBHZ,<br />
BBHZ2 TYPE  ZBBHZ,<br />
BBHZ3 TYPE  ZBBHZ,<br />
ORGEH1  TYPE  ORGEH,<br />
ORGEH2  TYPE  ORGEH,<br />
ORGEH3  TYPE  ORGEH.<br />
<br />
CLEAR:BBHZ1,BBHZ2,BBHZ3,ORGEH1,ORGEH2,ORGEH3,WA_HRP1001,WA_HRP1001_1,WA_HRP1001_2,WA_HRP1001_3.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:BEG.<br />
&nbsp;&nbsp;BEGIN&nbsp;=&nbsp;PN-BEGDA+0(6)&nbsp;&&&nbsp;'01'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_DAY_OF_MONTH&nbsp;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN_NO_DATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;END&nbsp;=&nbsp;END.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'+'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;BEG.<br />
   </div>
   <div class="codeComment">
*&nbsp;修改20160825&nbsp;取上月日期<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'-'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;BEGDATE.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BEGDATE<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_DAY_OF_MONTH&nbsp;=&nbsp;ENDDATE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAY_IN_NO_DATE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;ENDDATE&nbsp;=&nbsp;ENDDATE.<br />
<br />
<br />
<br />
&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;P0536&nbsp;SPACE&nbsp;BEGIN&nbsp;END.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CHECK&nbsp;Z0001&nbsp;=&nbsp;1.<br />
*宏<br />
   </div>
   <div class="code">
&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;P0001&nbsp;SPACE&nbsp;BEGIN&nbsp;END.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"用于取部门<br />
<br />
&nbsp;&nbsp;RP-PROVIDE-FROM-LAST&nbsp;P0002&nbsp;SPACE&nbsp;BEGIN&nbsp;END.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"用于取部门<br />
<br />
&nbsp;&nbsp;WA_STRUCT-PERNR&nbsp;=&nbsp;PERNR-PERNR.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"人员代码<br />
<br />
&nbsp;&nbsp;WA_STRUCT-NACHN&nbsp;=&nbsp;P0002-NACHN.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"姓<br />
&nbsp;&nbsp;WA_STRUCT-VORNA&nbsp;=&nbsp;P0002-VORNA.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"名<br />
&nbsp;&nbsp;WA_STRUCT-VORNA&nbsp;=&nbsp;WA_STRUCT-NACHN&nbsp;&&&nbsp;WA_STRUCT-VORNA.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"姓名<br />
&nbsp;&nbsp;WA_STRUCT-PERSG&nbsp;=&nbsp;P0001-PERSG.<br />
&nbsp;&nbsp;WA_STRUCT-PERSK&nbsp;=&nbsp;P0001-PERSK.<br />
&nbsp;&nbsp;WA_STRUCT-ZCJDM&nbsp;=&nbsp;P0001-ZCJDM.<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T501T&nbsp;FROM&nbsp;T501T&nbsp;WHERE&nbsp;&nbsp;SPRSL&nbsp;=&nbsp;1&nbsp;&nbsp;AND&nbsp;PERSG&nbsp;=&nbsp;P0001-PERSG.&nbsp;&nbsp;"员工组描述<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_T501T&nbsp;INTO&nbsp;WA_T501T.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-YGZMS&nbsp;=&nbsp;WA_T501T-PTEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;INTO&nbsp;TABLE&nbsp;IT_T503T&nbsp;FROM&nbsp;T503T&nbsp;WHERE&nbsp;&nbsp;SPRSL&nbsp;=&nbsp;1&nbsp;&nbsp;AND&nbsp;PERSK&nbsp;=&nbsp;P0001-PERSK.&nbsp;"员工子组描述<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_T503T&nbsp;INTO&nbsp;WA_T503T.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-YGZZMS&nbsp;=&nbsp;WA_T503T-PTEXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_STRUCT-YGZZMS&nbsp;=&nbsp;WA_STRUCT-YGZMS&nbsp;&&&nbsp;'--'&nbsp;&&&nbsp;WA_STRUCT-YGZZMS.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;IT_HRP1000&nbsp;WITH&nbsp;KEY&nbsp;OBJID&nbsp;=&nbsp;P0001-ORGEH.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"部门<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-ORGEH&nbsp;=&nbsp;P0001-ORGEH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-SHORT&nbsp;=&nbsp;IT_HRP1000-STEXT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;CHECK&nbsp;P0000-STAT2&nbsp;=&nbsp;'3'&nbsp;AND&nbsp;P0001-PERSG&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"满足这两个条件的人员代码<br />
<br />
<br />
*&nbsp;CALL&nbsp;FUNCTION&nbsp;'ZHRIF0020_FM'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IM_PERNR&nbsp;=&nbsp;PERNR-PERNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBHZ1&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBHZ2&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBHZ3&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH1&nbsp;&nbsp;&nbsp;=&nbsp;WA_STRUCT-ZORG1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH2&nbsp;&nbsp;&nbsp;=&nbsp;WA_STRUCT-ZORG2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH3&nbsp;&nbsp;&nbsp;=&nbsp;WA_STRUCT-ZORG3.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP1001<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP1001&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;P0001-ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;'A002'.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP9101<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP9101&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;P0001-ORGEH.<br />
<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;WA_HRP9101-ZBBHZ&nbsp;=&nbsp;'3'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;BBHZ3&nbsp;=&nbsp;WA_HRP9101-ZBBHZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ORGEH3&nbsp;=&nbsp;P0001-ORGEH.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP1001_2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP1001&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;P0001-ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;'A002'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP9101_2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP9101&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;WA_HRP1001_2-SOBID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;BBHZ2&nbsp;=&nbsp;WA_HRP9101_2-ZBBHZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ORGEH2&nbsp;=&nbsp;WA_HRP1001_2-SOBID.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP1001_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP1001&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;WA_HRP1001_2-SOBID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;'A002'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP9101_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP9101&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;WA_HRP1001_1-SOBID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_HRP9101_1-ZBBHZ&nbsp;=&nbsp;'1'&nbsp;OR&nbsp;WA_HRP9101_1&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBHZ1&nbsp;=&nbsp;WA_HRP9101_1-ZBBHZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH1&nbsp;=&nbsp;WA_HRP1001_1-SOBID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;&nbsp;&nbsp;WA_HRP9101-ZBBHZ&nbsp;=&nbsp;'2'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;BBHZ2&nbsp;=&nbsp;WA_HRP9101-ZBBHZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ORGEH2&nbsp;=&nbsp;P0001-ORGEH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP1001_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP1001&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;P0001-ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OTYPE&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SUBTY&nbsp;=&nbsp;'A002'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;WA_HRP9101_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;HRP9101&nbsp;&nbsp;WHERE&nbsp;BEGDA&nbsp;&lt;=&nbsp;BEGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ENDDA&nbsp;&gt;=&nbsp;END<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;OBJID&nbsp;=&nbsp;WA_HRP1001_1-SOBID.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_HRP9101_1-ZBBHZ&nbsp;=&nbsp;'1'&nbsp;OR&nbsp;WA_HRP9101_1&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBHZ1&nbsp;=&nbsp;WA_HRP9101_1-ZBBHZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORGEH1&nbsp;=&nbsp;WA_HRP1001_1-SOBID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;&nbsp;&nbsp;WA_HRP9101-ZBBHZ&nbsp;=&nbsp;'1'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;BBHZ1&nbsp;=&nbsp;WA_HRP9101-ZBBHZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ORGEH1&nbsp;=&nbsp;P0001-ORGEH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_ORG_NAME&nbsp;USING&nbsp;WA_STRUCT-ZORG1&nbsp;BEGIN&nbsp;END&nbsp;CHANGING&nbsp;WA_STRUCT-ZTXT1.<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_ORG_NAME&nbsp;USING&nbsp;WA_STRUCT-ZORG2&nbsp;BEGIN&nbsp;END&nbsp;CHANGING&nbsp;WA_STRUCT-ZTXT2.<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_ORG_NAME&nbsp;USING&nbsp;WA_STRUCT-ZORG3&nbsp;BEGIN&nbsp;END&nbsp;CHANGING&nbsp;WA_STRUCT-ZTXT3.<br />
<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;WA_STRUCT&nbsp;TO&nbsp;IT_STRUCT&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"插入内表<br />
&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT.<br />
<br />
ENDFORM.<br />
<br />
FORM GET_ORG_NAME USING P_ZZUNI P_BEGDA P_ENDDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_ORG_NAME&nbsp;LIKE&nbsp;P1000-SHORT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;P_ORG_NAME.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'HR_READ_FOREIGN_OBJECT_TEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'O'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_ZZUNI<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_BEGDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_ENDDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFERENCE_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_BEGDA<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHORT_TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_ORG_NAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTHING_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRONG_OBJECTTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MISSING_COSTCENTER_DATA&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MISSING_OBJECT_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
<br />
ENDFORM .                    "GET_ORG_name<br />
<br />
FORM POST_DATA.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;L_INDEX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;NUMC4.<br />
&nbsp;&nbsp;CLEAR&nbsp;L_INDEX&nbsp;.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZFXXY&nbsp;=&nbsp;'X'.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'41'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'42'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'20'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'22'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'70'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'71'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'80'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'50'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'30'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'31'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'32'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'33'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;IT_STRUCT&nbsp;&nbsp;WHERE&nbsp;PERSK&nbsp;=&nbsp;'34'.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT&nbsp;&nbsp;FROM&nbsp;WA_STRUCT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&ALV处理函数<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_SHOW_ZFXXY.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;&nbsp;&nbsp;&nbsp;'序号'.<br />
   </div>
   <div class="codeComment">
*20160725-----------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ROWCOLOR'&nbsp;&nbsp;&nbsp;&nbsp;'检查标识'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ORGEH'&nbsp;'部门代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT1'&nbsp;'一级部门'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT2'&nbsp;'二级部门'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZTXT3'&nbsp;'三级部门'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GZYF'&nbsp;'发薪年月'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZFRQ'&nbsp;'支付日期'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'YGZMS'&nbsp;&nbsp;'员工组描述'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'YGZZMS'&nbsp;&nbsp;'员工子组描述'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CQ'&nbsp;'出勤'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GX'&nbsp;'公休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JX'&nbsp;'节休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_NJ'&nbsp;'年假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_ZX'&nbsp;'增休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JH'&nbsp;'节后补休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BJ'&nbsp;'病假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_SJ'&nbsp;'事假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CJ'&nbsp;'产假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_HJ'&nbsp;'婚假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_SJ1'&nbsp;'丧假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_TQJ'&nbsp;'探亲假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_XXJ'&nbsp;'学习假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_QTJ'&nbsp;'其他假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_PDCS'&nbsp;'盘点次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JRJB'&nbsp;'节日加班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_QTJB'&nbsp;'其他加班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_YBTS'&nbsp;'夜班天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CCTS'&nbsp;'出差天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_WFTS'&nbsp;'外埠天数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_RCKH'&nbsp;'日常考核扣款金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GXXJH'&nbsp;'贵金属销售计划'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GSJWC'&nbsp;'贵金属实际完成'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GKZJH'&nbsp;'贵金属克重计划'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GKZWC'&nbsp;'贵金属克重完成'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GXXJS'&nbsp;'贵金属件数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_XJEWC'&nbsp;'镶嵌金额计划'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_XSJWC'&nbsp;'镶嵌实际完成'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_XXXJS'&nbsp;'镶嵌件数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FJHCS'&nbsp;'服务计划次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FWCCS'&nbsp;'服务完成次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_SSKJE'&nbsp;'收银收款金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_SSKCS'&nbsp;'收银收款次数'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JTBZ'&nbsp;'交通补助'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CGX'&nbsp;&nbsp;'存公休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CNJ'&nbsp;&nbsp;'存年假'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_WXZX'&nbsp;'当季未休增休'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JJJE'&nbsp;'奖金金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JSJE'&nbsp;'加时金额'.<br />
&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BZ'&nbsp;&nbsp;&nbsp;'备注'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'ROWCOLOR'.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
*&nbsp;20160725-------------------------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_STRUCT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
ENDFORM.<br />
<br />
FORM ZALV_SHOW_TOTAL USING    FIELDNAME  TYPE CHAR30<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELTEXT&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR30.<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
&nbsp;&nbsp;WA_FIELDCAT-TABNAME&nbsp;&nbsp;&nbsp;=&nbsp;'STRUCT'.<br />
&nbsp;&nbsp;WA_FIELDCAT-FIELDNAME&nbsp;=&nbsp;&nbsp;FIELDNAME.<br />
&nbsp;&nbsp;WA_FIELDCAT-SELTEXT_L&nbsp;=&nbsp;SELTEXT.<br />
&nbsp;&nbsp;APPEND&nbsp;WA_FIELDCAT&nbsp;TO&nbsp;IT_FIELDCAT.<br />
<br />
ENDFORM.<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*FORM&nbsp;ALV_SHOW_ZXXY.<br />
*<br />
*<br />
*&nbsp;&nbsp;CLEAR:&nbsp;IT_FIELDCAT[].<br />
*<br />
*&nbsp;&nbsp;CLEAR:&nbsp;WA_FIELDCAT.<br />
*<br />
*<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'XH'&nbsp;&nbsp;&nbsp;&nbsp;'序号'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZORG1'&nbsp;'部门代码'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'部门名称'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'一级部门'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'二级部门'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'SHORT'&nbsp;'三级部门'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GZYF'&nbsp;'发薪年月'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERNR'&nbsp;'人员代码'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'VORNA'&nbsp;'人员姓名'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERSG'&nbsp;&nbsp;'员工组描述'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'PERSK'&nbsp;&nbsp;'员工子组描述'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'ZCJDM'&nbsp;'厂家代码'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCZS'&nbsp;'本厂-钻石'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCZS2'&nbsp;'本厂-钻石2'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCZB'&nbsp;'本厂-珠宝'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCZB2'&nbsp;'本厂-珠宝2'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCFC'&nbsp;'本厂-翡翠白玉'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCFC2'&nbsp;'本厂-翡翠白玉2'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCKJ'&nbsp;'本厂-K金'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCYS'&nbsp;'本厂-银饰'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BCHJ'&nbsp;'本厂-销售合计'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCZS'&nbsp;'非本厂-钻石'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCZS2'&nbsp;'非本厂-钻石2'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCZB'&nbsp;'非本厂-珠宝'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCZB2'&nbsp;'非本厂-珠宝2'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCFC'&nbsp;'非本厂-翡翠白玉'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCFC2'&nbsp;'非本厂-翡翠白玉2'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCKJ'&nbsp;'非本厂-K金'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCYS'&nbsp;'非本厂-银饰'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FBCHJ'&nbsp;'非本厂-销售合计'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CQTS'&nbsp;'出勤天数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_FB'&nbsp;'饭补'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_GX'&nbsp;'公休'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JX'&nbsp;'节休'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_NJ'&nbsp;'年假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_ZX'&nbsp;'增休'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JH'&nbsp;'节后补休'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BJ'&nbsp;'病假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_SJ'&nbsp;'事假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CJ'&nbsp;'产假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_HJ'&nbsp;'婚假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_SJ1'&nbsp;'丧假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_TQJ'&nbsp;'探亲假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_XXJ'&nbsp;'学习假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_QTJ'&nbsp;'其他假'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_PDCS'&nbsp;'盘点次数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JRJB'&nbsp;'节日加班天数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_QTJB'&nbsp;'其他加班天数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_YBTS'&nbsp;'夜班天数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_CCTS'&nbsp;'出差天数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_WFTS'&nbsp;'外埠天数'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_RCKH'&nbsp;'日常考核扣款金额'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_BZ'&nbsp;'备注'.<br />
*&nbsp;&nbsp;PERFORM&nbsp;ZALV_SHOW_TOTAL&nbsp;USING&nbsp;&nbsp;&nbsp;'EX_JSJE'&nbsp;'加时金额'.<br />
*<br />
*&nbsp;&nbsp;WA_LAYOUT-COLWIDTH_OPTIMIZE&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;WA_LAYOUT-ZEBRA&nbsp;=&nbsp;'&nbsp;'.<br />
*&nbsp;&nbsp;WA_LAYOUT-NO_INPUT&nbsp;=&nbsp;'X'.<br />
*<br />
*<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;=&nbsp;SY-REPID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;WA_LAYOUT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_FIELDCAT[]<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;=&nbsp;'PF_STATUS_SET'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_TABLE3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
*ENDFORM.<br />
<br />
<br />
<br />
<br />
*&---------------------------------------------------------------------*<br />
*&ALV工具栏处理事件<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM USER_COMMAND USING R_UCOMM LIKE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS_SELFIELD&nbsp;TYPE&nbsp;SLIS_SELFIELD.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;DIRPATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;Z_TEXT&nbsp;&nbsp;TYPE&nbsp;CHAR100.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;REF_GRID&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GET_GLOBALS_FROM_SLVC_FULLSCR'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_GRID&nbsp;=&nbsp;REF_GRID.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;NOT&nbsp;REF_GRID&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;REF_GRID-&gt;CHECK_CHANGED_DATA&nbsp;.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;CASE&nbsp;R_UCOMM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DOWN_DATA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;RS_SELFIELD-REFRESH&nbsp;=&nbsp;'X'.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&工具栏状态<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM PF_STATUS_SET USING P_EXTAB TYPE SLIS_T_EXTAB..<br />
&nbsp;&nbsp;"Set&nbsp;the&nbsp;Button&nbsp;using&nbsp;the&nbsp;staus<br />
&nbsp;&nbsp;"Copy&nbsp;the&nbsp;Standard&nbsp;status&nbsp;from&nbsp;the&nbsp;program&nbsp;SAPLKKBL&nbsp;status<br />
&nbsp;&nbsp;"&nbsp;STANDARD&nbsp;using&nbsp;SE41,&nbsp;and&nbsp;use&nbsp;that&nbsp;here.<br />
&nbsp;&nbsp;"Pf&nbsp;status<br />
<br />
<br />
ENDFORM.<br />
<br />
<br />
FORM FM_GET_FILEPATH2 CHANGING DIRPATH .<br />
<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;Z_TEXT&nbsp;TYPE&nbsp;CHAR100.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;DIRECTORY_BROWSE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'选择目录'<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECTED_FOLDER&nbsp;=&nbsp;DIRPATH.&nbsp;"<br />
<br />
<br />
<br />
ENDFORM.<br />
<br />
<br />
<br />
FORM FM_FILL_DATA1 USING I_PATH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_EXCEL&nbsp;TYPE&nbsp;TYT_EXCEL.<br />
&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;LW_EXCEL&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_EXCEL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_EXCEL&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"application<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_WORKBOOK&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"workbook<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_SHEET&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,&nbsp;&nbsp;"sheet<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_CELL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT.&nbsp;&nbsp;"单元格<br />
&nbsp;&nbsp;L_PATH&nbsp;=&nbsp;I_PATH.<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP1:打开excel程序<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;L_EXCEL&nbsp;'EXCEL.APPLICATION'.<br />
   </div>
   <div class="codeComment">
*&nbsp;0：不显示（后台运行），1：显示<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'VISIBLE'&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP2:读取workbook<br />
*&nbsp;创建具体excel文件对象<br />
*&nbsp;默认带有一个sheet<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'WORKBOOKS'&nbsp;=&nbsp;L_WORKBOOK&nbsp;.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'OPEN'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;L_PATH.<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP3:创建sheet<br />
*&nbsp;获取当前激活的sheet，并设定sheet名<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'Sheets'&nbsp;=&nbsp;L_SHEET<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_SHEET&nbsp;'Select'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_SHEET&nbsp;'ACTIVATE'.<br />
<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP4:数据填充<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;T_EXCEL&nbsp;INTO&nbsp;LW_EXCEL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'CELLS'&nbsp;=&nbsp;L_CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_EXCEL-ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LW_EXCEL-COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_CELL&nbsp;'VALUE'&nbsp;&nbsp;=&nbsp;LW_EXCEL-VALUE.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;不显示警告消息<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'DISPLAYALERTS'&nbsp;=&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
**********&nbsp;&nbsp;STEP5:保存、关闭、退出<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'ActiveSheet'&nbsp;=&nbsp;L_SHEET&nbsp;.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;L_SHEET&nbsp;.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;L_WORKBOOK&nbsp;.<br />
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'ActiveWorkbook'&nbsp;=&nbsp;L_WORKBOOK&nbsp;.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'SAVE'&nbsp;.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;L_EXCEL&nbsp;'VISIBLE'&nbsp;=&nbsp;0&nbsp;.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_WORKBOOK&nbsp;'CLOSE'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;L_EXCEL&nbsp;'QUIT'.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT:&nbsp;L_SHEET,&nbsp;L_WORKBOOK,L_EXCEL&nbsp;.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;get_org_name<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;读取部门或班组等的名称<br />
*----------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;输入参数:<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ZZUNI&nbsp;&nbsp;&nbsp;&nbsp;部门班组代码<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_BEGDA&nbsp;&nbsp;&nbsp;&nbsp;开始时间<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ENDDA&nbsp;&nbsp;&nbsp;&nbsp;结束时间<br />
*&&nbsp;&nbsp;输出参数：<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_ORG_NAME&nbsp;部门班组名称<br />
*----------------------------------------------------------------------*<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
FORM GET_DATA_170.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;L&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;NUMC4.<br />
&nbsp;&nbsp;DATA:&nbsp;RQ&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZHRRP0160RCKH-EX_GZYF.<br />
&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GZYF<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~SHORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~PERSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~PERNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~VORNA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_KHRQ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_KHYY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_KHJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~EX_JJJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~EX_JSJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_GXXJH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_GSJWC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_GKZJH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_GKZWC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_GXXJS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_XJEWC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_XSJWC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_XXXJS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_FJHCS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_FWCCS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_SSKJE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~EX_SSKCS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_CQ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_GX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_JX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_NJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_ZX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_JH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_BJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_SJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_CJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_HJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_SJ1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_TQJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_XXJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_QTJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_PDCS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_JRJB<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_QTJB<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_YBTS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_CCTS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_WFTS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_RCKH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_BZ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_JTBZ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_CGX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_CNJ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~EX_WXZX<br />
&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;IT_TABLE3<br />
&nbsp;&nbsp;&nbsp;FROM&nbsp;ZHRRP0160RCKH&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZHRRP0160JJFPB&nbsp;AS&nbsp;B&nbsp;ON&nbsp;&nbsp;A~PERNR&nbsp;EQ&nbsp;B~PERNR&nbsp;AND&nbsp;A~EX_GZYF&nbsp;EQ&nbsp;B~EX_GZYF&nbsp;AND&nbsp;A~ORGEH&nbsp;EQ&nbsp;B~ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZHRRP0160XSTJB&nbsp;AS&nbsp;C&nbsp;ON&nbsp;&nbsp;A~PERNR&nbsp;EQ&nbsp;C~PERNR&nbsp;AND&nbsp;A~EX_GZYF&nbsp;EQ&nbsp;C~EX_GZYF&nbsp;AND&nbsp;A~ORGEH&nbsp;EQ&nbsp;C~ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZHRRP0160KQTJB&nbsp;AS&nbsp;D&nbsp;ON&nbsp;&nbsp;A~PERNR&nbsp;EQ&nbsp;D~PERNR&nbsp;AND&nbsp;A~EX_GZYF&nbsp;EQ&nbsp;D~EX_GZYF&nbsp;AND&nbsp;A~ORGEH&nbsp;EQ&nbsp;D~ORGEH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;&nbsp;IT_STRUCT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;&nbsp;&nbsp;A~EX_GZYF&nbsp;=&nbsp;BEG+0(6)&nbsp;AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~EX_GZYF&nbsp;=&nbsp;IT_STRUCT-GZYF&nbsp;AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~ORGEH&nbsp;=&nbsp;IT_STRUCT-ORGEH&nbsp;AND<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~PERNR&nbsp;=&nbsp;IT_STRUCT-PERNR<br />
&nbsp;.<br />
<br />
   </div>
   <div class="codeComment">
*---------------------------20160725------------------------------*<br />
<br />
*&nbsp;&nbsp;IF&nbsp;LINES(&nbsp;IT_TABLE3&nbsp;)&nbsp;&lt;&nbsp;LINES(&nbsp;IT_STRUCT&nbsp;).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;W001(00)&nbsp;WITH&nbsp;'上传部门工资人员数据人不足'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
*&nbsp;&nbsp;ENDIF.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
*---------------------------20160725------------------------------*<br />
<br />
*<br />
*&nbsp;&nbsp;20160725-----------------------------------------------------------------------<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_TABLE3&nbsp;INTO&nbsp;WA_TABLE3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_STRUCT&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_TABLE3-PERNR&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_STRUCT&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_KHRQ&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_KHRQ&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_KHYY&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_KHYY&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_KHJE&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_KHJE&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_JJJE&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_JJJE&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_JSJE&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_JSJE&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GXXJH&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_GXXJH&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GSJWC&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_GSJWC&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GKZJH&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_GKZJH&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GKZWC&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_GKZWC&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GXXJS&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_GXXJS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_XJEWC&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_XJEWC&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_XSJWC&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_XSJWC&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_XXXJS&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_XXXJS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_FJHCS&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_FJHCS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_FWCCS&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_FWCCS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_SSKJE&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_SSKJE&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_SSKCS&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_SSKCS&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_CQ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_CQ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GX&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_GX&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_JX&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_JX&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_NJ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_NJ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_ZX&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_ZX&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_JH&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_JH&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_BJ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_BJ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_SJ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_SJ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_CJ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_CJ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_HJ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_HJ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_SJ1&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_SJ1&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_TQJ&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_TQJ&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_XXJ&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_XXJ&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_QTJ&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_QTJ&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_PDCS&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_PDCS&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_JRJB&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_JRJB&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_QTJB&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_QTJB&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_YBTS&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_YBTS&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_CCTS&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_CCTS&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_WFTS&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_WFTS&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_RCKH&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_RCKH&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_BZ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_BZ&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_JTBZ&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_JTBZ&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_CGX&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_CGX&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_CNJ&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_CNJ&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_WXZX&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-EX_WXZX&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-PTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-PTEXT&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-501TEXT&nbsp;&nbsp;=&nbsp;&nbsp;WA_TABLE3-501TEXT&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RQ&nbsp;=&nbsp;WA_TABLE3-EX_GZYF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-ZFRQ&nbsp;=&nbsp;&nbsp;RQ&nbsp;&&&nbsp;'15'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-EX_GZYF&nbsp;=&nbsp;BEGIN+0(6).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT&nbsp;FROM&nbsp;WA_STRUCT&nbsp;INDEX&nbsp;SY-TABIX.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:WA_TABLE3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;&nbsp;IT_TABLE3&nbsp;INTO&nbsp;WA_TABLE3&nbsp;WITH&nbsp;&nbsp;KEY&nbsp;PERNR&nbsp;=&nbsp;WA_STRUCT-PERNR&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA_TABLE3&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-ROWCOLOR&nbsp;=&nbsp;'XXXX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT&nbsp;FROM&nbsp;WA_STRUCT&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;IT_STRUCT&nbsp;BY&nbsp;ORGEH&nbsp;PERNR.<br />
<br />
&nbsp;&nbsp;CLEAR:WA_STRUCT.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_STRUCT&nbsp;INTO&nbsp;WA_STRUCT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;=&nbsp;L&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WA_STRUCT-XH&nbsp;=&nbsp;L.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;IT_STRUCT&nbsp;FROM&nbsp;WA_STRUCT&nbsp;INDEX&nbsp;SY-TABIX.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*Text&nbsp;elements<br />
*----------------------------------------------------------<br />
*&nbsp;S01&nbsp;选择人员类型<br />
*&nbsp;T02&nbsp;<br />
*&nbsp;T03&nbsp;<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;ZFXXY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;合同制、合作方、退休返聘<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;00<br />
*001&nbsp;&nbsp;&nbsp;&1&2&3&4&5&6&7&8<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;ZCB<br />
*000&nbsp;&nbsp;&nbsp;&1&2&3&4<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
