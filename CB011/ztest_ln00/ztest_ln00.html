<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GBK" />
<title>ZTEST_LN00</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZTEST_LN00</h2>
<h3> Description: 测试关于0的判断</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
REPORT ZTEST_LN00.<br />
<br />
   </div>
   <div class="codeComment">
****************************************************************************************<br />
*&nbsp;&nbsp;&nbsp;函&nbsp;&nbsp;数&nbsp;&nbsp;名	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;说&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;明<br />
*&nbsp;&nbsp;&nbsp;ABS	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回输入参数的绝对值<br />
*&nbsp;&nbsp;&nbsp;SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回输入参数的符号：正数返回1，0返回0，负数返回-1<br />
*&nbsp;&nbsp;&nbsp;CEIL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回不小于输入参数的最小整数<br />
*&nbsp;&nbsp;&nbsp;FLOOR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回不大于输入参数的最大整数<br />
*&nbsp;&nbsp;&nbsp;TRUNC	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回输入参数的整数部分<br />
*&nbsp;&nbsp;&nbsp;TRAC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;返回输入参数的小数部分<br />
*&nbsp;&nbsp;&nbsp;ACOS（X）	&nbsp;&nbsp;&nbsp;反余弦函数，结果范围为[-PI/2,PI/2],X的范围为from[-1,1](PI为三角函数:3.14)<br />
*&nbsp;&nbsp;&nbsp;ASIN（X）	&nbsp;&nbsp;&nbsp;反正弦函数，结果范围为[0,PI],X的范围为from[-1,1]<br />
*&nbsp;&nbsp;&nbsp;ATAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;反正切函数，结果的范围为[-PI/2,PI/2]<br />
*&nbsp;&nbsp;&nbsp;COS	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;余弦函数<br />
*&nbsp;&nbsp;&nbsp;SIN	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正弦函数<br />
*&nbsp;&nbsp;&nbsp;TAN	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正切函数<br />
*&nbsp;&nbsp;&nbsp;COSH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;余弦曲线函数<br />
*&nbsp;&nbsp;&nbsp;SINH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正弦曲线函数<br />
*&nbsp;&nbsp;&nbsp;TANH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正切曲线函数<br />
*&nbsp;&nbsp;&nbsp;EXP	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;底数为e的幕函数(2=2.7182818284590452)<br />
*&nbsp;&nbsp;&nbsp;LOG	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;底数为e的自然对数<br />
*&nbsp;&nbsp;&nbsp;LOG10	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;底数为10的对数<br />
*&nbsp;&nbsp;&nbsp;SQRT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;平方根<br />
*&nbsp;&nbsp;&nbsp;STRLEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;获取字符串长度函数<br />
*<br />
*&nbsp;&nbsp;&nbsp;比较运算符有EQ或=（等于）、NE或&lt;&gt;（不等于）、LT或&lt;（小于）、GT或&gt;（大于）、LE或&lt;=（小于或等于）、GE或&gt;=（大于或等于）。<br />
*<br />
*&nbsp;&nbsp;&nbsp;算术运算符有&nbsp;+（加）、-（减）、*（乘）、/（除）、DIV（整除）、MOD（取余）、**（乘方）。<br />
*<br />
*&nbsp;&nbsp;&nbsp;运算符<br />
*&nbsp;&nbsp;&nbsp;含义<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;CO&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1仅包含s2中的字符,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;CN&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1还包含s2之外的字符,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;CA&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1包含任何一个s2中的字符,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;NA&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1不包含s2的任何字符,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;CS&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1包含字符串s2,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;NS&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1不包含字符串s2,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;CP&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1包含模式s2,逻辑表达式为真<br />
*&nbsp;&nbsp;&nbsp;s1&nbsp;NP&nbsp;s2<br />
*&nbsp;&nbsp;&nbsp;如果s1不包含模式s2,逻辑表达式为真<br />
*<br />
*&nbsp;&nbsp;&nbsp;注:CO,CN,CA,NA比较时区分大小写,且尾部空格也在比较范围之内,CS,NS,CP,NP比较时忽略尾部空格且不区分大小写,比较结束后,如果结果为真,SY-FDPOS将给出s2在s1中的偏移量信息.模式表示可以使用通配符,”*”用于替代任何字符串,”+”用于替代单个字符.<br />
*<br />
******************************************************************************************<br />
<br />
*DATA&nbsp;L_NUM&nbsp;TYPE&nbsp;I.<br />
*<br />
*CLEAR&nbsp;L_NUM.<br />
*L_NUM&nbsp;=&nbsp;5&nbsp;/&nbsp;10.<br />
*<br />
*IF&nbsp;L_NUM&nbsp;NE&nbsp;0.<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;L_NUM.<br />
*ENDIF.<br />
<br />
*DATA:&nbsp;T(10)&nbsp;&nbsp;&nbsp;VALUE&nbsp;'abcdefghij',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRING&nbsp;&nbsp;LIKE&nbsp;T,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STR1(4)&nbsp;VALUE&nbsp;'cdef',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STR2(4)&nbsp;VALUE&nbsp;'1234',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STR3(2)&nbsp;VALUE&nbsp;'kl',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STR4(6)&nbsp;VALUE&nbsp;'klmnop',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;2.<br />
*STRING&nbsp;=&nbsp;T.<br />
*WRITE&nbsp;STRING.<br />
*REPLACE&nbsp;STR1&nbsp;WITH&nbsp;STR2&nbsp;INTO&nbsp;STRING.<br />
*WRITE&nbsp;/&nbsp;STRING.<br />
*STRING&nbsp;=&nbsp;T.<br />
*REPLACE&nbsp;STR1&nbsp;WITH&nbsp;STR2&nbsp;INTO&nbsp;STRING&nbsp;LENGTH&nbsp;1.<br />
*WRITE&nbsp;/&nbsp;STRING.<br />
*STRING&nbsp;=&nbsp;T.<br />
*REPLACE&nbsp;STR1&nbsp;WITH&nbsp;STR3&nbsp;INTO&nbsp;STRING.<br />
*WRITE&nbsp;/&nbsp;STRING.<br />
*STRING&nbsp;=&nbsp;T.<br />
*REPLACE&nbsp;STR1&nbsp;WITH&nbsp;STR4&nbsp;INTO&nbsp;STRING.<br />
*WRITE&nbsp;/&nbsp;STRING.<br />
<br />
<br />
*DATA:L_NUM&nbsp;TYPE&nbsp;ZFIRP0140_HEADER-ZJSD_NO.<br />
*<br />
*SELECT&nbsp;MAX(&nbsp;ZJSD_NO&nbsp;)<br />
*&nbsp;&nbsp;INTO&nbsp;L_NUM<br />
*&nbsp;&nbsp;FROM&nbsp;ZFIRP0140_HEADER.<br />
*<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;L_NUM.<br />
<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;选择屏幕<br />
*&---------------------------------------------------------------------*<br />
*SELECTION-SCREEN&nbsp;BEGIN&nbsp;OF&nbsp;BLOCK&nbsp;SS1&nbsp;WITH&nbsp;FRAME&nbsp;TITLE&nbsp;TEXT-001.<br />
*<br />
*PARAMETERS:P_1&nbsp;TYPE&nbsp;C&nbsp;AS&nbsp;CHECKBOX&nbsp;DEFAULT&nbsp;ABAP_FALSE&nbsp;USER-COMMAND&nbsp;FLAG,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_2&nbsp;TYPE&nbsp;C&nbsp;AS&nbsp;CHECKBOX&nbsp;DEFAULT&nbsp;ABAP_FALSE&nbsp;USER-COMMAND&nbsp;FLAG,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_3&nbsp;TYPE&nbsp;C&nbsp;AS&nbsp;CHECKBOX&nbsp;DEFAULT&nbsp;ABAP_FALSE&nbsp;USER-COMMAND&nbsp;FLAG,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_4&nbsp;TYPE&nbsp;C&nbsp;AS&nbsp;CHECKBOX&nbsp;DEFAULT&nbsp;ABAP_FALSE&nbsp;USER-COMMAND&nbsp;FLAG.<br />
*<br />
*SELECTION-SCREEN&nbsp;END&nbsp;OF&nbsp;BLOCK&nbsp;SS1.<br />
<br />
*FIELD-SYMBOLS:&nbsp;&lt;FS1&gt;&nbsp;TYPE&nbsp;ANY&nbsp;TABLE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;FS2&gt;&nbsp;.<br />
*<br />
*DATA:&nbsp;IT_TAB&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;TMABCT.<br />
*DATA:&nbsp;IT_GJS&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;ZMMEX0010_GJS.<br />
*SELECT&nbsp;*<br />
*&nbsp;&nbsp;FROM&nbsp;TMABCT<br />
*&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;IT_TAB<br />
*&nbsp;&nbsp;WHERE&nbsp;SPRAS&nbsp;=&nbsp;SY-LANGU.<br />
*<br />
*SELECT&nbsp;*<br />
*&nbsp;&nbsp;FROM&nbsp;ZMMEX0010_GJS<br />
*&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;IT_GJS.<br />
<br />
**ASSIGN&nbsp;IT_TAB&nbsp;TO&nbsp;&lt;FS1&gt;.<br />
*<br />
*ASSIGN&nbsp;COMPONENT&nbsp;'MAABC'&nbsp;OF&nbsp;STRUCTURE&nbsp;IT_TAB&nbsp;TO&nbsp;&lt;FS1&gt;.<br />
**ASSIGN&nbsp;COMPONENT&nbsp;'EX_GJS'&nbsp;OF&nbsp;STRUCTURE&nbsp;IT_GJS&nbsp;TO&nbsp;&lt;FS1&gt;.<br />
*<br />
*LOOP&nbsp;AT&nbsp;&lt;FS1&gt;&nbsp;ASSIGNING&nbsp;&lt;FS2&gt;.<br />
**&nbsp;&nbsp;&lt;FS2&gt;&nbsp;=&nbsp;&lt;FS1&gt;-MAABC.<br />
*ENDLOOP.<br />
<br />
************************测试操作符(CO,CA,CP,等)*********************<br />
*DATA:&nbsp;L_CHAR01&nbsp;TYPE&nbsp;CHAR10&nbsp;VALUE&nbsp;'腕表',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_CHAR02&nbsp;TYPE&nbsp;CHAR10&nbsp;VALUE&nbsp;'进口腕表'.<br />
*<br />
*IF&nbsp;L_CHAR02&nbsp;CO&nbsp;L_CHAR01.<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;L_CHAR01.<br />
*ELSE.<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;L_CHAR02.<br />
*ENDIF.<br />
**MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'呵呵'.<br />
*******************************************************************<br />
<br />
***********************测试创建内表方法*****************************<br />
*DATA:&nbsp;BEGIN&nbsp;OF&nbsp;IT_TABLE&nbsp;OCCURS&nbsp;0,&nbsp;"带表头<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBLNR&nbsp;TYPE&nbsp;MSEG-MBLNR,<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;IT_TABLE.<br />
<br />
*TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;STRU_0010,<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBLNR&nbsp;TYPE&nbsp;MSEG-MBLNR,<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010.<br />
*<br />
*DATA:&nbsp;IT_TABLE&nbsp;TYPE&nbsp;STRU_0010&nbsp;OCCURS&nbsp;0.&nbsp;&nbsp;"不带表头<br />
*******************************************************************<br />
<br />
****************************测试绝对值*****************************<br />
*DATA:&nbsp;L_NUM&nbsp;&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_NUM1&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2.<br />
*<br />
*L_NUM&nbsp;=&nbsp;3&nbsp;-&nbsp;5.<br />
*<br />
*L_NUM1&nbsp;=&nbsp;ABS(&nbsp;L_NUM&nbsp;).<br />
*<br />
*WRITE&nbsp;/&nbsp;L_NUM1.<br />
*******************************************************************<br />
<br />
***********************************测试外部调用**************************************************<br />
*PERFORM&nbsp;FM_DOWNLOAD.<br />
*PERFORM&nbsp;FM_PRINT_WITH_TOOL.<br />
*<br />
**&---------------------------------------------------------------------*<br />
**&nbsp;输出内表数据到txt下载<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;FM_DOWNLOAD.<br />
*&nbsp;&nbsp;TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;STRU_DATA,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;TYPE&nbsp;CHAR100,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_DATA.<br />
*&nbsp;&nbsp;DATA:&nbsp;IT_DATA&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_DATA,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_DATA&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_DATA.<br />
*<br />
*&nbsp;&nbsp;CLEAR&nbsp;WA_DATA.<br />
*&nbsp;&nbsp;WA_DATA-MESSAGE&nbsp;=&nbsp;'这就是一条测试数据而已'.<br />
*&nbsp;&nbsp;APPEND&nbsp;WA_DATA&nbsp;TO&nbsp;IT_DATA.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GUI_DOWNLOAD'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONFIRM_OVERWRITE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"如果文件存在&nbsp;弹出是否覆盖文件的对话框<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE_FIELD_SEPARATOR&nbsp;=&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"加入字段分隔符&nbsp;TAB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'D:\BAP\blat276\full\body.txt'&nbsp;"文件名&nbsp;必须为&nbsp;STRING&nbsp;类型<br />
*&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;IT_DATA&nbsp;&nbsp;"内表<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_WRITE_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
*ENDFORM.<br />
*<br />
**&---------------------------------------------------------------------*<br />
**&nbsp;使用第三方工具<br />
**&---------------------------------------------------------------------*<br />
*FORM&nbsp;FM_PRINT_WITH_TOOL.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;EXECUTE&nbsp;&nbsp;"打开指定文件<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPLICATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'D:\BAP\blat276\full\2.vbs'&nbsp;"本地配置文件(发送指定EMAIL)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BAD_PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PATH_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_EXTENSION_UNKNOWN&nbsp;=&nbsp;6<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_EXECUTE_FAILED&nbsp;&nbsp;&nbsp;=&nbsp;7<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SYNCHRONOUS_FAILED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;&nbsp;&nbsp;=&nbsp;9<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S001(00)&nbsp;WITH&nbsp;'打开文件时失败，请重试'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
*&nbsp;&nbsp;ENDIF.<br />
*ENDFORM.<br />
***********************************************************************************************<br />
<br />
<br />
*************************************选择界面添加按钮*******************************************<br />
*TABLES:&nbsp;ZFIRP0130A.<br />
*<br />
*SELECTION-SCREEN&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
*SELECTION-SCREEN&nbsp;COMMENT&nbsp;1(10)&nbsp;TEXT-S03&nbsp;FOR&nbsp;FIELD&nbsp;P_HKONT.&nbsp;&nbsp;"给选择字段加下划线<br />
*SELECTION-SCREEN&nbsp;POSITION&nbsp;35.<br />
*PARAMETERS:&nbsp;P_HKONT&nbsp;TYPE&nbsp;ZFIRP0130A-HKONT&nbsp;OBLIGATORY.<br />
*SELECTION-SCREEN&nbsp;COMMENT&nbsp;46(50)&nbsp;GV_TXT50&nbsp;FOR&nbsp;FIELD&nbsp;P_HKONT.<br />
*SELECTION-SCREEN&nbsp;END&nbsp;OF&nbsp;LINE.<br />
*PARAMETERS:&nbsp;P_SPMON&nbsp;TYPE&nbsp;SPMON&nbsp;OBLIGATORY&nbsp;DEFAULT&nbsp;SY-DATUM+0(6)&nbsp;MODIF&nbsp;ID&nbsp;MON.<br />
*SELECTION-SCREEN&nbsp;SKIP.<br />
*SELECTION-SCREEN&nbsp;BEGIN&nbsp;OF&nbsp;LINE.<br />
*SELECTION-SCREEN&nbsp;COMMENT&nbsp;3(12)&nbsp;TEXT-S04&nbsp;FOR&nbsp;FIELD&nbsp;P_DAYS&nbsp;&nbsp;MODIF&nbsp;ID&nbsp;ZDD.<br />
*SELECTION-SCREEN&nbsp;POSITION&nbsp;31.<br />
*PARAMETERS:&nbsp;P_DAYS&nbsp;TYPE&nbsp;NUMC3&nbsp;MODIF&nbsp;ID&nbsp;ZDD.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"相差天数<br />
*SELECTION-SCREEN&nbsp;PUSHBUTTON&nbsp;35(10)&nbsp;BT_PLUS&nbsp;USER-COMMAND&nbsp;PLU&nbsp;MODIF&nbsp;ID&nbsp;ZDD&nbsp;VISIBLE&nbsp;LENGTH&nbsp;2.<br />
*SELECTION-SCREEN&nbsp;PUSHBUTTON&nbsp;38(10)&nbsp;BT_MINS&nbsp;USER-COMMAND&nbsp;MIN&nbsp;MODIF&nbsp;ID&nbsp;ZDD&nbsp;VISIBLE&nbsp;LENGTH&nbsp;2.<br />
*SELECTION-SCREEN&nbsp;PUSHBUTTON&nbsp;41(10)&nbsp;BT_CLER&nbsp;USER-COMMAND&nbsp;CLR&nbsp;MODIF&nbsp;ID&nbsp;ZDD&nbsp;VISIBLE&nbsp;LENGTH&nbsp;2.<br />
*SELECTION-SCREEN&nbsp;END&nbsp;OF&nbsp;LINE.<br />
*<br />
**----------------------------------------------------------------------*<br />
**&nbsp;INITIALIZATION<br />
**----------------------------------------------------------------------*<br />
*INITIALIZATION.<br />
*&nbsp;&nbsp;PERFORM&nbsp;FRM_INIT_PROG.<br />
**----------------------------------------------------------------------*<br />
**&nbsp;AT&nbsp;SELECTION-SCREEN&nbsp;OUTPUT<br />
**----------------------------------------------------------------------*<br />
*AT&nbsp;SELECTION-SCREEN&nbsp;OUTPUT.<br />
**&nbsp;&nbsp;PERFORM&nbsp;FRM_OUTPUT_SCREEN.<br />
*<br />
*FORM&nbsp;FRM_INIT_PROG&nbsp;.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_PREVIOUS_VALUE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'下一个值'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BT_MINS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_NEXT_VALUE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'上一个值'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BT_PLUS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_DELETE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'清空'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BT_CLER<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
*ENDFORM.<br />
*****************************************************************************************<br />
<br />
**--------------------------------显示内表列名称------------------------------------*<br />
*TYPES:<br />
*&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;MY_STRUCT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;TYPE&nbsp;P,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CHAR&nbsp;&nbsp;&nbsp;TYPE&nbsp;CHAR100,<br />
*&nbsp;&nbsp;END&nbsp;OF&nbsp;MY_STRUCT.<br />
*<br />
*DATA:<br />
*&nbsp;&nbsp;MY_DATA&nbsp;TYPE&nbsp;MY_STRUCT,<br />
*&nbsp;&nbsp;CLASS&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ABAP_STRUCTDESCR,<br />
*&nbsp;&nbsp;CLASS1&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ABAP_TYPEDESCR.<br />
*<br />
*DATA:&nbsp;BEGIN&nbsp;OF&nbsp;ITAB&nbsp;OCCURS&nbsp;0&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F2&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ITAB.<br />
*<br />
*FIELD-SYMBOLS:<br />
*&lt;COMP_WA&gt;&nbsp;TYPE&nbsp;ABAP_COMPDESCR.<br />
*<br />
*START-OF-SELECTION.<br />
*&nbsp;&nbsp;CLASS&nbsp;?=&nbsp;CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA(&nbsp;MY_DATA&nbsp;).<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_ABAP_STRUCTDESCR=&gt;DESCRIBE_BY_DATA<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_DATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;MY_DATA<br />
**&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_DESCR_REF&nbsp;=&nbsp;CLASS1.<br />
**<br />
**&nbsp;&nbsp;CLASS&nbsp;?=&nbsp;CLASS1.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;CLASS-&gt;COMPONENTS&nbsp;ASSIGNING&nbsp;&lt;COMP_WA&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WRITE:&nbsp;/&nbsp;&lt;COMP_WA&gt;-NAME&nbsp;,&nbsp;&lt;COMP_WA&gt;-TYPE_KIND&nbsp;,&nbsp;&lt;COMP_WA&gt;-LENGTH&nbsp;,&nbsp;&lt;COMP_WA&gt;-DECIMALS.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*************************************************************************************<br />
<br />
<br />
*********************************测试COLLECT************************************************<br />
*TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;TYPE&nbsp;ZFIRP0140_ITEM1-MATNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARG&nbsp;TYPE&nbsp;ZFIRP0140_ITEM1-CHARG,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZJSJE&nbsp;TYPE&nbsp;ZFIRP0140_ITEM1-ZJSJE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010.<br />
*DATA:&nbsp;LT_0010&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_0011&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_0010&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_NUM&nbsp;&nbsp;&nbsp;TYPE&nbsp;I<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*<br />
*SELECT&nbsp;MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARG<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZJSJE<br />
*&nbsp;&nbsp;FROM&nbsp;ZFIRP0140_ITEM1<br />
*&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_0010<br />
*&nbsp;&nbsp;UP&nbsp;TO&nbsp;50&nbsp;ROWS.<br />
*<br />
*SORT&nbsp;LT_0010&nbsp;BY&nbsp;CHARG.<br />
*LOOP&nbsp;AT&nbsp;LT_0010&nbsp;INTO&nbsp;LS_0010.<br />
*&nbsp;&nbsp;COLLECT&nbsp;LS_0010&nbsp;INTO&nbsp;LT_0011.<br />
*ENDLOOP.<br />
*<br />
*WRITE&nbsp;:&nbsp;SY-ULINE&nbsp;.<br />
*WRITE&nbsp;:&nbsp;'内表数据:'&nbsp;.<br />
*LOOP&nbsp;&nbsp;AT&nbsp;&nbsp;LT_0010&nbsp;INTO&nbsp;LS_0010.<br />
*&nbsp;&nbsp;L_NUM&nbsp;=&nbsp;L_NUM&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;WRITE&nbsp;:&nbsp;/&nbsp;L_NUM&nbsp;,LS_0010-MATNR&nbsp;,LS_0010-CHARG&nbsp;,LS_0010-ZJSJE.<br />
*ENDLOOP&nbsp;.<br />
*WRITE&nbsp;:&nbsp;SY-ULINE&nbsp;.<br />
*<br />
*CLEAR&nbsp;L_NUM.<br />
*WRITE&nbsp;:&nbsp;SY-ULINE&nbsp;.<br />
*WRITE&nbsp;:&nbsp;'COLLECT数据:'&nbsp;.<br />
*LOOP&nbsp;&nbsp;AT&nbsp;&nbsp;LT_0011&nbsp;INTO&nbsp;LS_0010.<br />
*&nbsp;&nbsp;L_NUM&nbsp;=&nbsp;L_NUM&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;WRITE&nbsp;:&nbsp;/&nbsp;L_NUM&nbsp;,LS_0010-MATNR&nbsp;,LS_0010-CHARG&nbsp;,LS_0010-ZJSJE.<br />
*ENDLOOP&nbsp;.<br />
*WRITE&nbsp;:&nbsp;SY-ULINE&nbsp;.<br />
**&nbsp;结论:标准表也可以使用COLLECT进行汇总.<br />
********************************************************************************************<br />
<br />
*<br />
*DATA&nbsp;A&nbsp;TYPE&nbsp;CHAR10&nbsp;VALUE&nbsp;'a1'.<br />
*DATA&nbsp;B&nbsp;TYPE&nbsp;CHAR10&nbsp;VALUE&nbsp;'99'.<br />
*<br />
*IF&nbsp;A&nbsp;&gt;&nbsp;B.<br />
*&nbsp;&nbsp;WRITE:/&nbsp;A.<br />
*ELSE.<br />
*&nbsp;&nbsp;WRITE:/&nbsp;B.<br />
*ENDIF.<br />
<br />
*DATA:&nbsp;L_CHAR&nbsp;&nbsp;TYPE&nbsp;ZSDRP0020_KLTZ-LIFNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_CHAR1&nbsp;TYPE&nbsp;ZSDRP0020_KLTZ-LIFNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_SGTXT&nbsp;TYPE&nbsp;CHAR10.<br />
*<br />
*P_SGTXT&nbsp;=&nbsp;'A'.<br />
*<br />
*DATA:&nbsp;BEGIN&nbsp;OF&nbsp;IT_CHAR&nbsp;OCCURS&nbsp;0,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFNR&nbsp;TYPE&nbsp;ZSDRP0020_KLTZ-LIFNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;IT_CHAR.<br />
*<br />
*<br />
*CONCATENATE&nbsp;'%'&nbsp;P_SGTXT&nbsp;'%'&nbsp;INTO&nbsp;L_CHAR1.<br />
*<br />
*SELECT&nbsp;MAX(&nbsp;LIFNR&nbsp;)<br />
*&nbsp;&nbsp;FROM&nbsp;ZSDRP0020_KLTZ<br />
*&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;IT_CHAR[]<br />
*&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;NOT&nbsp;LIKE&nbsp;L_CHAR1<br />
*&nbsp;&nbsp;.<br />
*<br />
**WRITE:/&nbsp;L_CHAR.<br />
*<br />
*LOOP&nbsp;AT&nbsp;IT_CHAR.<br />
*&nbsp;&nbsp;WRITE:/&nbsp;IT_CHAR-LIFNR.<br />
*ENDLOOP.<br />
********************************************************************************************<br />
<br />
*&nbsp;&nbsp;DATA:&nbsp;L_NUM&nbsp;TYPE&nbsp;CHAR10.<br />
*<br />
*&nbsp;&nbsp;L_NUM&nbsp;=&nbsp;'YD16070001'.<br />
*<br />
*&nbsp;&nbsp;L_NUM+2(8)&nbsp;=&nbsp;L_NUM+2(8)&nbsp;+&nbsp;1.<br />
*<br />
*&nbsp;&nbsp;WRITE:/&nbsp;L_NUM.<br />
<br />
<br />
*********************判断小数位是否符合要求****************************<br />
*DATA:&nbsp;L_NUM&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;&nbsp;&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P1&nbsp;&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2.<br />
*<br />
*L_P&nbsp;=&nbsp;'2.5'.<br />
*<br />
*L_NUM&nbsp;=&nbsp;L_P.<br />
*<br />
*IF&nbsp;L_P&nbsp;NE&nbsp;L_NUM.<br />
*&nbsp;&nbsp;L_P1&nbsp;=&nbsp;L_P&nbsp;-&nbsp;'0.5'.<br />
*&nbsp;&nbsp;L_NUM&nbsp;=&nbsp;L_P1.<br />
*&nbsp;&nbsp;IF&nbsp;L_NUM&nbsp;NE&nbsp;L_P1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;/&nbsp;'错误的数据'.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;/&nbsp;'正确的数据'.<br />
*&nbsp;&nbsp;ENDIF.<br />
*ELSE&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;'正确的数据'.<br />
*ENDIF.<br />
<br />
*DATA:&nbsp;L_NUM&nbsp;TYPE&nbsp;CHAR13,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_CUT&nbsp;TYPE&nbsp;CHAR1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;&nbsp;&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2.<br />
*<br />
*L_P&nbsp;=&nbsp;'10'.<br />
*<br />
*L_NUM&nbsp;=&nbsp;L_P.<br />
*<br />
*L_CUT&nbsp;=&nbsp;L_NUM+10(1).<br />
*<br />
*IF&nbsp;L_CUT&nbsp;NE&nbsp;'5'&nbsp;AND&nbsp;&nbsp;L_CUT&nbsp;NE&nbsp;'0'.&nbsp;.<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;'错误'.<br />
*ELSE.<br />
*&nbsp;&nbsp;WRITE&nbsp;/&nbsp;'正确'.<br />
*ENDIF.<br />
**********************************************************************<br />
<br />
*DATA:&nbsp;L_FLV&nbsp;TYPE&nbsp;AUSP-ATFLV,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_MEN&nbsp;TYPE&nbsp;MSEG-MENGE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;&nbsp;&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2.<br />
*<br />
*L_P&nbsp;&nbsp;&nbsp;=&nbsp;'10.20'.<br />
*L_FLV&nbsp;=&nbsp;L_P.<br />
*L_MEN&nbsp;=&nbsp;L_P.<br />
*<br />
*L_MEN&nbsp;=&nbsp;'10.20'.<br />
*L_P&nbsp;&nbsp;&nbsp;=&nbsp;L_MEN.<br />
*L_FLV&nbsp;=&nbsp;L_MEN.<br />
*<br />
*WRITE:&nbsp;/&nbsp;L_FLV,L_MEN,L_P.<br />
<br />
*&nbsp;浮点类型对小数点后一位的支持有点问题<br />
<br />
***********************************************************************<br />
*&nbsp;单位换算函数<br />
*DATA:&nbsp;L_MEINS1&nbsp;TYPE&nbsp;MSEG-MEINS.<br />
*DATA:&nbsp;L_MEINS2&nbsp;TYPE&nbsp;MSEG-MEINS.<br />
*<br />
*SELECT&nbsp;SINGLE&nbsp;MEINS<br />
*&nbsp;&nbsp;FROM&nbsp;MSEG<br />
*&nbsp;&nbsp;INTO&nbsp;L_MEINS1<br />
*&nbsp;&nbsp;WHERE&nbsp;MEINS&nbsp;NE&nbsp;'G'.<br />
*<br />
*L_MEINS2&nbsp;=&nbsp;L_MEINS1.<br />
*<br />
*CALL&nbsp;FUNCTION&nbsp;'CONVERSION_EXIT_UNIT_OUTPUT'<br />
*&nbsp;&nbsp;CHANGING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;E_UNIT&nbsp;=&nbsp;L_MEINS1.<br />
*<br />
*WRITE:&nbsp;/&nbsp;L_MEINS1,&nbsp;L_MEINS2.<br />
<br />
***********************************************************************<br />
<br />
**&nbsp;判断是否整数<br />
*DATA:&nbsp;L_I&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_P&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_2&nbsp;TYPE&nbsp;P&nbsp;LENGTH&nbsp;10&nbsp;DECIMALS&nbsp;2.<br />
*<br />
*L_P&nbsp;=&nbsp;'45678'.<br />
*<br />
**L_2&nbsp;=&nbsp;&nbsp;L_P&nbsp;*&nbsp;10&nbsp;MOD&nbsp;10.<br />
*IF&nbsp;L_P&nbsp;*&nbsp;10&nbsp;MOD&nbsp;10&nbsp;NE&nbsp;0.<br />
*&nbsp;&nbsp;WRITE:&nbsp;/&nbsp;'这有小数'.<br />
*ELSE.<br />
*&nbsp;&nbsp;WRITE:&nbsp;/&nbsp;'这是整数'.<br />
*ENDIF.<br />
<br />
***********************************************************************<br />
<br />
*DATA&nbsp;L_I&nbsp;TYPE&nbsp;I.<br />
*<br />
*L_I&nbsp;=&nbsp;1.<br />
*<br />
*PERFORM&nbsp;L_I&nbsp;OF&nbsp;FM_01<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FM_02.<br />
*<br />
*FORM&nbsp;FM_01.<br />
*&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'这是1'.<br />
*ENDFORM.<br />
*<br />
*FORM&nbsp;FM_02.<br />
*&nbsp;&nbsp;MESSAGE&nbsp;S000(ZCB)&nbsp;WITH&nbsp;'这是2'.<br />
*ENDFORM.<br />
<br />
***********************************************************************<br />
<br />
*TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBLNR&nbsp;TYPE&nbsp;MSEG-MBLNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBELN&nbsp;TYPE&nbsp;MKPF-LE_VBELN,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSNR&nbsp;TYPE&nbsp;LIPS-POSNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;STRU_0020,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBELN&nbsp;TYPE&nbsp;LIPS-VBELN,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSNR&nbsp;TYPE&nbsp;LIPS-POSNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0020.<br />
*<br />
*DATA:&nbsp;ITAB1&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_0010,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA1&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITAB2&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_0020,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA2&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_0020,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_CHAR&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAR1.<br />
*<br />
*FIELD-SYMBOLS:&nbsp;&lt;WA1&gt;&nbsp;TYPE&nbsp;STRU_0010.<br />
*<br />
*SELECT&nbsp;MBLNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LE_VBELN<br />
*&nbsp;&nbsp;UP&nbsp;TO&nbsp;10000&nbsp;ROWS<br />
*&nbsp;&nbsp;FROM&nbsp;MKPF<br />
*&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;ITAB1<br />
*&nbsp;&nbsp;WHERE&nbsp;LE_VBELN&nbsp;NE&nbsp;ABAP_FALSE.<br />
*<br />
*SELECT&nbsp;VBELN<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSNR<br />
*&nbsp;UP&nbsp;TO&nbsp;10000&nbsp;ROWS<br />
*&nbsp;FROM&nbsp;LIPS<br />
*&nbsp;INTO&nbsp;TABLE&nbsp;ITAB2<br />
*&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;ITAB1<br />
*&nbsp;WHERE&nbsp;VBELN&nbsp;=&nbsp;ITAB1-VBELN.<br />
*<br />
*L_CHAR&nbsp;=&nbsp;'1'.<br />
*SORT&nbsp;ITAB1&nbsp;BY&nbsp;VBELN.<br />
*DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;ITAB1&nbsp;COMPARING&nbsp;VBELN.<br />
*SORT&nbsp;ITAB2&nbsp;BY&nbsp;VBELN.<br />
*CASE&nbsp;L_CHAR.<br />
*<br />
*&nbsp;&nbsp;WHEN&nbsp;'1'.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;ITAB1&nbsp;ASSIGNING&nbsp;&lt;WA1&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;ITAB2&nbsp;INTO&nbsp;WA2&nbsp;INDEX&nbsp;I.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.&nbsp;EXIT.&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;WA2-VBELN&nbsp;&lt;&nbsp;&lt;WA1&gt;-VBELN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;I.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;WA2-VBELN&nbsp;=&nbsp;&lt;WA1&gt;-VBELN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;WA1&gt;-POSNR&nbsp;=&nbsp;WA2-POSNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;I.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.&nbsp;EXIT.&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;WHEN&nbsp;'2'.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;ITAB1&nbsp;ASSIGNING&nbsp;&lt;WA1&gt;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;ITAB2&nbsp;INTO&nbsp;WA2&nbsp;WITH&nbsp;KEY&nbsp;VBELN&nbsp;=&nbsp;&lt;WA1&gt;-VBELN&nbsp;BINARY&nbsp;SEARCH.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;WA1&gt;-POSNR&nbsp;=&nbsp;WA2-POSNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*ENDCASE.<br />
*<br />
*DATA:&nbsp;L_NUM&nbsp;TYPE&nbsp;I.<br />
*<br />
*LOOP&nbsp;AT&nbsp;ITAB1&nbsp;ASSIGNING&nbsp;&lt;WA1&gt;.<br />
*&nbsp;&nbsp;IF&nbsp;&lt;WA1&gt;-POSNR&nbsp;EQ&nbsp;ABAP_FALSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;L_NUM&nbsp;=&nbsp;L_NUM&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WRITE:&nbsp;/&nbsp;L_NUM,&nbsp;&lt;WA1&gt;-MBLNR&nbsp;,&nbsp;&lt;WA1&gt;-VBELN&nbsp;,&nbsp;&lt;WA1&gt;-POSNR.<br />
*&nbsp;&nbsp;ENDIF.<br />
*ENDLOOP.<br />
<br />
*******************************************************************************<br />
*&nbsp;关于随机数的测试<br />
*TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010.<br />
*<br />
*DATA:&nbsp;CL_RANDOM&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_RANDOM_NUMBER,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TAB&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WA_TAB&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_0010.<br />
*<br />
*START-OF-SELECTION.<br />
*<br />
*&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;CL_RANDOM.<br />
*<br />
*&nbsp;&nbsp;DO&nbsp;50&nbsp;TIMES.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_RANDOM-&gt;IF_RANDOM_NUMBER~INIT&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_RANDOM-&gt;IF_RANDOM_NUMBER~GET_RANDOM_INT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_LIMIT&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_RANDOM&nbsp;=&nbsp;M.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;WA_TAB.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WA_TAB-I&nbsp;=&nbsp;M.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;WA_TAB&nbsp;TO&nbsp;IT_TAB.<br />
*&nbsp;&nbsp;ENDDO.<br />
*<br />
*&nbsp;&nbsp;DATA:&nbsp;L_1&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_2&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_0&nbsp;TYPE&nbsp;I.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;IT_TAB&nbsp;INTO&nbsp;WA_TAB.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;WA_TAB-I.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_1&nbsp;=&nbsp;L_1&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_2&nbsp;=&nbsp;L_2&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_0&nbsp;=&nbsp;L_0&nbsp;+&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;WRITE:&nbsp;&nbsp;'1'&nbsp;,&nbsp;L_1,&nbsp;/<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'2'&nbsp;,&nbsp;L_2,&nbsp;/<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'0'&nbsp;,&nbsp;L_0.<br />
<br />
*******************************************************************************<br />
**&nbsp;关于宏的测试<br />
*TYPES:&nbsp;BEGIN&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I1&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I2&nbsp;TYPE&nbsp;I,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_0010.<br />
*<br />
*DATA:&nbsp;LT_I&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_0010,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_I&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STRU_0010<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*<br />
*DATA:&nbsp;L_CHAR&nbsp;&nbsp;TYPE&nbsp;CHAR30&nbsp;VALUE&nbsp;'LS_I-I1',<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_CHAR1&nbsp;TYPE&nbsp;CHAR30,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_CHAR2&nbsp;TYPE&nbsp;CHAR30<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*<br />
*FIELD-SYMBOLS:&nbsp;&lt;I1&gt;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;I2&gt;.<br />
*<br />
*DEFINE&nbsp;ADD_I.<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_I.<br />
*&nbsp;&nbsp;&1&nbsp;=&nbsp;&2.<br />
*&nbsp;&nbsp;ADD_II:<br />
*&nbsp;&nbsp;&2.<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_I&nbsp;TO&nbsp;LT_I.<br />
*END-OF-DEFINITION.<br />
*<br />
*DEFINE&nbsp;ADD_II.<br />
*&nbsp;&nbsp;IF&nbsp;&1&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LS_I-I2&nbsp;=&nbsp;&1.<br />
*&nbsp;&nbsp;ENDIF.<br />
*END-OF-DEFINITION.<br />
*<br />
*ASSIGN&nbsp;(L_CHAR)&nbsp;TO&nbsp;&lt;I1&gt;.<br />
*<br />
*L_CHAR1&nbsp;=&nbsp;'LS_I-'.<br />
*L_CHAR&nbsp;&nbsp;=&nbsp;L_CHAR1&nbsp;&&&nbsp;'I2'.<br />
*ASSIGN&nbsp;(L_CHAR)&nbsp;TO&nbsp;&lt;I2&gt;.<br />
*<br />
**L_CHAR2&nbsp;=&nbsp;'IS&nbsp;INITIAL'.<br />
*<br />
*ADD_I:<br />
*&lt;I1&gt;&nbsp;1.<br />
*<br />
*LOOP&nbsp;AT&nbsp;LT_I&nbsp;INTO&nbsp;LS_I.<br />
*&nbsp;&nbsp;WRITE:&nbsp;LS_I-I1,&nbsp;LS_I-I2.<br />
*ENDLOOP.<br />
<br />
*******************************************************************************<br />
*&nbsp;&nbsp;写入EXCEL<br />
*TYPES:<br />
*&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;STRU_DATA,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;COL1&nbsp;TYPE&nbsp;CHAR50,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;COL2&nbsp;TYPE&nbsp;CHAR50,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;COL3&nbsp;TYPE&nbsp;CHAR50,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;COL4&nbsp;TYPE&nbsp;CHAR50,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;COL5&nbsp;TYPE&nbsp;CHAR50,<br />
*&nbsp;&nbsp;END&nbsp;OF&nbsp;STRU_DATA.<br />
*<br />
*DATA:&nbsp;LS_DATA&nbsp;TYPE&nbsp;STRU_DATA,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_DATA&nbsp;TYPE&nbsp;STANDARD&nbsp;TABLE&nbsp;OF&nbsp;STRU_DATA.<br />
*<br />
*DEFINE&nbsp;DF_ADD_DATA.<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_DATA.<br />
*&nbsp;&nbsp;LS_DATA-COL1&nbsp;=&nbsp;&1.<br />
*&nbsp;&nbsp;LS_DATA-COL2&nbsp;=&nbsp;&2.<br />
*&nbsp;&nbsp;LS_DATA-COL3&nbsp;=&nbsp;&3.<br />
*&nbsp;&nbsp;LS_DATA-COL4&nbsp;=&nbsp;&4.<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_DATA&nbsp;TO&nbsp;LT_DATA.<br />
*END-OF-DEFINITION.<br />
*<br />
*DF_ADD_DATA:<br />
*'FPH'&nbsp;&nbsp;'KZ'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'JS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'GYS',<br />
*123&nbsp;&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1231&nbsp;&nbsp;'GHJDKLS'&nbsp;.<br />
*<br />
*CALL&nbsp;FUNCTION&nbsp;'ZWRITE_EXCEL'<br />
*&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C:\sap\1.xls'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;I_BEGIN_COL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;I_BEGIN_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTERN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_DATA<br />
*&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INCONSISTENT_PARAMETERS&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;UPLOAD_OLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
*IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;MESSAGE&nbsp;S001(00)&nbsp;WITH&nbsp;'下载数据到C:\sap\1.xlsx时失败，请重试'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
*&nbsp;&nbsp;EXIT.<br />
*ENDIF.<br />
<br />
<br />
*Selection&nbsp;texts<br />
*----------------------------------------------------------<br />
*&nbsp;P_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBLNR<br />
*&nbsp;P_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR<br />
*&nbsp;P_3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARG<br />
*&nbsp;P_4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MJAHR<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">www.bjcaibai.com.cn201609</td>
   </tr>
</table>
</body>
</html>
